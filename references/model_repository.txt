This file is a merged representation of a subset of the codebase, containing specifically included files and files not matching ignore patterns, combined into a single document by Repomix.
The content has been processed where security check has been disabled.

# File Summary

## Purpose
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

## File Format
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  a. A header with the file path (## File: path/to/file)
  b. The full contents of the file in a code block

## Usage Guidelines
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

## Notes
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Only files matching these patterns are included: **/*.md, **/*.xml
- Files matching these patterns are excluded: Published Models/**
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Security check has been disabled - content may contain sensitive information
- Files are sorted by Git change count (files with more changes are at the bottom)

# Directory Structure
```
Built-in Examples/
  Cellular Potts Models/
    Cell Sorting/
      CellSorting_2D.xml
      index.md
      model.md
    Persistence/
      index.md
      Persistence_2D.xml
    Proliferation in 2D/
      index.md
      Proliferation_2D.xml
    Proliferation in 3D/
      index.md
      Proliferation_3D.xml
    Run and Tumble/
      index.md
      RunAndTumble.xml
    Stem Cells/
      Crypt.xml
      index.md
      model.md
    index.md
  Miscellaneous Models/
    Cellular Automata/
      GameOfLife.xml
      index.md
    Minimal Model/
      index.md
      MinimalModel.xml
      model.md
    Morphogen Gradient/
      FrenchFlag.xml
      index.md
    Particle Aggregation/
      index.md
      ParticleAggregation.xml
    index.md
  Multiscale Models/
    Autocrine Chemotaxis/
      AutocrineChemotaxis.xml
      index.md
    Cell Cycle and Proliferation/
      CellCycle.xml
      index.md
    Cell Polarization and Chemotaxis/
      CellPolarity.xml
      index.md
      model.md
    Dictyostelium/
      Dictyostelium.xml
      index.md
    Vascular Patterning/
      index.md
      VascularPatterning.xml
    index.md
  ODE/
    Cell Cycle/
      CellCycle.xml
      index.md
    Cell Cycle Delay/
      CellCycleDelay.xml
      index.md
    Lateral Signaling/
      index.md
      LateralSignaling.xml
    MAPK Signaling/
      index.md
      MAPK_SBML.xml
    Predator-Prey/
      index.md
      PredatorPrey.xml
    index.md
  PDE/
    1D Activator-Inhibitor/
      ActivatorInhibitor_1D.xml
      index.md
    2D Activator-Inhibitor/
      ActivatorInhibitor_2D.xml
      index.md
    Excitable Media/
      ExcitableMedium_3D.xml
      index.md
    Irregular Domains/
      ActivatorInhibitor_Domain.xml
      index.md
      model.md
    Turing Patterns/
      index.md
      TuringPatterns.xml
    index.md
  index.md
Contributed Examples/
  CPM/
    Agent-based Model/
      ABMmodel.xml
      index.md
      model.md
    Cell Sorting (Simplified)/
      CellSortingLEK.xml
      index.md
      model.md
    Chemotaxis/
      index.md
      KellerSegelChemotaxis.xml
      model.md
      SimpleChemotaxis_main.xml
    Circle Dance/
      CircleDance.xml
      index.md
      model.md
    Correlated Random Walkers/
      CRW-ActinBranching.xml
      index.md
      model.md
    Hold Cell in Place/
      index.md
      model.md
      model.xml
    Init Population/
      index.md
      model.md
      Population_M.xml
    Logical Operators/
      index.md
      LogicalOperators.xml
      model.md
    Logistic Proliferation/
      index.md
      Logistic_Proliferation.xml
      model.md
    Mix and Sort/
      index.md
      mix_and_sort.xml
      model.md
    Mixed Cell Types/
      index.md
      MixedCellTypes.xml
      model.md
    Non-local Chemical Signals/
      index.md
      model.md
      NonlocalChemSign.xml
    One CPM Cell/
      index.md
      model.md
      OneCPMCell.xml
    One Random Walker/
      index.md
      model.md
      OneRandomWalker_main.xml
      OneRandomWalkerWithBias.xml
      OneRandomWalkerWithChemicalBias.xml
    Parameter Plane/
      CPMParameterPlane_main.xml
      index.md
      model.md
      TwoCellCPMParameterPlane.xml
    Sister Reunion/
      index.md
      model.md
      SisterReunion.xml
    Two CPM Cells Adhesion/
      index.md
      model.md
      TwoCPMCellsAdhesion.xml
  Multiscale/
    Anisotropic Release/
      anisotropic_release.xml
      index.md
      model.md
    Diffusible Signal/
      DiffusibleSignal.xml
      index.md
      model.md
    Synapse/
      chemical_synapse.xml
      index.md
      model.md
  ODE/
    Actin Waves (Well-mixed)/
      index.md
      model.md
      wellmixedactinwaves.xml
    FitzHugh–Nagumo/
      FN.xml
      index.md
      model.md
    Integrate and Fire/
      index.md
      IntegrateAndFire.xml
      model.md
  PDE/
    Actin Waves/
      ActinWavesPDE_2D.xml
      ActinWavesPDE_main.xml
      index.md
      model.md
    Diffusion/
      Diffusion1a_main.xml
      Diffusion1b.xml
      Diffusion2a.xml
      index.md
      model.md
    Diffusion in Liver Lobule/
      Diffusion_liver_lobule.xml
      index.md
    Field-Cell Interaction/
      field_cell_interaction.xml
      index.md
      model.md
    FitzHugh–Nagumo Waves/
      FN_PDE_in_2D.xml
      FNspiralwaves2D.xml
      FNwaves_main.xml
      index.md
      model.md
    Noisy Turing/
      index.md
      model.md
      model.xml
    Scaled Diffusion/
      Example_Scaled_Diffusion.xml
      index.md
      model.md
    Schnakenberg System/
      index.md
      model.md
      Schnakenberg2Da.xml
      Schnakenberg2Db.xml
      Schnakenberg2Dshape.xml
      SchnakenbergRD1D_main.xml
    Wave-Pinning/
      index.md
      model.md
      NotWavepinning_main.xml
      WavePinning2PDEsConservedTotal1D.xml
      Wavepinningin2D.xml
      Wavepinningin2DIregDomain.xml
      Wavepinningin2DOvalDomain.xml
  index.md
index.md
README.md
```

# Files

## File: Built-in Examples/Cellular Potts Models/Cell Sorting/CellSorting_2D.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>M0021 Cell Sorting 2D</Title>
        <Details>Model ID:	https://identifiers.org/morpheus/M0021
  File type:	–
  Software:	Morpheus (open source). Download from: https://morpheus.gitlab.io
Full title:	Differential Adhesion: Cell Sorting in Two Dimensions
Authors:	F. Graner, J. A. Glazier
Submitters:	W. de Back
Curators:	D. Jahn
Date:	06.11.2019
Units:	[time] = N/A
	[space] = N/A
Reference:	F. Graner, J. A. Glazier: Simulation of biological cell sorting using a two-dimensional extended Potts model. Phys. Rev. Lett. 69 (13): 2013-2016, 1992.
Comment:	–</Details>
    </Description>
    <Global>
        <Variable symbol="boundary" name="Boundary length of ct1 with other cell types" value="0.0"/>
        <Constant symbol="b" value="0.0"/>
        <Constant symbol="b2" value="0.0"/>
    </Global>
    <Space>
        <SpaceSymbol symbol="l"/>
        <Lattice class="square">
            <Size symbol="size" value="150, 150, 0"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </Lattice>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="2.5e4"/>
        <!--    <Disabled>
        <SaveInterval value="5e3"/>
    </Disabled>
-->
        <RandomSeed value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="ct1">
            <VolumeConstraint target="200" strength="1"/>
            <NeighborhoodReporter>
                <Input scaling="length" value="cell.type == celltype.ct2.id"/>
                <Output symbol-ref="boundary" mapping="sum"/>
            </NeighborhoodReporter>
            <Property symbol="b" value="0"/>
            <NeighborhoodReporter>
                <Input scaling="cell" value="cell.type == celltype.ct2.id"/>
                <Output symbol-ref="b" mapping="sum"/>
            </NeighborhoodReporter>
            <NeighborhoodReporter>
                <Input scaling="length" value="cell.type == celltype.ct2.id"/>
                <Output symbol-ref="b2" mapping="sum"/>
            </NeighborhoodReporter>
            <Property symbol="b2" name="Interface with ct2" value="0"/>
        </CellType>
        <CellType class="biological" name="ct2">
            <VolumeConstraint target="200" strength="1"/>
            <Property symbol="b" value="0"/>
            <NeighborhoodReporter>
                <Input scaling="cell" value="cell.type == celltype.ct1.id"/>
                <Output symbol-ref="b" mapping="sum"/>
            </NeighborhoodReporter>
            <Property symbol="b2" name="Interface with ct1" value="0"/>
            <NeighborhoodReporter>
                <Input scaling="length" value="cell.type == celltype.ct1.id"/>
                <Output symbol-ref="b2" mapping="sum"/>
            </NeighborhoodReporter>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction default="0.0">
            <Contact type1="ct1" type2="medium" value="16"/>
            <Contact type1="ct2" type2="medium" value="6"/>
            <Contact type1="ct1" type2="ct1" value="4"/>
            <Contact type1="ct2" type2="ct2" value="4"/>
            <Contact type1="ct1" type2="ct2" value="8"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="2"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>6</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="ct1" size="16">
            <Annotation>Checkerboard pattern: Lower left grid of ct1 cells</Annotation>
            <InitCellObjects mode="distance">
                <Arrangement displacements="30, 30, 1" repetitions="4, 4, 1">
                    <Box origin="15, 15, 0" size="15, 15, 0"/>
                </Arrangement>
            </InitCellObjects>
        </Population>
        <Population type="ct1" size="16">
            <Annotation>Checkerboard pattern: Upper right grid of ct1 cells</Annotation>
            <InitCellObjects mode="distance">
                <Arrangement displacements="30, 30, 1" repetitions="4, 4, 1">
                    <Box origin="30, 30, 0" size="15, 15, 0"/>
                </Arrangement>
            </InitCellObjects>
        </Population>
        <Population type="ct2" size="16">
            <Annotation>Checkerboard pattern: Upper left grid of ct2 cells</Annotation>
            <InitCellObjects mode="distance">
                <Arrangement displacements="30, 30, 1" repetitions="4, 4, 1">
                    <Box origin="15, 30, 0" size="15, 15, 0"/>
                </Arrangement>
            </InitCellObjects>
        </Population>
        <Population type="ct2" size="16">
            <Annotation>Checkerboard pattern: Lower right grid of ct2 cells</Annotation>
            <InitCellObjects mode="distance">
                <Arrangement displacements="30, 30, 1" repetitions="4, 4, 1">
                    <Box origin="30, 15, 0" size="15, 15, 0"/>
                </Arrangement>
            </InitCellObjects>
        </Population>
        <!--    <Disabled>
        <Population type="ct1" size="0">
            <Annotation>Alternative random initialization of ct1 cells</Annotation>
            <InitCircle number-of-cells="32" mode="random">
                <Dimensions radius="size.x/3" center="size.x/2, size.y/2, 0"/>
            </InitCircle>
        </Population>
    </Disabled>
-->
        <!--    <Disabled>
        <Population type="ct2" size="0">
            <Annotation>Alternative random initialization of ct2 cells</Annotation>
            <InitCircle number-of-cells="32" mode="random">
                <Dimensions radius="size.x/3" center="size.x/2, size.y/2, 0"/>
            </InitCircle>
        </Population>
    </Disabled>
-->
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="100" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells flooding="true" value="cell.type"/>
            </Plot>
            <Plot>
                <Cells flooding="true" value="b">
                    <ColorMap>
                        <Color value="2" color="red"/>
                        <Color value="1" color="yellow"/>
                        <Color value="0" color="white"/>
                    </ColorMap>
                </Cells>
                <CellLabels fontsize="10" precision="0" value="b"/>
            </Plot>
            <Plot>
                <Cells per-frame-range="true" value="b2">
                    <ColorMap>
                        <Color value="2" color="red"/>
                        <Color value="1" color="yellow"/>
                        <Color value="0" color="white"/>
                    </ColorMap>
                </Cells>
                <CellLabels fontsize="10" precision="0" value="b2"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="10.0">
            <Input>
                <Symbol symbol-ref="boundary"/>
                <Symbol symbol-ref="b"/>
                <Symbol symbol-ref="b2"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="500">
                    <Style style="linespoints"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="boundary"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="dot" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Cellular Potts Models/Cell Sorting/index.md
````markdown
---
MorpheusModelID: M0021
aliases: [/examples/differential-adhesion-cell-sorting-in-two-dimensions/]

title: "Differential Adhesion: Cell Sorting in Two Dimensions"
subtitle: "Glazier-Graner Model of cell sorting"

authors: [F. Graner, J. A. Glazier]
contributors: [W. de Back, D. Jahn]
submitters: [W. de Back]
curators: [D. Jahn]

# Under review
hidden: false
private: false

# Reference details
publication:
  doi: "10.1103/PhysRevLett.69.2013"
  title: "Simulation of biological cell sorting using a two-dimensional extended Potts model"
  journal: "Phys. Rev. Lett."
  volume: 69
  issue: 13
  page: "2013-2016"
  year: 1992
  original_model: false

tags:
- Boundary Length
- CellPopulation
- Cell Sorting
- CellType
- Cellular Potts Model
- Checkerboard
- Checkerboard Pattern
- ColorMap
- Contact Length
- CPM
- Differential Adhesion
- Differential Adhesion Hypothesis
- Engulfment
- Glazier-Graner-Hogeweg Model
- Glazier-Graner Model
- InitCellObjects
- InitCircle
- Initial Condition
- Interaction
- Interaction Energy
- Interface Length
- Intermediate State
- MetropolisKinetics
- Mosaic
- Mosaic Pattern
- Motility
- Neighbor
- NeighborhoodReporter
- Node
- Population
- Reorganization
- Result State
- SaveInterval
- Snapshot
- Sorting
- Sorting Mechanism
- Spatial Arrangement
- StartTime
- Steinberg
- StopTime
- Target Area
- Target Volume
- Topology
- VolumeConstraint

# categories:
# - DOI:10.1103/PhysRevLett.69.2013

# Manual order
menu:
  Built-in Examples:
    parent: Cellular Potts Models
    weight: 10
weight: 110
---
> {{< param subtitle >}}

## Introduction

This model shows the original cellular Potts model (a.k.a. [Glazier-Graner model](#reference)) of cell sorting based on the Steinberg's differential adhesion hypothesis.

<div id="fig-1">
![](M0021_cell-sorting-2d_fig-01_engulfment.png "<strong>Figure 1. </strong> Yellow cells engulf the red cells as a result of differential adhesion.")
</div>

## Description

Two <span title="//CellTypes/CellType[@name='ct1' or @name='ct2']">`CellType`</span>s are defined, each of which has a <span title="//CellTypes/CellType[@name='ct1' or @name='ct2']/VolumeConstraint">`VolumeConstraint`</span> specifying the cell's target area/volume. In the <span title="//CPM">`CPM`</span> element, the <span title="//CPM/MonteCarloSampler/MetropolisKinetics">`MetropolisKinetics`</span> can be configured and the <span title="//CPM/Interaction">`Interaction`</span> energies between cell types are specified.

## Results

The simulation shows two <span title="//CellPopulations/Population[@type='ct1' or @type='ct2']">`Population`</span>s of spatially resolved cells, 32 red cells of type <span title="//CellTypes/CellType/@name='ct1'">`ct1`</span> and 32 yellow cells of type <span title="//CellTypes/CellType/@name='ct2'">`ct2`</span>, that initially are organized in a mosaic fashion, specifically in a checkerboard pattern that is initialized using <span title="//CellPopulations/Population[@type='ct1' or @type='ct2']/InitCellObjects">`InitCellObjects`</span>. As time progresses, through differential adhesion, the motile cells sort out and reorganize into a distribution in which one cell type engulfes the other.

<figure id="vid-1">
  <div style="margin-bottom: -1.5rem;">
    ![](M0021_cell-sorting-2d_vid-01_simulation-engulfment.mp4)
  </div>
  <figcaption>
    <strong>Video 1.</strong> Simulation video of {{< model_quick_access "media/model/m0021/CellSorting_2D.xml" >}}
  </figcaption>
</figure>

<div id="fig-2">
![](M0021_cell-sorting-2d_fig-02_spatial-cell-arrangement.png "<strong>Figure 2. </strong> Plots of the simulation result at time $t = 25000$. **Left:** Spatial cell arrangement of the two <span title='//CellTypes/CellType[@name=&#39;ct1&#39; or @name=&#39;ct2&#39;]'>`CellTypes`</span> <span title='//CellTypes/CellType[@name=&#39;ct1&#39;]'>`ct1`</span> (red) and <span title='//CellTypes/CellType[@name=&#39;ct2&#39;]'>`ct2`</span> (yellow). **Middle:** Number of neighbors <span title='//CellTypes/CellType[@name=&#39;ct1&#39; or @name=&#39;ct2&#39;]/NeighborhoodReporter/Output[@symbol-ref=&#39;b&#39;]'>$`b`$</span> of the other <span title='//CellTypes/CellType[@name=&#39;ct1&#39; or @name=&#39;ct2&#39;]'>`CellType`</span>, colors are scaled from white to yellow to red, representing a <span title='//Analysis/Gnuplotter/Plot/Cells[@value=&#39;b&#39;]/ColorMap/Color[@value=&#39;0&#39;,@color=&#39;white&#39;]'>low </span> (white), <span title='//Analysis/Gnuplotter/Plot/Cells[@value=&#39;b&#39;]/ColorMap/Color[@value=&#39;1&#39;,@color=&#39;yellow&#39;]'>medium</span> (yellow) or <span title='//Analysis/Gnuplotter/Plot/Cells[@value=&#39;b&#39;]/ColorMap/Color[@value=&#39;2&#39;,@color=&#39;red&#39;]'>high</span> (red) number of neighboring cells. **Right:** Contact length <span title='//CellTypes/CellType[@name=&#39;ct1&#39; or @name=&#39;ct2&#39;]/NeighborhoodReporter/Output[@symbol-ref=&#39;b2&#39;]'>$`b_2`$</span> with cells of the other <span title='//CellTypes/CellType[@name=&#39;ct1&#39; or @name=&#39;ct2&#39;]'>`CellType`</span>, with colors indicating a <span title='//Analysis/Gnuplotter/Plot/Cells[@value=&#39;b2&#39;]/ColorMap/Color[@value=&#39;0&#39;,@color=&#39;white&#39;]'>low</span> (white), <span title='//Analysis/Gnuplotter/Plot/Cells[@value=&#39;b2&#39;]/ColorMap/Color[@value=&#39;1&#39;,@color=&#39;yellow&#39;]'>medium</span> (yellow) or <span title='//Analysis/Gnuplotter/Plot/Cells[@value=&#39;b2&#39;]/ColorMap/Color[@value=&#39;2&#39;,@color=&#39;red&#39;]'>high</span> (red) sum of boundary nodes. These latter two plots only show observables that each cell can report about its respective local neighborhood, and these values are not used in the sorting mechanism.")
</div>

<div id="fig-3">
![](M0021_cell-sorting-2d_fig-03_boundary-length.png "<strong>Figure 3. </strong> Evolution of the sum of all <span title='//CellTypes/CellType[@name=&#39;ct1&#39;]/NeighborhoodReporter/Output[@symbol-ref=&#39;boundary&#39;]'>`boundary`</span> lengths over time between cell types <span title='//CellTypes/CellType[@name=&#39;ct1&#39;]'>`ct1`</span> and <span title='//CellTypes/CellType[@name=&#39;ct2&#39;]'>`ct2`</span>. The plot shows an initial rapid decrease followed by a more gradual decline in boundary length as the engulfment progresses.")
</div>

{{% callout note %}}
Snapshots of the simulation can be saved to files named `[Title][Time].xml.gz` using the <span title="//Time/SaveInterval/@value">`SaveInterval`</span> component, which is by default disabled in {{< model_quick_access "media/model/m0021/CellSorting_2D.xml" >}}. These files containing intermediate and result states can be opened and used as initial conditions for new simulations.

Instead of initializing cells as single points, e.g. with the <span title="//CellPopulations/Population[@type='ct1' or @type='ct2']/InitCellObjects">`InitCellObjects`</span> or <span title="//CellPopulations/Population[@type='ct1' or @type='ct2']/InitCircle">`InitCircle`</span> plugin, the restored results of a previous simulation explicitely specify the <span title="//CellPopulations/Population/Cell/Nodes">`Nodes`</span> of each <span title="//CellPopulations/Population/Cell">`Cell`</span> in the <span title="//CellPopulations/Population">`CellPopulations`</span>.

Remember to change <span title="//Time/StartTime/@value">`StartTime`</span> and <span title="//Time/StopTime/@value">`StopTime`</span> accordingly.
{{% /callout %}}
````

## File: Built-in Examples/Cellular Potts Models/Cell Sorting/model.md
````markdown
![](M0021_cell-sorting-2d_model-graph.svg "Model Graph")
````

## File: Built-in Examples/Cellular Potts Models/Persistence/index.md
````markdown
---
MorpheusModelID: M0023

authors: [A. Czirók, K. Varga, E. Méhes, A. Szabó]

title: "Persistence"
date: "2019-11-06T17:09:00+01:00"
lastmod: "2020-10-30T12:41:00+01:00"

aliases: [/examples/persistence/]

menu:
  Built-in Examples:
    parent: Cellular Potts Models
    weight: 30
weight: 130
---

## Introduction

This example shows self-organized collective motion of cells as a result of persistence ('cellular inertia'). A similar model has recently been used by [Czirók *et al.* (2013)][czirok-2013].

![](persistence.png "Persistence of individual cells causes self-organized collective motion.")

## Description

The model uses the ```Persistence``` plugin that causes cells to prefer to move in their current direction. The direction is stored in a ```PropertyVector``` that is used to plot the color and arrows in ```Gnuplotter```.

The model is simulated in a circular domain with constant boundary conditions, which can be set up in ```Lattice/Domain/Circle```. The value for the constant boundary is specified in ```CPM/BoundaryValue```.

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/50699261?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

## Things to try

- Place static obstacles on the lattice and observe the flow pattern around the obstacle(s). The model included in the Morpheus-GUI has a corresponding ```CellType``` obstacle defined and already initializes a rectangular obstacle. To obtain the symmetric circular flow pattern in the video above, simply disable the initialization of the obstacle under ```CellPopulations```. 
- Change the boundary conditions from ```circular```$\ = \ $```constant``` to $x/y = \ $```periodic``` and observe the resulting collective motion.
- Change the ```decay-time``` of ```Persistence``` (specifying the 'memory').

## Reference

A. Czirók, K. Varga, E. Méhes, A. Szabó: [Collective cell streams in epithelial monolayers depend on cell adhesion][czirok-2013]. *New J. Phys.* **15** (7): 075006, 2013.

[czirok-2013]: http://dx.doi.org/10.1088/1367-2630/15/7/075006
````

## File: Built-in Examples/Cellular Potts Models/Persistence/Persistence_2D.xml
````xml
<MorpheusModel version="3">
    <Description>
        <Title>Example-Persistence</Title>
        <Details></Details>
    </Description>
    <Global>
        <VariableVector symbol="d" value="0.0, 0.0, 0.0" name="Moving direction"/>
        <Constant symbol="density" value="0.012"/>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="200, 200, 0"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <Domain boundary-type="constant">
                <Circle diameter="200"/>
            </Domain>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <TimeSymbol symbol="time"/>
        <StartTime value="0"/>
        <StopTime value="5000"/>
        <RandomSeed value="4"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="obstacle">
            <FreezeMotion>
                <Condition>1</Condition>
            </FreezeMotion>
        </CellType>
        <CellType class="biological" name="ct1">
            <PropertyVector symbol="d" value="0.0, 0.0, 0.0" name="Moving direction"/>
            <Property symbol="s" value="5"/>
            <VolumeConstraint target="100" strength="1"/>
            <SurfaceConstraint target="0.9" mode="aspherity" strength="1"/>
            <PersistentMotion protrusion="true" decay-time="50" strength="s"/>
            <MotilityReporter time-step="50">
                <Velocity symbol-ref="d"/>
            </MotilityReporter>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="ct1" type2="medium" value="16"/>
            <Contact type1="ct1" type2="ct1" value="1"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="10"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>3</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population size="1" type="obstacle">
            <InitCellObjects mode="distance">
                <Arrangement repetitions="1, 1, 1" displacements="1, 1, 1">
                    <Box size="20,30,0" origin="130,100,0"/>
                </Arrangement>
            </InitCellObjects>
        </Population>
        <Population size="0" type="ct1">
            <InitCircle mode="regular" number-of-cells="400">
                <Dimensions radius="100" center="100, 100, 0"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="100">
            <Terminal size="1000 600 0" name="png"/>
            <Plot>
                <Cells value="cell.id"/>
                <!--    <Disabled>
        <CellArrows style="1" orientation="3 * d / d.abs"/>
    </Disabled>
-->
            </Plot>
            <Plot>
                <Cells value="d.phi" min="0.0" max="6.28">
                    <ColorMap>
                        <Color value="6.28" color="red"/>
                        <Color value="3.14" color="blue"/>
                        <Color value="0.0" color="red"/>
                    </ColorMap>
                </Cells>
                <CellArrows style="1" orientation="3 * d / d.abs"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="10">
            <Input>
                <Symbol symbol-ref="cell.center.x"/>
                <Symbol symbol-ref="cell.center.y"/>
            </Input>
            <Output>
                <TextOutput file-separation="cell"/>
            </Output>
            <Plots>
                <Plot time-step="50">
                    <Style style="lines" line-width="2.0"/>
                    <Terminal terminal="png"/>
                    <X-axis minimum="0.0" maximum="size.x">
                        <Symbol symbol-ref="cell.center.x"/>
                    </X-axis>
                    <Y-axis minimum="0.0" maximum="size.y">
                        <Symbol symbol-ref="cell.center.y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="time"/>
                    </Color-bar>
                    <Range>
                        <Time mode="history" history="50"/>
                    </Range>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Cellular Potts Models/Proliferation in 2D/index.md
````markdown
---
MorpheusModelID: M0022

title: "Proliferation in Two Dimensions"
date: "2019-11-06T16:19:00+01:00"
lastmod: "2021-08-18T17:24:00+02:00"

aliases: [/examples/proliferation-in-two-dimensions/]

menu:
  Built-in Examples:
    parent: Cellular Potts Models
    weight: 20
weight: 120
---

## Introduction

This model shows a simulation of a growing cell population, using the cellular Potts model.

![](proliferation-2d.png "Growing cell population.")

## Description

The model specifies ```CellType``` which has a ```VolumeConstraint``` and a ```Proliferation``` plugin.  

In the ```Proliferation``` plugin, the ```Conditions``` for a cell to divide are given. Here, each cell that has more than 90% of the target volume has a small probability to divide. Once a division has taken place, the ```Equation``` defined in the ```Triggers``` elements are triggered.

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/51689598?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
````

## File: Built-in Examples/Cellular Potts Models/Proliferation in 2D/Proliferation_2D.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="3">
    <Description>
        <Title>Example-Proliferation2D</Title>
        <Details></Details>
    </Description>
    <Global>
        <Variable symbol="c" value="0.0"/>
    </Global>
    <Space>
        <Lattice class="hexagonal">
            <Size symbol="size" value="500 500 0"/>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime symbol="stoptime" value="4e4"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="cells">
            <Property symbol="p" value="5e-5" name="proliferation rate"/>
            <Property symbol="d" value="0" name="divisions"/>
            <Property symbol="c" value="0" name="color"/>
            <VolumeConstraint target="500" strength="1"/>
            <SurfaceConstraint target="0.9" mode="aspherity" strength="1"/>
            <System solver="euler" time-step="1.0">
                <Rule symbol-ref="c">
                    <Expression>if( c > 0, c-1, 0)</Expression>
                </Rule>
            </System>
            <CellDivision division-plane="random">
                <Condition>rand_uni(0,1) &lt; p</Condition>
                <Triggers>
                    <Rule symbol-ref="d">
                        <Expression>d+1</Expression>
                    </Rule>
                    <Rule symbol-ref="c" name="color after division">
                        <Expression>1000</Expression>
                    </Rule>
                </Triggers>
            </CellDivision>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction default="0">
            <Contact type1="cells" type2="cells" value="-4"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1.0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="3" yield="0.1"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>3</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population size="1" type="cells">
            <InitCircle mode="regular" number-of-cells="20">
                <Dimensions radius="35" center="250, 250, 0"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="1000" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells value="c" min="0.0" max="1">
                    <ColorMap>
                        <Color value="1" color="red"/>
                        <Color value="0.0" color="green"/>
                    </ColorMap>
                </Cells>
                <CellLabels fontsize="8" value="d"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="100">
            <Input>
                <Symbol symbol-ref="celltype.cells.size"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot log-commands="true" time-step="10000">
                    <Style point-size="0.5" grid="true" style="linespoints"/>
                    <Terminal terminal="png"/>
                    <X-axis minimum="0" maximum="stoptime">
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis minimum="0" maximum="100">
                        <Symbol symbol-ref="celltype.cells.size"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Cellular Potts Models/Proliferation in 3D/index.md
````markdown
---
MorpheusModelID: M0024

title: "Proliferation in Three Dimensions"
date: "2019-11-06T17:39:00+01:00"
lastmod: "2020-10-30T12:43:00+01:00"

aliases: [/examples/proliferation-in-three-dimensions/]

menu:
  Built-in Examples:
    parent: Cellular Potts Models
    weight: 40
weight: 140
---

## Introduction

This model shows a CPM simulation of a growing cell population in 3D.

![](proliferation-3d.png "Cell population grown from single initial cell.")

## Description

The model specifies ```CellType``` which has a ```VolumeConstraint``` and a ```Proliferation``` plugin.  In the ```Proliferation``` plugin, the ```Conditions``` for a cell to divide are given. Here, each cell that has more than 90% of the target volume has a small probability to divide. Once a division has taken place, the ```Equation``` defined in the ```Triggers``` elements are triggered.

In this model, two ```medium``` cell types have been defined. One of these (called *matrix*) is used to represent a matrix with higher adhesivity. This is done by

1. defining the *matrix* cell type as a ```BoundaryCondition``` of the $-z$ boundary in the ```CPM``` and
1. providing lower contact energy for cell-matrix interaction than for cell-medium interactions.

The simulation is visualized using the ```TiffPlotter``` that saves TIFF image stacks that can be loaded by image analysis software such as [Fiji](http://fiji.sc) and displayed using Fiji's 3D Viewer plugin.

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/47313357?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
````

## File: Built-in Examples/Cellular Potts Models/Proliferation in 3D/Proliferation_3D.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="3">
    <Description>
        <Title>Example-Proliferation3D</Title>
        <Details></Details>
    </Description>
    <Global/>
    <Space>
        <Lattice class="cubic">
            <Size symbol="size" value="100 100 100"/>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
                <Condition boundary="z" type="noflux"/>
                <Condition boundary="-z" type="noflux"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </Lattice>
        <MembraneLattice>
            <Resolution symbol="memsize" value="20"/>
            <SpaceSymbol symbol="m"/>
        </MembraneLattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="2500"/>
        <TimeSymbol symbol="time"/>
        <RandomSeed value="1456688742"/>
    </Time>
    <CellTypes>
        <CellType class="medium" name="medium"/>
        <CellType class="medium" name="matrix"/>
        <CellType class="biological" name="cell">
            <Property symbol="Vt" value="500" name="Target Volume"/>
            <Property symbol="divisions" value="0"/>
            <VolumeConstraint target="Vt" strength="1.0"/>
            <SurfaceConstraint target="1.0" mode="aspherity" strength="1.0"/>
            <CellDivision division-plane="major">
                <Condition>rand_uni(0,1) &lt; 0.0025 and cell.volume > Vt*0.9</Condition>
                <Triggers>
                    <Rule symbol-ref="divisions">
                        <Expression>divisions + 0.5</Expression>
                    </Rule>
                </Triggers>
            </CellDivision>
            <MembraneProperty symbol="c" value="1">
                <Diffusion rate="0.0"/>
            </MembraneProperty>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction default="0">
            <Contact type1="cell" type2="cell" value="-6"/>
            <Contact type1="cell" type2="medium" value="0"/>
            <Contact type1="cell" type2="matrix" value="-2"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="0.5"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population size="0" type="cell">
            <InitCellObjects mode="distance">
                <Arrangement repetitions="1, 1, 1" displacements="1, 1, 1">
                    <Object>
                        <Sphere radius="5" center="50,50,50"/>
                    </Object>
                </Arrangement>
            </InitCellObjects>
        </Population>
        <BoundaryValue boundary="x" value="matrix"/>
        <BoundaryValue boundary="-x" value="matrix"/>
        <BoundaryValue boundary="y" value="matrix"/>
        <BoundaryValue boundary="-y" value="matrix"/>
        <BoundaryValue boundary="z" value="matrix"/>
        <BoundaryValue boundary="-z" value="matrix"/>
    </CellPopulations>
    <Analysis>
        <TiffPlotter timelapse="true" format="8bit" OME-header="true" compression="false" time-step="100">
            <Channel symbol-ref="cell.id" exclude-medium="true"/>
            <Channel symbol-ref="c" exclude-medium="true" celltype="cell" outline="true"/>
        </TiffPlotter>
        <Gnuplotter time-step="100" decorate="true">
            <Plot>
                <Cells value="cell.id" slice="50"/>
            </Plot>
            <Terminal name="png"/>
        </Gnuplotter>
        <Logger time-step="100">
            <Input>
                <Symbol symbol-ref="celltype.cell.size"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="500">
                    <Style style="linespoints"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="celltype.cell.size"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Cellular Potts Models/Run and Tumble/index.md
````markdown
---
MorpheusModelID: M0025

title: "Run and Tumble"
date: "2019-11-06T17:49:00+01:00"
lastmod: "2020-10-30T12:48:00+01:00"

aliases: [/examples/run-and-tumble/]

menu:
  Built-in Examples:
    parent: Cellular Potts Models
    weight: 50
weight: 150
---

## Introduction

This example models a single cell that moves according to a [Lévy walk](https://en.wikipedia.org/wiki/L%C3%A9vy_flight): a random walk with occassional occurrence of long straight walks.

![](run-and-tumble.png "Modeling cell movements as a Lévy walk.")

## Description

The model defines a ```CPM``` cell that has two properties:

- A ```PropertyVector``` that gives the direction of movement and 
- a ```Property``` that defines the time when this direction of movement is changed.

The change in direction is using a ```VectorRule```. In this case, it specifies a new random direction for each of the three $x$, $y$, $z$ coordinates separately: ```move_dir``` = ```sin(angle), cos(angle), 0``` where ```angle``` = ```rand_uni(0, 2*pi)```.

This is calculated with an ```Event```. Upon triggering, this sets the new direction and a waiting time until the next change of direction. To model a superdiffusive Lévy walk, this waiting time is chosen from an exponential distribution: ```change_time``` = ```time + 20 * rand_gamma(0.5, 5)```.

Finally, the cell is made to move in the chosen direction using ```DirectedMotion``` that takes the ```PropertyVector``` as input.

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/111264192?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
````

## File: Built-in Examples/Cellular Potts Models/Run and Tumble/RunAndTumble.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>Example-RunAndTumble</Title>
        <Details>Models a Levy walk - a random walk strategy that is superior for searching due to it's high spatial coverage.

Shows how to manipulate PropertyVectors (x,z,y) using the VectorRule. An expression for each of the three coordinates must be given, separated by a comma ",".</Details>
    </Description>
    <Global>
        <Constant symbol="tumble.run_duration" value="0"/>
    </Global>
    <Space>
        <Lattice class="hexagonal">
            <Size symbol="size" value="300 300 0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="10000"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="amoeba">
            <VolumeConstraint target="200" strength="1"/>
            <ConnectivityConstraint/>
            <PropertyVector symbol="move_dir" value="0.0, 0.0, 0.0"/>
            <Property symbol="tumble.run_duration" value="0.0" name="run duration"/>
            <Property symbol="tumble.last" value="0" name="last tumble event"/>
            <Function symbol="tumble.time_left" name="time left">
                <Expression>tumble.last + tumble.run_duration - time</Expression>
            </Function>
            <DirectedMotion direction="move_dir" strength="0.2"/>
            <Event trigger="when true" time-step="5">
                <Condition>time >= tumble.last + tumble.run_duration</Condition>
                <Rule symbol-ref="tumble.last">
                    <Expression>time</Expression>
                </Rule>
                <Rule symbol-ref="tumble.run_duration" name="new update time">
                    <Expression>20 * rand_gamma(0.5, 5)</Expression>
                </Rule>
                <Intermediate symbol="angle" value="rand_uni(0, 2*pi)"/>
                <VectorRule symbol-ref="move_dir" spherical="true">
                    <Expression>angle, 0 , 1</Expression>
                </VectorRule>
            </Event>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="amoeba" type2="medium" value="4"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="0.6"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population size="1" type="amoeba">
            <Cell id="1" name="1">
                <Nodes>50,100,0</Nodes>
            </Cell>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="200" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells min="0.0">
                    <ColorMap>
                        <Color value="0" color="red"/>
                        <Color value="2" color="blue"/>
                    </ColorMap>
                </Cells>
                <CellArrows orientation="5 * move_dir"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="20">
            <Input>
                <Symbol symbol-ref="cell.center.x"/>
                <Symbol symbol-ref="cell.center.y"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="5000">
                    <Style style="lines" line-width="2.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="cell.center.x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="cell.center.y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="tumble.run_duration"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Cellular Potts Models/Stem Cells/Crypt.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>Example-Crypt</Title>
        <Details>Model ID:	https://identifiers.org/morpheus/M0026
Full title:	Stem Cells in the Intestinal Crypt
Date:	01.03.2016
Software:	Morpheus (open source). Download from: https://morpheus.gitlab.io
Comment:	Shows the following features of Morpheus: asymmetric cell division (proliferation), conditionally change cell type (ChangeCellType), loading simulation domain from image (Lattice/Domain).</Details>
    </Description>
    <Global>
        <Variable symbol="w_d" name="wait time division" value="3000"/>
        <Variable symbol="num_A" name="Clone A" value="0.0"/>
        <Variable symbol="num_B" name="Clone B" value="0.0"/>
        <Variable symbol="num_C" name="Clone C" value="0.0"/>
        <Variable symbol="num_D" name="Clone D" value="0.0"/>
        <Variable symbol="num_E" name="Clone E" value="0.0"/>
        <Constant symbol="s" value="0.0"/>
        <Constant symbol="clone" value="0.0"/>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="600 600 0"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <Domain boundary-type="noflux">
                <Image path="crypt.tiff"/>
            </Domain>
        </Lattice>
        <SpaceSymbol symbol="l"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="50000"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="stem_cells">
            <Property symbol="clone" value="0.0"/>
            <Property symbol="t_d" name="time of division" value="0.0"/>
            <Property symbol="s" name="stemness" value="1"/>
            <VolumeConstraint target="800" strength="1"/>
            <SurfaceConstraint target="1" strength="1" mode="aspherity"/>
            <ChangeCellType newCellType="TA_cells">
                <Condition>s==0</Condition>
                <Triggers/>
            </ChangeCellType>
            <DirectedMotion direction="0, -1,  0" strength="0.5"/>
            <CellDivision division-plane="random" daughterID="daughter">
                <Condition>time > t_d</Condition>
                <Triggers>
                    <Rule symbol-ref="s">
                        <Expression>if( daughter == 1, 1, 0 )</Expression>
                    </Rule>
                    <Rule symbol-ref="t_d">
                        <Expression>time + rand_norm(w_d,200)</Expression>
                    </Rule>
                </Triggers>
            </CellDivision>
        </CellType>
        <CellType class="biological" name="TA_cells">
            <Property symbol="clone" value="0.0"/>
            <Property symbol="t_d" name="time of division" value="0"/>
            <Property symbol="d" name="divisions" value="0"/>
            <VolumeConstraint target="600 " strength="1"/>
            <SurfaceConstraint target="0.9" strength="1" mode="aspherity"/>
            <CellDivision division-plane="random" daughterID="daughter">
                <Condition>time > t_d</Condition>
                <Triggers>
                    <Rule symbol-ref="d">
                        <Expression>d+0.5</Expression>
                    </Rule>
                    <Rule symbol-ref="t_d">
                        <Expression>time + rand_norm(w_d,500)</Expression>
                    </Rule>
                </Triggers>
            </CellDivision>
            <CellDeath>
                <Condition>if( cell.center.y > size.y - 20, 1, 0)</Condition>
            </CellDeath>
            <Mapper name="Count Clone A">
                <Input value="clone==1"/>
                <Output symbol-ref="num_A" mapping="sum"/>
            </Mapper>
            <Mapper name="Count Clone B">
                <Input value=" clone==2"/>
                <Output symbol-ref="num_B" mapping="sum"/>
            </Mapper>
            <Mapper name="Count Clone C">
                <Input value="clone==3"/>
                <Output symbol-ref="num_C" mapping="sum"/>
            </Mapper>
            <Mapper name="Count Clone D">
                <Input value="clone==4"/>
                <Output symbol-ref="num_D" mapping="sum"/>
            </Mapper>
            <Mapper name="Count Clone E">
                <Input value="clone==5"/>
                <Output symbol-ref="num_E" mapping="sum"/>
            </Mapper>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction default="0">
            <Contact type1="stem_cells" type2="stem_cells" value="-10"/>
            <Contact type1="stem_cells" type2="TA_cells" value="10"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1.0"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics yield="0.1" temperature="3"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="stem_cells" size="0">
            <InitRectangle number-of-cells="5" mode="regular">
                <Dimensions origin="250.0, 75.0, 0.0" size="100,30,0"/>
            </InitRectangle>
            <InitProperty symbol-ref="clone">
                <Expression>cell.id</Expression>
            </InitProperty>
            <InitProperty symbol-ref="t_d">
                <Expression>rand_uni(0,w_d)</Expression>
            </InitProperty>
        </Population>
        <Population type="TA_cells" size="0">
            <InitRectangle number-of-cells="500" mode="regular">
                <Dimensions origin="0,80, 0" size="600, 490, 0"/>
            </InitRectangle>
            <InitProperty symbol-ref="t_d">
                <Expression>rand_uni(0,w_d)</Expression>
            </InitProperty>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="250" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells value="clone">
                    <ColorMap>
                        <Color value="20" color="gold"/>
                        <Color value="19" color="dark-pink"/>
                        <Color value="18" color="dark-khaki"/>
                        <Color value="17" color="dark-goldenrod"/>
                        <Color value="16" color="cyan"/>
                        <Color value="15" color="coral"/>
                        <Color value="14" color="chartreuse"/>
                        <Color value="13" color="brown4"/>
                        <Color value="12" color="bisque"/>
                        <Color value="11" color="beige"/>
                        <Color value="10" color="light-red"/>
                        <Color value="9" color="light-green"/>
                        <Color value="8" color="light-blue"/>
                        <Color value="7" color="gray"/>
                        <Color value="6" color="black"/>
                        <Color value="5" color="yellow"/>
                        <Color value="4" color="blue"/>
                        <Color value="3" color="green"/>
                        <Color value="2" color="red"/>
                    </ColorMap>
                </Cells>
            </Plot>
        </Gnuplotter>
        <Logger time-step="100">
            <Input>
                <Symbol symbol-ref="num_A"/>
                <Symbol symbol-ref="num_B"/>
                <Symbol symbol-ref="num_C"/>
                <Symbol symbol-ref="num_D"/>
                <Symbol symbol-ref="num_E"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="5000" title="Clone numbers">
                    <Style grid="true" point-size="1" line-width="3.0" style="linespoints"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="num_A"/>
                        <Symbol symbol-ref="num_B"/>
                        <Symbol symbol-ref="num_C"/>
                        <Symbol symbol-ref="num_D"/>
                        <Symbol symbol-ref="num_E"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Cellular Potts Models/Stem Cells/index.md
````markdown
---
MorpheusModelID: M0026
aliases: [/examples/stem-cells-in-the-intestinal-crypt/]
menu:
  Built-in Examples:
    parent: Cellular Potts Models
    weight: 60
weight: 160

title: "Stem Cells in the Intestinal Crypt"

authors: []
contributors: []

# Reference details
publication:
  doi: ""
  title: ""
  journal: ""
  volume: 
  page: 
  year: 
  original_model: true

#categories:
#- DOI:

tags:
- Asymmetric Cell Division
- Asymmetric Division
- CellDivision
- Cell Type
- ChangeCellType
- Clonal Population
- Domain
- Global
- Intestinal Crypt
- Logger
- Mapper
- Proliferation
- Stem Cell
- TA Cell
- Transit Amplifying Cell
- Triggers
- Rules
- Variable
---
> Demonstrates the Morpheus features asymmetric cell division (<span title="//CellTypes/CellType/CellDivision">`CellDivision`</span>), conditional change of cell type (<span title="//CellTypes/CellType/ChangeCellType/Condition">`ChangeCellType`</span>) and loading a simulation domain from an <span title="//Space/Lattice/Domain/Image/@path">`Image`</span>.

{{% callout note %}}
This model also requires the separate file [`crypt.tiff`](#downloads).
{{% /callout %}}

## Introduction

This illustrative example shows the emergence of clonal populations from stem cells in an intestinal crypt. Stem cells in the bottom of the crypt divide asymmetrically and produce a population of transit amplifying (TA) cells. For each TA cell, the color indicates the stem cell from which it was derived.

![](crypt.png "Asymmetric cell division and changing cell type.")

## Description

The model shows several new modeling features, available as of [Morpheus 1.2](/download/latest).

### Loading Domain from Image

The crypt-like domain is specified by loading an external 8-bit TIFF image file [`crypt.tiff`](#downloads) using the <span title="//Space/Lattice/Domain/Image/@path">`Image`</span> feature.

### Asymmetric Cell Division

Stem cells divide asymmetrically using the new <span title="//CellTypes/CellType/CellDivision/@daughterID">`daughterID`</span> handles in the <span title="//CellTypes/CellType/CellDivision">`CellDivision`</span> element. This sets a user-defined symbol (here called <span title="//CellTypes/CellType/CellDivision/@daughterID = 'daughter'">`daughter`</span>) to either $1$ or $2$. This symbol can then be used to distinguish both daughter cells and treat them differently. In this example, it is used to set the stemness ($s$) of one <span title="//CellTypes/CellType/CellDivision/@daughterID = 'daughter'">`daughter`</span> to $1$ and the stemness of the other daughter cell to $0$.

### Conditionally Changing Cell Types

When a cell looses its stemness $s$, it is moved to the TA cell type. This is done using the <span title="//CellTypes/CellType/ChangeCellType">`ChangeCellType`</span> element. 

Upon satisfying its <span title="//CellTypes/CellType/ChangeCellType/Condition">`Condition`</span>, <span title="//CellTypes/CellType/ChangeCellType">`ChangeCellType`</span> moves the cell to the specified new cell type. By default, all the properties of a cell that exist in both cell type contexts are maintained, and unspecified ones are set to their default values. This default behavior can be overridden using <span title="//CellTypes/CellType/ChangeCellType/Triggers">`Triggers`</span> that specify <span title="//CellTypes/CellType[@name='TA_cells']/CellDivision/Triggers/Rule">`Rules`</span> stating how to deal with specific properties.

### Mapper

<span title="//CellTypes/CellType[@name='TA_cells']/Mapper">`Mappers`</span> allow the collection of statistical data about the cell population. Here, they are used to count the sizes of the various clonal populations. This number is reported into global <span title="//Global/Variable">`Variables`</span> and subsequently written to a file and plotted using a <span title="//Analysis/Logger">`Logger`</span>.

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/111262100?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
````

## File: Built-in Examples/Cellular Potts Models/Stem Cells/model.md
````markdown
{{% callout note %}}
This model also requires the separate file [`crypt.tiff`](#downloads).
{{% /callout %}}

![](M0026_stem-cells_model-graph.svg "Model Graph")
````

## File: Built-in Examples/Cellular Potts Models/index.md
````markdown
---
# Order
weight: 30
---
````

## File: Built-in Examples/Miscellaneous Models/Cellular Automata/GameOfLife.xml
````xml
<MorpheusModel version="3">
    <Description>Conway's Game of Life
---------------------

Classical Cellular Automaton with synchronized updates.


Rules:
- If alive, die when less than 2 live neighbors
- If alive, survive when 2 or 3 live neighbors (no change)
- If alive, die when more than 3 live neighbors
- If dead, become alive when exactly 3 live neighbors

<Title>Example-GameOfLife</Title>
        <Details>Simulates Conway's cellular automata model "Game of Life" by

1. summing the states of neighboring cells with NeighborhoodReporter
2. based on this sum, setting the cell state using a System of (synchronously updated) Rules.</Details>
    </Description>
    <Global>
        <Constant symbol="s" value="0"/>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="50 50 0"/>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="500"/>
        <SaveInterval value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="cell">
            <Property symbol="s" value="0.0" name="State_Living"/>
            <Property symbol="sum" value="0.0" name="Sum_Neighbors"/>
            <System solver="euler" time-step="1.0" name="Rules of life">
                <Rule symbol-ref="s">
                    <Expression>if((s == 1 and sum &lt;  2), 0,
  if((s == 1 and sum >  3), 0,
    if((s == 0 and sum == 3), 1, s)
  )
)
                    </Expression>
                </Rule>
            </System>
            <NeighborhoodReporter>
                <Input scaling="cell" value="s"/>
                <Output symbol-ref="sum" mapping="sum"/>
            </NeighborhoodReporter>
        </CellType>
    </CellTypes>
    <CellPopulations>
        <Population size="0" type="cell">
            <InitProperty symbol-ref="s">
                <Expression>if(rand_uni(0,1) > 0.75, 1, 0)</Expression>
            </InitProperty>
            <InitCellLattice/>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="20" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells value="s">
                    <ColorMap>
                        <Color value="1" color="black"/>
                        <Color value="0.0" color="white"/>
                    </ColorMap>
                </Cells>
            </Plot>
        </Gnuplotter>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Miscellaneous Models/Cellular Automata/index.md
````markdown
---
MorpheusModelID: M0041

title: "Game of Life: Cellular Automata"
date: "2019-11-10T09:58:00+01:00"
lastmod: "2020-10-30T13:46:00+01:00"

aliases: [/examples/game-of-life-cellular-automata/]

menu:
  Built-in Examples:
    parent: Miscellaneous Models
    weight: 10
weight: 510
---
## Introduction

This example models probably the best-known classic cellular automaton (CA) model: [Conway's Game of Life](https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life). It shows an alternative use of ```System``` for synchronous updating of ```Equations```.

![](game-of-life.png "Conway´s Game of Life.")

## Description

In this model, the lattice is filled with cells of size $1$. Each cell counts the number of neighboring cells that are 'alive' and acts accordingly. The rules that make up the Game of Life are implemented in a ```System``` of ```Equations``` in which all ```Equations``` are updated synchronously.

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/47171614?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

## Things to try

- Change the ```Neighborhood``` from a Moore (2nd order) to von Neumann (1st order).
````

## File: Built-in Examples/Miscellaneous Models/Minimal Model/index.md
````markdown
---
MorpheusModelID: M0043

title: "Minimal Model"
date: "2019-11-10T09:49:00+01:00"
lastmod: "2020-10-30T13:50:00+01:00"

aliases: [/examples/minimal-model/]

menu:
  Built-in Examples:
    parent: Miscellaneous Models
    weight: 40
weight: 540

draft: true
---
## Introduction

This example does nothing -- expect being the minimal valid Morpheus model. Such a model is generated when choosing ```File``` → ```New```.

![](minimal-model.png "Minimal valid XML model.")

## Description

The basic model only includes the required nodes ```MorpheusModel```, ```Description```, ```Space``` and ```Time```. Their required nodes and attributes are added recursively, such as ```Lattice``` class and ```StopTime``` value.

## Things to try

- Invalidate this minimal model by editing it (but keeping it well-formed). When opening this model in Morpheus GUI, it triggers a warning saying what went wrong and how it was solved. Check the ```Fixboard``` to see the changes that were made to the model.

## More information

- FAQ: [Your First Model](/faq/modeling/first-model/)
````

## File: Built-in Examples/Miscellaneous Models/Minimal Model/MinimalModel.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="1">
    <Description>
        <Title></Title>
    </Description>
    <Space>
        <Lattice class="linear">
            <Size value="0 0 0"/>
        </Lattice>
    </Space>
    <Time>
        <StartTime value="1.0"/>
        <StopTime value="1.0"/>
    </Time>
</MorpheusModel>
````

## File: Built-in Examples/Miscellaneous Models/Minimal Model/model.md
````markdown
In Morpheus GUI: ```File``` → ```New```.
````

## File: Built-in Examples/Miscellaneous Models/Morphogen Gradient/FrenchFlag.xml
````xml
<MorpheusModel version="3">
    <Description>
        <Title>Example-FrenchFlag</Title>
        <Details>Wolpert L (1969). "Positional information and the spatial pattern of cellular differentiation". J. Theor. Biol. 25 (1): 1–47.</Details>
    </Description>
    <Global>
        <Field symbol="m" value="c_0*exp(-k/D*(l.x/size.x))" name="morphogen gradient">
            <Diffusion rate="0.0"/>
        </Field>
        <Constant symbol="c_0" value="1.0"/>
        <Constant symbol="D" value="0.75"/>
        <Constant symbol="k" value="1"/>
        <Constant symbol="celltype" value="0.0"/>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="20 20 0"/>
            <NodeLength value="1"/>
            <BoundaryConditions>
                <Condition boundary="x" type="constant"/>
                <Condition boundary="y" type="constant"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="l" name="location"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="cells">
            <Property symbol="p" value="0.0" name="p"/>
            <Property symbol="celltype" value="0.0" name="cell type"/>
            <Constant symbol="t1" value="0.7"/>
            <Constant symbol="t2" value="0.4"/>
            <Equation symbol-ref="celltype">
                <Expression>if(p>t1,3, if(p>t2, 2, 1))</Expression>
            </Equation>
            <Mapper name="report morphogen concentration">
                <Input value="m"/>
                <Output symbol-ref="p" mapping="average"/>
            </Mapper>
        </CellType>
    </CellTypes>
    <CellPopulations>
        <Population size="0" type="cells">
            <InitCellLattice/>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="0">
            <Terminal opacity="0.5" persist="true" name="png"/>
            <Plot>
                <Cells value="celltype">
                    <ColorMap>
                        <Color value="3" color="blue"/>
                        <Color value="2" color="white"/>
                        <Color value="1" color="red"/>
                    </ColorMap>
                </Cells>
                <Field symbol-ref="m"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="0.0">
            <Input>
                <Symbol symbol-ref="m"/>
                <Symbol symbol-ref="celltype"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Restriction>
                <Slice value="size.y/2" axis="y"/>
            </Restriction>
            <Plots>
                <Plot>
                    <Style style="linespoints"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="l.x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="m"/>
                        <Symbol symbol-ref="celltype"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Miscellaneous Models/Morphogen Gradient/index.md
````markdown
---
MorpheusModelID: M0042

title: "French Flag: Morphogen Gradient"
date: "2019-11-10T10:08:00+01:00"
lastmod: "2020-10-30T13:48:00+01:00"

aliases: [/examples/french-flag-morphogen-gradient/]

menu:
  Built-in Examples:
    parent: Miscellaneous Models
    weight: 20
weight: 520
---
## Introduction

This example shows Wolpert's classical [French Flag model](https://en.wikipedia.org/wiki/French_flag_model). Depending on the local concentration of a morphogen, cells adopt one of three cell types based on internal thresholds.

![](french-flag.png "Wolpert´s French Flag.")

## Description

The model sets up a morphogen gradient in the $x$ direction as a 2D field in the ```Global``` section. Note that no diffusion is used, since we use the steady-state solution of the diffusion and degradation process with fixed boundary source.

The cells in ```CellType``` register the (average) local morphogen concentration using a ```Mapper```. Based on the specified threshold values, they choose an identity $I$ as defined in the ```Equation```.

Note that this model is not time-dependent. ```Time``` is therefore set from ```StartTime``` $0$ to ```StopTime``` $0$.

## Things to try

[//]: # (- Change the physical length of the domain by editing ```Space``` → ```NodeLength``` that controls the physical size per lattice site.)
- Change the model such that the morphogen gradient is set up by production and diffusion, using ```Diffusion```  and a ```System``` with ```DiffEqn```. That is, change the model into a time-dependent model.
````

## File: Built-in Examples/Miscellaneous Models/Particle Aggregation/index.md
````markdown
---
MorpheusModelID: M0044

title: "FlipCells: Particle Aggregation"
date: "2019-11-10T10:16:00+01:00"
lastmod: "2020-10-30T13:52:00+01:00"

menu:
  Built-in Examples:
    parent: Miscellaneous Models
    weight: 30
weight: 530
---
## Introduction

This models approximates an interacting particle system (IPS) model of particle aggregation. Each black dot represents a particle that moved due to spin flips with random neighbors. The particles perform random walks in which the probability of moving depends on the number of neighboring cells.

![](particle-aggregation.png "Aggregation of moving particles.")

## Description

Each lattice site (white or black) counts the number of particles (black neighboring sites) using a ```NeighborsReporter```. 

The probability of movement of each particle is made dependent on its number of neighbors by using it in the ```Condition``` of ```FlipCells```. When this condition is satisfied, the particle changes positions with a random neighboring lattice site.

A ```PopulationReporter``` is used to return the fraction of isolated black particles. This number is logged and plotted using the ```Logger```.

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/111263973?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

## Things to try

- Change the parameter $p$.
````

## File: Built-in Examples/Miscellaneous Models/Particle Aggregation/ParticleAggregation.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="3">
    <Description>
        <Title>Example-ParticleAggregation</Title>
        <Details>Shows new FlipCells plugin
</Details>
    </Description>
    <Global>
        <Variable symbol="sn" value="0" name="Sum of non-isolated cells"/>
        <Constant symbol="s" value="0"/>
    </Global>
    <Space>
        <Lattice class="hexagonal">
            <Size symbol="size" value="40, 40, 0"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="l"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="5000"/>
        <!--    <Disabled>
        <RandomSeed value="1415712648"/>
    </Disabled>
-->
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="spins">
            <Property symbol="s" value="0.0" name="state"/>
            <DelayProperty symbol="s_n" value="0.0" delay="1" name="state_neighbors"/>
            <Property symbol="p" value="2.25" name="probability"/>
            <Function symbol="ni" name="non-isolated">
                <Expression>if(s==1 and s_n > 1, 1, 0)</Expression>
            </Function>
            <NeighborhoodReporter>
                <Input scaling="cell" value="s"/>
                <Output symbol-ref="s_n" mapping="sum"/>
            </NeighborhoodReporter>
            <FlipCellMotion neighborhood="2" time-step="1">
                <Condition>s > 0 and rand_uni(0,1) &lt; (1-(s_n/12)*p)</Condition>
            </FlipCellMotion>
            <Mapper>
                <Input value="ni"/>
                <Output symbol-ref="sn" mapping="sum"/>
            </Mapper>
        </CellType>
    </CellTypes>
    <CellPopulations>
        <Population size="0" type="spins">
            <InitProperty symbol-ref="s">
                <Expression>if(rand_uni(0,1) &lt; 0.10, 1, 0)</Expression>
            </InitProperty>
            <InitCellLattice/>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="100" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells value="s">
                    <ColorMap>
                        <Color value="1" color="black"/>
                        <Color value="0.0" color="white"/>
                    </ColorMap>
                </Cells>
            </Plot>
        </Gnuplotter>
        <Logger time-step="25">
            <Input>
                <Symbol symbol-ref="sn"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="250">
                    <Style style="lines" line-width="3.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="sn"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Miscellaneous Models/index.md
````markdown
---
# Order
weight: 50
---
````

## File: Built-in Examples/Multiscale Models/Autocrine Chemotaxis/AutocrineChemotaxis.xml
````xml
<MorpheusModel version="3">
    <Description>
        <Title>Example-AutocrineChemotaxis</Title>
        <Details></Details>
    </Description>
    <Global>
        <Field symbol="U" value="0" name="chemoattractant">
            <Diffusion rate="0.1"/>
        </Field>
        <System solver="euler" time-step="10.0">
            <DiffEqn symbol-ref="U">
                <Expression>p - d*U</Expression>
            </DiffEqn>
            <Constant symbol="d" value="0.01" name="degradation U"/>
        </System>
        <Constant symbol="cell_density" value="0.003"/>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="200 200 0"/>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
            </BoundaryConditions>
            <NodeLength value="1.0"/>
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="2.5e4"/>
        <SaveInterval value="0"/>
        <RandomSeed value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="cells">
            <!--    <Disabled>
        <Property symbol="cell" value="1.0"/>
    </Disabled>
-->
            <Property symbol="c" value="100.0" name="chemotactic strength"/>
            <Property symbol="p" value="0.01" name="production chemoattractant"/>
            <Property symbol="neighbors" value="0" name="number of neighboring cells"/>
            <VolumeConstraint target="60" strength="1"/>
            <SurfaceConstraint target="0.85" mode="aspherity" strength="1"/>
            <Chemotaxis field="U" contact-inhibition="false" strength="c" retraction="true"/>
            <NeighborhoodReporter>
                <Input scaling="cell" value="cell.type == celltype.cells.id"/>
                <Output symbol-ref="neighbors" mapping="sum"/>
            </NeighborhoodReporter>
        </CellType>
        <CellType class="medium" name="medium">
            <Constant symbol="neighbors" value="0.0"/>
            <Constant symbol="p" value="0.0" name="production"/>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction default="0.0">
            <Contact type1="cells" type2="medium" value="-10"/>
            <Contact type1="cells" type2="cells" value="-20"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1.0"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="10.0"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population size="0" type="cells">
            <InitRectangle mode="regular" number-of-cells="cell_density * size.x * size.y">
                <Dimensions size="size.x, size.y, 0" origin="0.0, 0.0, 0.0"/>
            </InitRectangle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="500" decorate="false">
            <Terminal opacity="0.55" persist="true" name="png"/>
            <Plot>
                <Field symbol-ref="U" isolines="5" min="0.0" surface="true"/>
                <Cells>
                    <ColorMap>
                        <Color value="2.0" color="gray"/>
                        <Color value="0" color="gray"/>
                    </ColorMap>
                </Cells>
            </Plot>
        </Gnuplotter>
        <DependencyGraph format="svg" exclude-plugins="Gnuplotter"/>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Multiscale Models/Autocrine Chemotaxis/index.md
````markdown
---
MorpheusModelID: M0031

title: "Coupling Spatial Models: Autocrine Chemotaxis"
date: "2019-11-07T10:42:00+01:00"
lastmod: "2020-10-30T13:29:00+01:00"

aliases: [/examples/coupling-spatial-models-autocrine-chemotaxis/]

menu:
  Built-in Examples:
    parent: Multiscale Models
    weight: 10
weight: 170
---

## Introduction

This example models a cellular Potts model for autocrine chemotaxis by coupling a CPM to a diffusive chemoattractant.

![](cpm-pde.png "Cell cluster due to chemotaxis towards self-produced chemoattractant.")

## Description

It exemplifies the combination of a ```CPM``` with a ```PDE``` through the chemotaxis towards a diffusive chemoattractant produced by cells. The ```CellType``` has a ```Property``` $p$ (production rate) which is positive within biological cells, and is zero in the ```medium``` cell type. The symbol $p$ can than be used in the ```PDE``` as the production term for species or ```Layer``` $U$. In this way, $U$ is produced in each lattice node that is occupied by a cell, and is not produced outside of cells. At the same time, cells perform ```Chemotaxis``` towards the chemoattractant $U$.

The simulation is visualized using some advanced ```Gnuplotter``` feature. Cells are ```superimposed``` on the PDE and appear as transparent domains (see ```opacity```). Moreover, the concentration gradient of the PDE is emphasized by the use of ```isolines``` that draws contours as positions with equal concentration.

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/47176046?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
````

## File: Built-in Examples/Multiscale Models/Cell Cycle and Proliferation/CellCycle.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="3">
    <Description>
        <Title>Example-CellCycle</Title>
        <Details>ODE model of Xenopus oocyte cell cycle adopted from:

James Ferrell, Tony Yu-Chen Tsai and Qiong Yang (2011) Modeling the Cell Cycle: Why Do Certain Circuits Oscillate?, Cell 144, p874-885. http://dx.doi.org/10.1016/j.cell.2011.03.006</Details>
    </Description>
    <Global/>
    <Space>
        <Lattice class="hexagonal">
            <Size symbol="size" value="250 250 0"/>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="1"/>
        <TimeSymbol symbol="time"/>
        <RandomSeed value="3445"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="cells">
            <Property symbol="CDK1" value="0" name="Cyclin-dependent kinase 1"/>
            <Property symbol="Plk1" value="0" name="Polo-like kinase 1"/>
            <Property symbol="APC" value="0" name="Anaphase-promoting complex"/>
            <System solver="runge-kutta" time-scaling="20" time-step="4e-2">
                <DiffEqn symbol-ref="CDK1">
                    <Expression>α1 - β1 * CDK1 * (APC^n / (K^n + APC^n))</Expression>
                </DiffEqn>
                <DiffEqn symbol-ref="Plk1">
                    <Expression>α2*(1-Plk1) * ((CDK1^n) / (K^n + CDK1^n)) - β2*Plk1</Expression>
                </DiffEqn>
                <DiffEqn symbol-ref="APC">
                    <Expression>α3*(1- APC) * ((Plk1^n) / (K^n + Plk1^n)) - β3*APC</Expression>
                </DiffEqn>
                <Constant symbol="n" value="8" name="Hill coefficient"/>
                <Constant symbol="K" value="0.5" name="Michaelis constant"/>
                <Constant symbol="α1" value="0.1"/>
                <Constant symbol="α2" value="3.0"/>
                <Constant symbol="α3" value="3.0"/>
                <Constant symbol="β1" value="3.0"/>
                <Constant symbol="β2" value="1.0"/>
                <Constant symbol="β3" value="1.0"/>
            </System>
            <Property symbol="p" value="0" name="portion"/>
            <Property symbol="d" value="0" name="divisions"/>
            <Property symbol="c" value="0" name="division timeout"/>
            <Property symbol="cc" value="1" name="cellcount"/>
            <Property symbol="Vt" value="25000" name="Target volume"/>
            <VolumeConstraint target="Vt" strength="1"/>
            <SurfaceConstraint target="1.0" mode="aspherity" strength="1"/>
            <Event>
                <Condition>CDK1&lt;0.2</Condition>
                <Rule symbol-ref="c">
                    <Expression>0</Expression>
                </Rule>
            </Event>
            <CellDivision division-plane="minor">
                <Condition>if(CDK1 > 0.5 and c == 0, 1, 0)</Condition>
                <Triggers>
                    <Rule symbol-ref="d">
                        <Expression>d+0.5</Expression>
                    </Rule>
                    <Rule symbol-ref="c">
                        <Expression>1</Expression>
                    </Rule>
                    <Rule symbol-ref="Vt">
                        <Expression>Vt/2</Expression>
                    </Rule>
                </Triggers>
            </CellDivision>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction default="0">
            <Contact type1="cells" type2="cells" value="-20"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="5e-5"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="10" yield="0.1"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>3</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population size="0" type="cells">
            <InitCellObjects mode="order">
                <Arrangement repetitions="1, 1, 1" displacements="1, 1, 1">
                    <Sphere radius="40" center="125,100,0"/>
                </Arrangement>
            </InitCellObjects>
            <InitProperty symbol-ref="CDK1">
                <Expression>0.25</Expression>
            </InitProperty>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="0.05" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells value="CDK1">
                    <ColorMap>
                        <Color value="0.5" color="red"/>
                        <Color value="0.2" color="yellow"/>
                    </ColorMap>
                </Cells>
            </Plot>
        </Gnuplotter>
        <Logger time-step="2e-3">
            <Input>
                <Symbol symbol-ref="APC"/>
                <Symbol symbol-ref="CDK1"/>
                <Symbol symbol-ref="Plk1"/>
            </Input>
            <Output>
                <TextOutput file-format="csv"/>
            </Output>
            <Plots>
                <Plot time-step="-1">
                    <Style style="points" line-width="4.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="APC"/>
                        <Symbol symbol-ref="CDK1"/>
                        <Symbol symbol-ref="Plk1"/>
                    </Y-axis>
                </Plot>
                <Plot time-step="-1">
                    <Style style="points" line-width="4.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="CDK1"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="APC"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="Plk1"/>
                    </Color-bar>
                </Plot>
            </Plots>
            <Restriction>
                <Celltype celltype="cells"/>
            </Restriction>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Multiscale Models/Cell Cycle and Proliferation/index.md
````markdown
---
MorpheusModelID: M0033

authors: [J. E. Ferrell Jr., T. Y. Tsai, Q. Yang]

title: "ODEs in CPM Cells: Cell Cycle and Proliferation"
date: "2019-11-11T11:29:00+01:00"
lastmod: "2021-02-23T20:23:00+01:00"

aliases: [/examples/odes-in-cpm-cells-cell-cycle-and-proliferation/]

menu:
  Built-in Examples:
    parent: Multiscale Models
    weight: 30
weight: 190

tags:
- Cell Cycle
- CellTypes
- CPM
- DOI:10.1016/j.cell.2011.03.006
- Gnuplotter
- MCSDuration
- ODE
- Proliferation
- Time-Scaling
- Time-Step
- Xenopus
---
>ODE model of the *Xenopus* oocyte cell cycle coupled to 2D shaped CPM cells that perform divide based on component concentrations

## Introduction

This multiscale model example shows

1. how to define a coupled system of continuous ODEs in discrete CPM cells,
1. how to specify and change time scales between these model formalisms.

![](cell-cycle.png "Cells divide according to an oscillatory ODE model representing the early cell cycle in *Xenopus*.")

## Description

This model specifies an oscillatory ODE model representing the cell cycle in Xenopus oocytes using three components ($\text{CDK1}$, $\text{Plk1}$, $\text{APK}$) ([Ferrell *et al.*, 2011][ferrell-2011]) (see `CellTypes` → `CellType` → `System`). This ODE model is coupled to 2D shaped CPM cells that perform divide based on the concentration of these components (see `CellTypes` → `CellType` → `Proliferation` → ```Condition```). As in the early *Xenopus* cell cleavage, this leads to exponential growth of the number of cells, without increase of total cell volume.

### Time scales

Time scales are defined in the following fashion:

- The so-called global time scheme is defined in `Time` and here runs from $0$ to $1$ arbitrary time units. All models and plugins specify their updating scheme in terms this global time scheme (e.g. `Analysis` → `Gnuplotter` → `Interval`).
- The CPM time scale for cell motility and behaviours is defined in `CPM` → `MCSDuration`. This specifies the time that a single Monte Carlo step in the CPM lasts, in terms of the 'global time'. Here, the `MCSDuration` is $1.0\cdot10^{-4}$ which means the CPM is executed 10.000 times during this simulation.
- For setting time of ODEs, one has to distinguish the (1) how often the ODEs are evaluated from (2) controlling the time scale of the ODE dynamics:
    1. The time scale of the ODE dynamics can be changed using `System` → `time-scaling`. When larger or smaller than `1.0`, this speeds up or slows down the dynamics without influencing the accuracy of the approximation.
    1. The accuracy of the numerical approximation (and is equal to the $\Delta t$ of the numerical solver) is controlled using `System` → `time-step` (and is automatically rescaled according to the time scale).

## Things to Try

- Change the CPM time scale, relative to the ODE dynamics: Change `CPM` → `MCSDuration` to $1.0\cdot10^{-3}$ or decrease to $1.0\cdot10^{-5}$. This makes cells to have less resp. more motility/relaxation in between cell divisions.
- Change the time scale of the ODE dynamics relative to the CPM by altering `System` → `time-scaling`.

## Reference

>J. E. Ferrell Jr., T. Y. Tsai, Q. Yang: [Modeling the Cell Cycle: Why Do Certain Circuits Oscillate?][ferrell-2011] *Cell* **144** (6): 874-885, 2011.

[ferrell-2011]: http://dx.doi.org/10.1016/j.cell.2011.03.006
````

## File: Built-in Examples/Multiscale Models/Cell Polarization and Chemotaxis/CellPolarity.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Example-CellPolarity</Title>
        <Details>Chemotaxis of polarized cell
----------------------------
Show feedback between cell motility, cell polarization and external gradient.
 
Two cell polarization models are taken from the original publication:
Y. Mori, A. Jilkine and L. Edelstein-Keshet (2008). Wave-Pinning and Cell Polarity from a Bistable Reaction-Diffusion System. Biophysical Journal 94(9), 3684-3697. DOI:10.1529/biophysj.107.120824

and can be enabled/disabled for a cell in 3D through the respective System in the Celltype 'cells':
- Substrate-depletion model: no repolarization
- Wave-pinning model: repolarization (as studied in detail in the above publication)
 
Events in Global:
- Switch on/off and change gradients (noise through global constant)</Details>
    </Description>
    <Global>
        <Field symbol="U" value="noisy(l.x / lattice.x)">
            <Diffusion rate="0.0"/>
        </Field>
        <Event trigger="on-change" time-step="100">
            <Condition>time>=1000</Condition>
            <Rule symbol-ref="U">
                <Expression>noisy(0.5)</Expression>
            </Rule>
        </Event>
        <Event trigger="on-change" time-step="100">
            <Condition>time>=1500</Condition>
            <Rule symbol-ref="U">
                <Expression>noisy((lattice.x-l.x) / lattice.x)</Expression>
            </Rule>
        </Event>
        <Constant symbol="l_U" value="0.0"/>
        <Constant symbol="lengthscale" value="3"/>
        <Constant symbol="noise" value="0.2"/>
        <Function symbol="noisy">
            <Parameter symbol="v" name="value"/>
            <Expression>max(0,(v+rand_norm(0,noise)))</Expression>
        </Function>
    </Global>
    <Space>
        <Lattice class="cubic">
            <Size symbol="lattice" value="150, 75, 30"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
                <Condition type="constant" boundary="z"/>
            </BoundaryConditions>
            <NodeLength value="1.0"/>
            <Neighborhood>
                <Distance>2.0</Distance>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="l"/>
        <MembraneLattice>
            <Resolution symbol="memsize" value="50"/>
            <SpaceSymbol symbol="m"/>
        </MembraneLattice>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="2500"/>
        <SaveInterval value="0"/>
        <RandomSeed value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType name="cells" class="biological">
            <VolumeConstraint target="5000" strength="0.1"/>
            <SurfaceConstraint target="1" strength="0.02" mode="aspherity"/>
            <MembraneProperty symbol="A" name="A" value="1.5 + rand_uni(-0.1,0.1)">
                <Diffusion rate="0.05*lengthscale^2"/>
            </MembraneProperty>
            <MembraneProperty symbol="B" name="B" value="0.8">
                <Diffusion rate="10*lengthscale^2"/>
            </MembraneProperty>
            <MembraneProperty symbol="c" name="chemotactic strength" value="0">
                <Diffusion rate="0"/>
            </MembraneProperty>
            <MembraneProperty symbol="s" name="signal" value="0">
                <Diffusion rate="0"/>
            </MembraneProperty>
            <System time-step="0.05" name="WavePinning" solver="Dormand-Prince [adaptive, O(5)]">
                <Constant symbol="k_0" value="0.067"/>
                <Constant symbol="gamma" value="1"/>
                <Constant symbol="delta" value="1"/>
                <Constant symbol="K" value="1"/>
                <!--    <Disabled>
        <Constant symbol="sigma" name="spatial-length-signal" value="5.0"/>
    </Disabled>
-->
                <Constant symbol="n" name="Hill coefficient" value="2"/>
                <Intermediate symbol="F" value="B*(k_0+ 0.2*(s-U.mean) + (gamma*A^n) / (K^n + A^n) ) - delta*A"/>
                <DiffEqn symbol-ref="A">
                    <Expression>F</Expression>
                </DiffEqn>
                <DiffEqn symbol-ref="B">
                    <Expression>-F</Expression>
                </DiffEqn>
                <Rule symbol-ref="c">
                    <Expression>A^2*1000</Expression>
                </Rule>
            </System>
            <Mapper name="Sensing the field">
                <Input value="U"/>
                <Output symbol-ref="s" mapping="average"/>
            </Mapper>
            <PropertyVector symbol="p" name="polarity" value="0.0, 0.0, 0.0"/>
            <Mapper name="Polarity extraction from membrane">
                <Input value="A"/>
                <Polarity symbol-ref="p"/>
            </Mapper>
            <DirectedMotion strength="0.04" direction="p"/>
            <!--    <Disabled>
        <System time-step="0.05" name="Substrate-Depletion(ASDM)" solver="Dormand-Prince [adaptive, O(5)]">
            <Rule symbol-ref="c">
                <Expression>A^2*5e1</Expression>
            </Rule>
            <DiffEqn symbol-ref="A">
                <Expression>B*(s.norm*A^2/(1+s_a*A^2)) - r_a * A</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="B">
                <Expression>b_b - B*(s.norm*A^2/(1+s_a*A^2)) - r_b*B</Expression>
            </DiffEqn>
            <Constant symbol="s_a" value="0.1"/>
            <Constant symbol="r_a" value="0.1"/>
            <Constant symbol="b_b" value="0.15"/>
            <Constant symbol="r_b" value="0.0"/>
            <Function symbol="s.norm">
                <Expression>0.1+0.01*(s-U.mean)/U.mean</Expression>
            </Function>
            <Disabled>
                <Constant symbol="s.norm" value="0.1"/>
            </Disabled>
        </System>
    </Disabled>
-->
            <Property symbol="U.mean" value="0.0"/>
            <Mapper name="scalar signal average over whole cell">
                <Input value="U"/>
                <Output symbol-ref="U.mean" mapping="average"/>
            </Mapper>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction default="0.0"/>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics yield="0.05" temperature="1"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>6</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="cells" size="0">
            <InitCellObjects mode="distance">
                <Arrangement repetitions="1, 1, 1" displacements="1, 1, 1">
                    <Sphere center="25 37 15" radius="10"/>
                </Arrangement>
            </InitCellObjects>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="50">
            <Terminal name="png"/>
            <Plot slice="15">
                <Field symbol-ref="U"/>
                <Cells min="0.2" value="A"/>
                <CellArrows orientation="p * 50"/>
            </Plot>
        </Gnuplotter>
        <TiffPlotter time-step="100" format="8bit" OME-header="false">
            <Channel symbol-ref="cell.id" celltype="cells"/>
            <Channel symbol-ref="c" celltype="cells"/>
            <Channel symbol-ref="U"/>
        </TiffPlotter>
        <Logger time-step="50">
            <Input>
                <Symbol symbol-ref="A"/>
            </Input>
            <Output>
                <TextOutput file-format="matrix"/>
            </Output>
            <Plots>
                <SurfacePlot time-step="50">
                    <Color-bar>
                        <Symbol symbol-ref="A"/>
                    </Color-bar>
                    <Terminal terminal="png"/>
                </SurfacePlot>
            </Plots>
            <Restriction>
                <Celltype celltype="cells"/>
            </Restriction>
        </Logger>
        <ModelGraph include-tags="#untagged" format="svg" reduced="false"/>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Multiscale Models/Cell Polarization and Chemotaxis/index.md
````markdown
---
MorpheusModelID: M0035

authors: [Y. Mori, A. Jilkine, L. Edelstein-Keshet]
contributors: [J. Starruß, L. Brusch]

title: "MembraneProperties: Cell Polarization and Chemotaxis"
date: "2019-11-11T16:59:00+01:00"
lastmod: "2022-12-02T13:36:00+01:00"

# Reference details
publication:
  doi: "10.1529/biophysj.107.120824"
  title: "Wave-Pinning and Cell Polarity from a Bistable Reaction-Diffusion System."
  journal: "Biophysical Journal"
  volume: "94(9)"
  page: "3684-3697"
  year: 2008
  original_model: false

aliases: [/examples/membraneproperties-cell-polarization-and-chemotaxis/]

menu:
  Built-in Examples:
    parent: Multiscale Models
    weight: 50
weight: 210
---
## Introduction

This model of cell polarity shows the coupling of three model formalisms:

- A cellular Potts model with ```DirectedMotion``` that responds to cell polarity (but not directly to the external signal gradient),
- a co-moving PDE model on the membrane of the cell (to let cell polarity emerge from distributed receptor-signal interactions) and
- an external signal gradient (implemented as a global field with random fluctuations).

The cell membrane polarizes in response to the external signal _U_ that is sensed as a pattern (of receptor activation) _s_ along the cell membrane.

![](cellpolarity0060.png "Cell dynamically repolarizes in response to switching external gradient.")

## Description

This example implements two models of cell polarity formation: Meinhardt's substrate-depletion model (ASDM) and Edelstein-Keshet's wave-pinning (WP) model. The user can switch the polarity model by ```disabling```/```enabling``` the relevant ```System``` under ```CellType```. Equations and parameter values are copied from [Mori _et al._](#reference).

Each model defines a two-component reaction-diffusion system (of ```MembraneProperty``` _A_ and _B_) representing membrane-bound molecules, and is mapped to and co-moves with a cell. Cell motility and cell shape dynamics are given by the cellular Potts model. An external gradient with random fluctuations, specified in ```Global```, provides a signal for the polarization of the cell. In turn, the pattern of the ```MembraneProperty``` _A_ gives the polarity vector of the cell. The polarity vector then controls the ```DirectedMotion``` behavior of the cell. A ```TiffPlotter``` exports the full 3D plus time data set.

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/60636346?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

After a switch in direction of the gradient, the cell re-polarizes in the new direction and starts to move in the new direction, if the wave pinning model has been selected (see video below). A ```GnuPlotter``` visualizes the gradient, cell shape and ```MembraneProperty``` _A_ at a horizontal slice through 3D space (shown below) and a ```Logger``` visualizes the (_phi, theta_)-dependency of the ```MembraneProperty``` _A_ (not shown). 

![](Video_WP.mp4)

The alternative ASDM maintains its previous polarity for much longer and does not re-polarize during the runtime (see video below). On a longer time scale, the ASDM may eventually re-polarize the 3D cell by rotating the activator maximum over the cell membrane. The cell would take a U-turn with a large radius. The same behaviours are observed for any other strength of the gradient's fluctuations as well as for a smooth gradient.

![](Video_ASDM.mp4)
````

## File: Built-in Examples/Multiscale Models/Cell Polarization and Chemotaxis/model.md
````markdown
![](model-graph.svg "Model Graph")
````

## File: Built-in Examples/Multiscale Models/Dictyostelium/Dictyostelium.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="3">
    <Description>
        <Title>Example-Dictyostelium</Title>
        <Details>Aggregation of dictyostelium by chemotactic amoeba as excitable medium mediated by diffusive cAMP signal.

Original reference:
- Nicholas Savill and Paulien Hogeweg, Modelling morphogenesis: from single cells to crawling slugs, J. Theo. Biol., 1997.

Morpeus implementation by ECMI 2012 summer course:
- A. Quintero, M. Myllykoski, A. Igolkina, A. Freltoft, N. Dixit, F. Rost, Morphogenesis and Dynamics of Multicellular Systems, ECMI Newletter 52, 2012.</Details>
    </Description>
    <Global>
        <Field symbol="c" value="0" name="cAMP">
            <Diffusion rate="1"/>
            <BoundaryValue boundary="x" value="0"/>
            <BoundaryValue boundary="-x" value="0"/>
            <BoundaryValue boundary="y" value="0"/>
            <BoundaryValue boundary="-y" value="0"/>
        </Field>
        <Field symbol="r" value="0" name="refractoriness">
            <Diffusion rate="0"/>
            <BoundaryValue boundary="x" value="0"/>
            <BoundaryValue boundary="-x" value="0"/>
            <BoundaryValue boundary="y" value="0"/>
            <BoundaryValue boundary="-y" value="0"/>
        </Field>
        <System solver="euler" time-step="0.1">
            <Constant symbol="c1" value="0.0065"/>
            <Constant symbol="c2" value="0.841"/>
            <DiffEqn symbol-ref="c">
                <Expression>is_amoeba*(-f() -r)</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="r">
                <Expression>is_amoeba*epsilon()*(3.5*c-b-r)</Expression>
            </DiffEqn>
            <Function symbol="epsilon">
                <Expression>if(c &lt; c1, 0.5,
 if(c &lt; c2, 0.0589,
  0.5))</Expression>
            </Function>
            <Function symbol="f">
                <Expression>if(c &lt; c1, 20*c, 
 if(c &lt; c2, -3*c+0.15,
  15*(c-1)))</Expression>
                <!--    <Disabled>
        <Expression>-3*c</Expression>
    </Disabled>
-->
            </Function>
        </System>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="l" value="150 150 0"/>
            <BoundaryConditions>
                <Condition boundary="x" type="constant"/>
                <Condition boundary="-x" type="constant"/>
                <Condition boundary="y" type="constant"/>
                <Condition boundary="-y" type="constant"/>
            </BoundaryConditions>
            <NodeLength value="0.37"/>
            <Neighborhood>
                <Distance>1.5</Distance>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime symbol="end" value="750"/>
        <TimeSymbol symbol="time"/>
        <RandomSeed value="1357906713"/>
    </Time>
    <CellTypes>
        <CellType class="medium" name="medium">
            <Property symbol="b" value="0"/>
            <Property symbol="max_c" value="0"/>
            <Property symbol="phase" value="0"/>
            <Property symbol="is_amoeba" value="0"/>
        </CellType>
        <CellType class="biological" name="amoeba">
            <VolumeConstraint target="40" strength="1"/>
            <Chemotaxis field="c" strength="mu"/>
            <Property symbol="is_amoeba" value="1.0"/>
            <Property symbol="b" value="0"/>
            <Property symbol="max_c" value="0"/>
            <Property symbol="phase" value="1"/>
            <Property symbol="phaseTime" value="0"/>
            <Property symbol="phase2duration" value="0.1"/>
            <Function symbol="mu">
                <Expression>if(phase == 2, 10, 0)</Expression>
            </Function>
            <System solver="heun" time-step="1.0">
                <Rule symbol-ref="phaseTime">
                    <Expression>if(phase == 2, phaseTime+MCStime, 0)</Expression>
                </Rule>
                <Rule symbol-ref="phase" name="Rule_2_3">
                    <Expression>if(phase == 1 and max_c > 0.1, 2,
if(phase == 2 and phaseTime>phase2duration, 3,
if(phase == 3 and max_c &lt; 0.05, 1, 
phase
))) </Expression>
                </Rule>
            </System>
            <Mapper>
                <Input value="c"/>
                <Output symbol-ref="max_c" mapping="maximum"/>
            </Mapper>
        </CellType>
        <CellType class="biological" name="autoAmoeba">
            <VolumeConstraint target="40" strength="1"/>
            <Property symbol="b" value="0.5"/>
            <Property symbol="max_c" value="0"/>
            <Property symbol="phase" value="0"/>
            <Property symbol="is_amoeba" value="1.0"/>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="amoeba" type2="amoeba" value="4"/>
            <Contact type1="amoeba" type2="medium" value="2"/>
            <Contact type1="amoeba" type2="autoAmoeba" value="4"/>
            <Contact type1="autoAmoeba" type2="medium" value="3"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration symbol="MCStime" value="0.5"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="1.0" yield="0.1"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>1.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population size="1" type="autoAmoeba">
            <InitRectangle mode="regular" number-of-cells="1">
                <Dimensions size="10, 10, 0" origin="l.x/2, l.y/2, 0"/>
            </InitRectangle>
        </Population>
        <Population size="1" type="amoeba">
            <InitRectangle mode="regular" number-of-cells="250">
                <Dimensions size="l.x-6,l.y-6,1" origin="3,3,0"/>
            </InitRectangle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="5" decorate="false">
            <Terminal opacity="0.65" size="400 400 0" name="png"/>
            <Plot>
                <Field symbol-ref="c" min="0" max="1.0">
                    <ColorMap>
                        <Color value="0" color="white"/>
                        <Color value="0.5" color="yellow"/>
                        <Color value="1.0" color="red"/>
                    </ColorMap>
                </Field>
                <Cells value="phase" min="0" max="3">
                    <ColorMap>
                        <Color value="0" color="black"/>
                        <Color value="1" color="yellow"/>
                        <Color value="2" color="green"/>
                        <Color value="3" color="red"/>
                    </ColorMap>
                </Cells>
            </Plot>
        </Gnuplotter>
        <DependencyGraph format="svg" exclude-plugins="Gnuplotter"/>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Multiscale Models/Dictyostelium/index.md
````markdown
---
MorpheusModelID: M0034

authors: [N. J. Savill, P. Hogeweg]
contributors: [F. Rost, A. Quintero, M. Myllykoski, A. Igolkina, A. Rohde O’Sullivan Freltoft, N. Dixit]

title: "Dictyostelium"
date: "2019-11-11T15:52:00+01:00"
lastmod: "2021-08-18T17:14:00+02:00"

aliases: [/examples/dictyostelium/]

menu:
  Built-in Examples:
    parent: Multiscale Models
    weight: 40
weight: 200
---
## Introduction

This model show chemotactic aggregation of Dictyostelium. It was constructed by students attending the [ECMI modeling week 2012](/event/2012/08/13/ecmi-modeling-week/) in Dresden.

![](dicty.png "Aggregation of amoebas through chemotaxis towards waves of cAMP.")

## Description

This model shows an interesting coupling between CPM cells and reaction-diffusion PDE. Cell state depends on the perceived concentration of cAMP and determines whether a cell produces cAMP and whether it performs chemotaxis. The PDE is governed by a Fitzhugh-Nagumo-like model of an excitable medium, which causes traveling waves upon excitation. Chemotaxis through those waves causes cell aggregation. 

Background colors indicate the cAMP concentration. Cells are color-coded according to their phase:

- excitable/resting (yellow),
- excited/chemotactic (green),
- refractory/resting (red).

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/57214708?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

## Reference

>- N. J. Savill, P. Hogeweg: [Modelling Morphogenesis: From Single Cells to Crawling Slugs][savill-1997]. *J. Theor. Biol.*, **184** (3): 229–235, 1997.
>- F. Rost, A. Quintero, M. Myllykoski, A. Igolkina, A. Rohde O’Sullivan Freltoft, N. Dixit: Morphogenesis and Dynamics of Multicellular Systems. *ECMI Newsletter* **52**, 2012.

[rost-2012]: http://www.mafy.lut.fi/EcmiNL/issues.php?action=viewart&ID=280
[savill-1997]: http://dx.doi.org/10.1006/jtbi.1996.0237
````

## File: Built-in Examples/Multiscale Models/Vascular Patterning/index.md
````markdown
---
MorpheusModelID: M0032

authors: [A. Köhn-Luque, W. de Back, J. Starruß, A. Mattiotti, A. Deutsch, J. M. Pérez-Pomares]

title: "Coupling CPM and PDE: Vascular Patterning"
date: "2019-11-07T10:58:00+01:00"
lastmod: "2020-10-30T13:32:00+01:00"

aliases: [/examples/coupling-cpm-and-pde-vascular-patterning/]

menu:
  Built-in Examples:
    parent: Multiscale Models
    weight: 20
weight: 180
---

## Introduction

This example shows a model of vascular network formation by paracrine signaling ([Köhn-Luque *et al.*, 2011][köhn-luque-2011]) and employs a coupled CPM and reaction-diffusion model.

![](vascular-patterning.png "Cells organize into networks due to matrix-anchorage of chemoattractant.")

## Description

The model defines a ```CPM``` as well as a ```PDE```. These models are coupled by two processes:

1. Cells, specified in ```CellTypes```, respond chemotactically to a ```Layer``` (or species) in the ```PDE```.
1. Conversely, the production term of one ```PDE Layer``` is coupled to the presence/absence of cell.

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/47171670?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

## Reference

A. Köhn-Luque, W. de Back, J. Starruß, A. Mattiotti, A. Deutsch, J. M. Pérez-Pomares: [Early Embryonic Vascular Patterning by Matrix-Mediated Paracrine Signalling: A Mathematical Model Study][köhn-luque-2011]. *PLoS ONE* **6** (9): e24175, 2011.

[köhn-luque-2011]: http://dx.doi.org/10.1371/journal.pone.0024175
````

## File: Built-in Examples/Multiscale Models/Vascular Patterning/VascularPatterning.xml
````xml
<MorpheusModel version="3">
    <Description>
        <Title>Example-VascularPatterning</Title>
        <Details>Reference:
- A Köhn-Luque, W de Back, Y Yamaguchi, K Yoshimura, M A Herrero, T Miura (2013) Dynamics of VEGF matrix-retention in vascular network patterning, Physical Biology, 10(6) : 066007
http://dx.doi.org/10.1088/1478-3975/10/6/066007

Related to:
- Köhn-Luque A, de Back W, Starruß J, Mattiotti A, Deutsch A, Perez-Pomares JM, Herrero MA (2011) Early Embryonic Vascular Patterning by Matrix-Mediated Paracrine Signalling: A Mathematical Model Study. PLoS ONE 6(9): e24175. 
http://dx.doi.org/10.1371/journal.pone.0024175

</Details>
    </Description>
    <Global>
        <Field symbol="u" value="1.5e-6" name="VEGF">
            <Diffusion rate="58.7"/>
        </Field>
        <Field symbol="s" value="0" name="Free ECM">
            <Diffusion rate="0.001"/>
        </Field>
        <Field symbol="b" value="0" name="VEGF_b">
            <Diffusion rate="0"/>
        </Field>
        <Field symbol="VEGF_all" value="0" name="VEGF_s + VEGF_b">
            <Diffusion rate="0"/>
        </Field>
        <System solver="heun" time-step="5.0">
            <Constant symbol="gamma" value="5e-3" name="Production ECM"/>
            <Constant symbol="k_on" value="8.5e-4" name="Binding rate VEGF/ECM"/>
            <Constant symbol="k_off" value="3.6e-3" name="Unbinding rate VEGF/ECM"/>
            <Constant symbol="delta" value="2.6e-6" name="Decay VEGF "/>
            <DiffEqn symbol-ref="u">
                <Expression>- k_on*u*s + k_off*b - delta*u</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="s">
                <Expression>gamma*cell - k_on*u*s+k_off*b</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="b">
                <Expression>k_on*u*s - k_off*b</Expression>
            </DiffEqn>
            <Rule symbol-ref="VEGF_all">
                <Expression>u+b</Expression>
            </Rule>
        </System>
        <Constant symbol="cell" value="0.0"/>
        <Constant symbol="cell_density" value="0.0045"/>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="200 200 0"/>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
            </BoundaryConditions>
            <NodeLength value="2"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="l"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="3600"/>
        <SaveInterval value="0"/>
        <RandomSeed value="1"/>
        <TimeSymbol symbol="t"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="HUVEC">
            <Property symbol="cell" value="1.0" name="cell"/>
            <Property symbol="str" value="3e7" name="chemotactic strength"/>
            <VolumeConstraint target="90" strength="1"/>
            <Chemotaxis field="b" contact-inhibition="false" strength="str" retraction="false"/>
            <!--    <Disabled>
        <AddCell mode="exclude">
            <Condition>rand_uni(0,1) &lt; 0.24 + 0.0*t</Condition>
            <Triggers/>
            <Distribution>l.x / size.x</Distribution>
        </AddCell>
    </Disabled>
-->
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction default="0">
            <Contact type1="medium" type2="HUVEC" value="3.2"/>
            <Contact type1="HUVEC" type2="HUVEC" value="6.4"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1.0"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="1"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population size="0" type="HUVEC">
            <InitRectangle mode="regular" number-of-cells="cell_density * size.x * size.y">
                <Dimensions size="200,200,0" origin="0,0,0"/>
            </InitRectangle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="250" decorate="false">
            <Terminal opacity="0.65" name="png"/>
            <Plot>
                <Field symbol-ref="b"/>
                <Cells value="cell">
                    <ColorMap>
                        <Color value="1" color="gray"/>
                        <Color value="0.0" color="gray"/>
                    </ColorMap>
                </Cells>
            </Plot>
        </Gnuplotter>
        <!--    <Disabled>
        <HistogramLogger normalized="false" number-of-bins="10" time-step="100">
            <Plot minimum="0" maximum="1.0" terminal="png"/>
            <Column symbol-ref="cell.id" celltype="Angioblasts"/>
        </HistogramLogger>
    </Disabled>
-->
        <DependencyGraph format="svg" exclude-plugins="Gnuplotter, CPM" exclude-symbols="cell, cell.center, str_2"/>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/Multiscale Models/index.md
````markdown
---
# Order
weight: 40
---
````

## File: Built-in Examples/ODE/Cell Cycle/CellCycle.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="3">
    <Description>
        <Title>Example-CellCycle</Title>
        <Details>James Ferrell, Tony Yu-Chen Tsai and Qiong Yang (2011) Modeling the Cell Cycle: Why Do Certain Circuits Oscillate?, Cell 144, p874-885. http://dx.doi.org/10.1016/j.cell.2011.03.006</Details>
    </Description>
    <Global/>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="1,1,0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="25"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="cells">
            <Property symbol="APC" value="0"/>
            <Property symbol="Plk1" value="0"/>
            <Property symbol="CDK1" value="0"/>
            <System solver="runge-kutta" time-scaling="1" time-step="1e-2">
                <Constant symbol="n" value="8"/>
                <Constant symbol="K" value="0.5"/>
                <Constant symbol="α1" value="0.1"/>
                <Constant symbol="α2" value="3.0"/>
                <Constant symbol="α3" value="3.0"/>
                <Constant symbol="β1" value="3.0"/>
                <Constant symbol="β2" value="1.0"/>
                <Constant symbol="β3" value="1.0"/>
                <DiffEqn symbol-ref="CDK1">
                    <Expression>α1 - β1 * CDK1 * (APC^n) / (K^n + APC^n)</Expression>
                </DiffEqn>
                <DiffEqn symbol-ref="Plk1">
                    <Expression>α2*(1-Plk1) * ((CDK1^n) / (K^n + CDK1^n)) - β2*Plk1</Expression>
                </DiffEqn>
                <DiffEqn symbol-ref="APC">
                    <Expression>α3*(1- APC) * ((Plk1^n) / (K^n + Plk1^n)) - β3*APC</Expression>
                </DiffEqn>
            </System>
        </CellType>
    </CellTypes>
    <CellPopulations>
        <Population size="0" type="cells">
            <InitCellLattice/>
        </Population>
    </CellPopulations>
    <Analysis>
        <Logger time-step="1e-2">
            <Restriction>
                <Celltype celltype="cells"/>
            </Restriction>
            <Input>
                <Symbol symbol-ref="APC"/>
                <Symbol symbol-ref="CDK1"/>
                <Symbol symbol-ref="Plk1"/>
            </Input>
            <Output>
                <TextOutput file-format="csv"/>
            </Output>
            <Plots>
                <Plot time-step="-1">
                    <Style style="lines" line-width="4.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="APC"/>
                        <Symbol symbol-ref="CDK1"/>
                        <Symbol symbol-ref="Plk1"/>
                    </Y-axis>
                </Plot>
                <Plot time-step="-1">
                    <Style style="lines" line-width="4.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="CDK1"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="APC"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="Plk1"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/ODE/Cell Cycle/index.md
````markdown
---
MorpheusModelID: M0001

authors: [J. E. Ferrell Jr., T. Y. Tsai, Q. Yang]

title: "ODE Model: Cell Cycle"
date: "2019-10-29T15:26:00+01:00"
lastmod: "2020-09-16T14:29:00+02:00"

aliases: ["/examples/ode-model-cell-cycle/"]

menu:
  Built-in Examples:
    parent: ODE
    weight: 10
weight: 20
---
## Introduction

This model is a simple three-species ODE model of the *Xenopus* embryonic cell cycle ([Ferrell *et al.*, 2011][ferrell-2011]). It exhibits sustained limit cycle oscillations.

![](cellcycle_singlecell.png "Time plots of ODE model of *Xenopus* embryonic cell cycle.")

## Description

One ```CellType``` is created that has three variables of ```Properties``` representing the concentrations of $\mathrm{APC}$, $\mathrm{Plk1}$, and $\mathrm{CDK1}$. These variables are coupled in a ```System``` of ```DiffEqn```s. 

In the ```System```, a number of ```Constants``` are defined, whose symbols are used in the ```DiffEqn```. Note that the equations are entered in simple plain text.

The ```System``` uses the ```runga-kutta``` (4th order) solver for the differential equations and speficies a particular time step (here $ht = 10^{-2}$) which is interpreted in global time steps. 

The global time is defined in the ```Time``` element and runs from ```StartTime``` to ```StopTime``` ($0$ to $25$). In this non-spatial model, ```Space``` defines a ```Lattice``` of size $(x,y,z)=(1,1,0)$.

Results are written to a file using the ```Analysis``` plugin ```Logger```. The ```Logger``` also visualizes the time plot to screen (in *interactive* mode) or to PNG files (in *local* mode).

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/70781290?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

## Things to try

- Change the dynamics by altering ```System/time-scaling```.

## Reference

>J. E. Ferrell Jr., T. Y. Tsai, Q. Yang: [Modeling the Cell Cycle: Why Do Certain Circuits Oscillate?][ferrell-2011]. *Cell* **144** (6): 874-885, 2011.


[ferrell-2011]: http://dx.doi.org/10.1016/j.cell.2011.03.006
````

## File: Built-in Examples/ODE/Cell Cycle Delay/CellCycleDelay.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="3">
    <Description>
        <Title>Example-CellCycleDelay</Title>
        <Details>Example of delay differential equations.

Implements equation 23 and 24 and reproduces figure 7 from:

James Ferrell, Tony Yu-Chen Tsai and Qiong Yang (2011) Modeling the Cell Cycle: Why Do Certain Circuits Oscillate?, Cell 144, p874-885. http://dx.doi.org/10.1016/j.cell.2011.03.006</Details>
    </Description>
    <Global/>
    <Space>
        <Lattice class="linear">
            <Size symbol="size" value="1 0 0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="25"/>
        <SaveInterval value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="cells">
            <Property symbol="APC" value="0"/>
            <Property symbol="CDK1" value="0"/>
            <DelayProperty symbol="APC_d" value="0" delay="0.5"/>
            <DelayProperty symbol="CDK1_d" value="0" delay="0.5"/>
            <Equation symbol-ref="APC_d">
                <Expression>APC</Expression>
            </Equation>
            <Equation symbol-ref="CDK1_d">
                <Expression>CDK1</Expression>
            </Equation>
            <System solver="runge-kutta" time-scaling="1" time-step="1e-2">
                <Constant symbol="n" value="8"/>
                <Constant symbol="K" value="0.5"/>
                <Constant symbol="α1" value="0.1"/>
                <Constant symbol="α2" value="3.0"/>
                <Constant symbol="β1" value="3.0"/>
                <Constant symbol="β2" value="1.0"/>
                <DiffEqn symbol-ref="CDK1">
                    <Expression>α1 - β1 * CDK1 * (APC_d^n) / (K^n + APC_d^n)</Expression>
                </DiffEqn>
                <DiffEqn symbol-ref="APC">
                    <Expression>α2*(1- APC) * ((CDK1_d^n) / (K^n + CDK1_d^n)) - β2*APC</Expression>
                </DiffEqn>
            </System>
        </CellType>
    </CellTypes>
    <CellPopulations>
        <Population size="1" type="cells"/>
    </CellPopulations>
    <Analysis>
        <Logger time-step="1e-2">
            <Restriction>
                <Celltype celltype="cells"/>
            </Restriction>
            <Input>
                <Symbol symbol-ref="APC"/>
                <Symbol symbol-ref="APC_d"/>
                <Symbol symbol-ref="CDK1"/>
                <Symbol symbol-ref="CDK1_d"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="-1">
                    <Style style="lines" line-width="3.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="CDK1"/>
                        <Symbol symbol-ref="CDK1_d"/>
                        <Symbol symbol-ref="APC"/>
                        <Symbol symbol-ref="APC_d"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/ODE/Cell Cycle Delay/index.md
````markdown
---
MorpheusModelID: M0003

authors: [J. E. Ferrell Jr., T. Y. Tsai, Q. Yang]

title: "Delay Differential Equations: Cell Cycle"
date: "2019-10-29T16:57:00+01:00"
lastmod: "2020-10-30T12:20:00+01:00"

aliases: [/examples/delay-differential-equations-cell-cycle/]

menu:
  Built-in Examples:
    parent: ODE
    weight: 30
weight: 40
---

## Introduction

This model is a two-species version of the *Xenopus* embryonic cell cycle [shown above](/examples/ordinary-differential-equations/ode-model-cell-cycle/) that uses delay differential equations ([Ferrell *et al.*, 2011][ferrell-2011]). It exhibits sustained limit cycle oscillations.

![](cellcycledelay.png "Time plots of ODE model of *Xenopus* embryonic cell cycle, modeled with delay differential equations.")

## Description

This model uses two ```Properties``` ($\mathrm{CDK1}$ and $\mathrm{APC}$) and two ```DelayProperties``` ($\text{CDK1}_d$ and $\text{APC}_d$) with delay $\tau$. The latter are properties that return the value that has been assigned at time $t-\tau$.

The updated values of $\mathrm{CDK1}$ and $\mathrm{APC}$ are assigned to (the back of) $\text{CDK1}_d$ and $\text{APC}_d$ using ```Equations```. When these properties used in the ```DiffEqn```, they return the value assigned in the past.

The two variables are logged and both a time plot and a phase plot are drawn.

## Things to try

- Explore the effect of delays by altering the ```DelayProperty/delay```.

## Reference

>J. E. Ferrell Jr., T. Y. Tsai, Q. Yang: [Modeling the Cell Cycle: Why Do Certain Circuits Oscillate?][ferrell-2011]. *Cell* **144** (6): 874-885, 2011.

[ferrell-2011]: http://dx.doi.org/10.1016/j.cell.2011.03.006
````

## File: Built-in Examples/ODE/Lateral Signaling/index.md
````markdown
---
MorpheusModelID: M0004

authors: [W. de Back, J. X. Zhou, L. Brusch]

title: "Coupled ODE Lattice: Lateral Signaling"
date: "2019-10-29T17:49:00+01:00"
lastmod: "2021-08-17T15:50:00+02:00"

aliases: [/examples/coupled-ode-lattice-lateral-signaling/]

# Reference details
publication:
  doi: "10.1098/rsif.2012.0766"
  title: "On the Role of Lateral Stabilization during Early Patterning in the Pancreas"
  journal: "J. R. Soc. Interface"
  volume: 10
  issue: 79
  page: "20120766"
  year: 2013

tags:
- Analysis
- BoundaryConditions
- ColorMap
- DiffEqn
- Gene Regulatory Network
- Gnuplotter
- Hexagonal Lattice
- HistogramLogger
- Interactive Mode
- Juxtacrine Signaling
- Lateral Inhibition
- Lateral Signaling
- Lateral Stabilization
- Lattice
- Local Mode
- Logger
- NeighborhoodReporter
- Neurogenin-3
- NEUROG3
- Pattern Formation
- Pancreas
- Pancreas Transcription Factor 1 Subunit Alpha
- Periodic
- Population
- Property
- PTF1A
- Size
- Space
- Square Lattice
- System

weight: 50
---

## Introduction

This example model cell fate decisions during early patterning of the pancreas ([de Back *et al.*, 2012][de-back-2013]). The simple gene regulatory network of each cell is coupled to adjacent cells by lateral (juxtacrine) signaling.

![](lateral_signaling.png "Patterning as a result of lateral inhibition and lateral stabilization.")

## Description

The model defines a lattice of cells with a simplified hexagonal epithelial packing. This is specified in `Space` using a `hexagonal` lattice structure of `Size` $(x,y,z)=(20,20,0)$ with `periodic` `BoundaryConditions`. The lattice is filled by seeding it with a `Population` of 400 cells.

Each cell has two basic `Properties` $X$ and $Y$ representing the expression levels of $\mathrm{Ngn3}$ and $\mathrm{Ptf1a}$ that are coupled in a `System` of `DiffEqn`s. 

The `NeighborhoodReporter` plugin is used to couple the cells to their directly adjacent neighbors. This plugin checks the values of $X$ in neighboring cells and outputs its mean value in `Property` $X_n$. 

This model uses a number of `Analysis` plugins:

- The `Gnuplotter` visualizes the values of $Y$ with a `ColorMap` that maps values to colors. It outputs to screen (*interactive* mode) or to PNG (*local* mode).
- The `Logger` records the values of $X$ and $Y$ expression to file and, at the end of simulation, shows a time plot.
- The first `HistogramLogger` records and plots the distribution of $X$ and $Y$ expression cells over time.
- The second `HistogramLogger` records and, after simulation, plots the distribution of $\tau$, the time to cell fate decision (see [reference][de-back-2013]).

<div style="padding:100% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/47171576?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

## Things to try

- Change the lattice structure from `hexagonal` to `square`. See `Space`/`Lattice`.
- Change the strength of lateral stabilization `b` and observe the pattern. See `CellTypes`/`CellType`/`System`.
- Change the `noise` amplitude (under `CellTypes`/`CellType`/`System`) and observe time $\tau$ to cell fate decision.

[de-back-2013]: http://dx.doi.org/10.1098/rsif.2012.0766
````

## File: Built-in Examples/ODE/Lateral Signaling/LateralSignaling.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="3">
    <Description>
        <Title>Example-LateralSignaling</Title>
        <Details>Reference:

Walter de Back, Joseph X. Zhou, Lutz Brusch, On the Role of Lateral Stabilization during Early Patterning in the Pancreas, Roy. Soc. Interface 10(79): 20120766, 2012.

http://dx.doi.org/10.1098/rsif.2012.0766
</Details>
    </Description>
    <Global>
        <Constant symbol="X" value="0"/>
        <Constant symbol="Y" value="0"/>
    </Global>
    <Space>
        <Lattice class="hexagonal">
            <Size symbol="size" value="20 20 0"/>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="30"/>
        <TimeSymbol symbol="t"/>
        <!--    <Disabled>
        <RandomSeed value="2"/>
    </Disabled>
-->
    </Time>
    <CellTypes>
        <CellType class="biological" name="cells">
            <Property symbol="X" value="0.0" name="Ngn3"/>
            <Property symbol="Xn" value="0.0" name="Ngn3-Neighbors"/>
            <Property symbol="Y" value="0" name="Ptf1a"/>
            <Property symbol="Yn" value="0" name="Ptf1a-neighbors"/>
            <System solver="heun" time-step="0.02">
                <Constant symbol="a" value="1"/>
                <Constant symbol="b" value="21"/>
                <Constant symbol="c" value="1"/>
                <DiffEqn symbol-ref="X">
                    <Expression>((th / (th + a*Xn^n)) - X) + rand_norm(0.0,noise)</Expression>
                </DiffEqn>
                <DiffEqn symbol-ref="Y">
                    <Expression>(((th + b*(Y * Yn)^n) / (th + c*X^n + b*(Y * Yn)^n))  - Y ) + rand_norm(0.0,noise)</Expression>
                </DiffEqn>
                <Constant symbol="n" value="4"/>
                <Constant symbol="th" value="1e-4"/>
                <Constant symbol="noise" value="1e-4"/>
            </System>
            <NeighborhoodReporter>
                <Input scaling="cell" value="X"/>
                <Output symbol-ref="Xn" mapping="average"/>
            </NeighborhoodReporter>
            <NeighborhoodReporter>
                <Input scaling="cell" value="Y"/>
                <Output symbol-ref="Yn" mapping="average"/>
            </NeighborhoodReporter>
            <Event trigger="on change">
                <Condition>tau == -1 and (X-Xn) > 0.05</Condition>
                <Rule symbol-ref="tau">
                    <Expression>t</Expression>
                </Rule>
            </Event>
            <Property symbol="tau" value="-1" name="time to cell fate decision"/>
        </CellType>
    </CellTypes>
    <CellPopulations>
        <Population size="0" type="cells">
            <InitCellLattice/>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="5">
            <Terminal size="800 400 0" persist="true" name="png"/>
            <Plot>
                <Cells value="X" min="0.0" max="1">
                    <ColorMap>
                        <Color value="1.0" color="blue"/>
                        <Color value="0.5" color="light-blue"/>
                        <Color value="0.0" color="white"/>
                    </ColorMap>
                </Cells>
            </Plot>
            <Plot>
                <Cells value="Y" min="0.0" max="1">
                    <ColorMap>
                        <Color value="1.0" color="red"/>
                        <Color value="0.5" color="light-red"/>
                        <Color value="0.0" color="white"/>
                    </ColorMap>
                </Cells>
            </Plot>
        </Gnuplotter>
        <Logger time-step="0.1">
            <Input>
                <Symbol symbol-ref="X"/>
                <Symbol symbol-ref="Y"/>
            </Input>
            <Output>
                <TextOutput file-separation="cell"/>
            </Output>
            <Plots>
                <Plot time-step="-1">
                    <Style style="lines" line-width="2"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="t"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="X"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="Y"/>
                    </Color-bar>
                    <Range>
                        <Data increment="3"/>
                    </Range>
                </Plot>
            </Plots>
        </Logger>
        <HistogramLogger minimum="-0.1" normalized="true" maximum="1.1" time-step="5" number-of-bins="20">
            <Plot minimum="0" maximum="1.0" terminal="png"/>
            <Column symbol-ref="X" celltype="cells"/>
            <Column symbol-ref="Y" celltype="cells"/>
        </HistogramLogger>
        <HistogramLogger minimum="0.0" normalized="true" maximum="30" time-step="-1" number-of-bins="30">
            <Plot minimum="0" maximum="1.0" terminal="png"/>
            <Column symbol-ref="tau" celltype="cells"/>
        </HistogramLogger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/ODE/MAPK Signaling/index.md
````markdown
---
MorpheusModelID: M0002

authors: [B. N. Kholodenko]

title: "SBML Import: MAPK Signaling"
aliases: [/examples/sbml-import-mapk-signaling/]
date: "2019-10-30T14:15:00+01:00"
lastmod: "2020-10-30T12:18:00+01:00"

menu:
  Built-in Examples:
    parent: ODE
    weight: 20
weight: 30
---

## Introduction

This model has been imported and automatically converted from SBML format by Morpheus. It shows oscillations in the MAPK signaling cascade ([Kholodenko, 2000][reference]).

![](mapk_sbml.png "Time plots of oscillations in MAPK signaling (Kholodenko, 2000).")

## Description

Upon importing an SBML file, a Morpheus model is automatically created. A ```System``` of ```DiffEqn```s is generated, based on the function and reactions defined in the SBML file and defined as part of a ```CellType```. Additionally, a ```Logger``` is generated to record and visualize the output.

Simulation details, such as ```StartTime``` and ```StopTime```, as well as the ```time-step``` of ```System```, need to be specified manually.

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/75952695?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

## Things to try

- Browse the [Biomodels database](http://www.ebi.ac.uk/biomodels-main/) and try importing some SBML models.

## Reference

>B. N. Kholodenko: [Negative feedback and ultrasensitivity can bring about oscillations in the mitogen-activated protein kinase cascades][reference]. *Eur. J. Biochem.* **267** (6): 1583-1588, 2000.

[reference]: http://dx.doi.org/10.1046/j.1432-1327.2000.01197.x
````

## File: Built-in Examples/ODE/MAPK Signaling/MAPK_SBML.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="3">
    <Description>
        <Title>BIOMD0000000010</Title>
        <Details>Imported SBML model: http://www.ebi.ac.uk/biomodels-main/BIOMD0000000010
        
Kholodenko BN, Negative feedback and ultrasensitivity can bring about oscillations in the mitogen-activated protein kinase cascades.</Details>
    </Description>
    <Global/>
    <Space>
        <Lattice class="linear">
            <Size symbol="size" value="1 0 0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime symbol="stop" value="1.0"/>
        <TimeSymbol symbol="time" name="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="sbml_ct">
            <System solver="runge-kutta-adaptive" time-scaling="4000" time-step="stop">
                <Constant symbol="V1" value="2.5"/>
                <Constant symbol="Ki" value="9"/>
                <Constant symbol="n" value="1"/>
                <Constant symbol="K1" value="10"/>
                <DiffEqn symbol-ref="MKKK" name="gained from reactions">
                    <Expression> - V1 * MKKK / ((1 + pow(MAPK_PP / Ki, n)) * (K1 + MKKK)) + V2 * MKKK_P / (KK2 + MKKK_P)</Expression>
                </DiffEqn>
                <DiffEqn symbol-ref="MKKK_P" name="gained from reactions">
                    <Expression>V1 * MKKK / ((1 + pow(MAPK_PP / Ki, n)) * (K1 + MKKK)) - V2 * MKKK_P / (KK2 + MKKK_P)</Expression>
                </DiffEqn>
                <Constant symbol="V2" value="0.25"/>
                <Constant symbol="KK2" value="8"/>
                <Constant symbol="k3" value="0.025"/>
                <Constant symbol="KK3" value="15"/>
                <DiffEqn symbol-ref="MKK" name="gained from reactions">
                    <Expression> - k3 * MKKK_P * MKK / (KK3 + MKK) + V6 * MKK_P / (KK6 + MKK_P)</Expression>
                </DiffEqn>
                <DiffEqn symbol-ref="MKK_P" name="gained from reactions">
                    <Expression>k3 * MKKK_P * MKK / (KK3 + MKK) - uVol * k4 * MKKK_P * MKK_P / (KK4 + MKK_P) + uVol * V5 * MKK_PP / (KK5 + MKK_PP) - V6 * MKK_P / (KK6 + MKK_P)</Expression>
                </DiffEqn>
                <Constant symbol="k4" value="0.025"/>
                <Constant symbol="KK4" value="15"/>
                <DiffEqn symbol-ref="MKK_PP" name="gained from reactions">
                    <Expression>k4 * MKKK_P * MKK_P / (KK4 + MKK_P) - V5 * MKK_PP / (KK5 + MKK_PP)</Expression>
                </DiffEqn>
                <Constant symbol="V5" value="0.75"/>
                <Constant symbol="KK5" value="15"/>
                <Constant symbol="V6" value="0.75"/>
                <Constant symbol="KK6" value="15"/>
                <Constant symbol="k7" value="0.025"/>
                <Constant symbol="KK7" value="15"/>
                <DiffEqn symbol-ref="MAPK" name="gained from reactions">
                    <Expression> - k7 * MKK_PP * MAPK / (KK7 + MAPK) + V10 * MAPK_P / (KK10 + MAPK_P)</Expression>
                </DiffEqn>
                <DiffEqn symbol-ref="MAPK_P" name="gained from reactions">
                    <Expression> k7 * MKK_PP * MAPK / (KK7 + MAPK) - k8 * MKK_PP * MAPK_P / (KK8 + MAPK_P) + uVol * V9 * MAPK_PP / (KK9 + MAPK_PP) - V10 * MAPK_P / (KK10 + MAPK_P)</Expression>
                </DiffEqn>
                <Constant symbol="k8" value="0.025"/>
                <Constant symbol="KK8" value="15"/>
                <DiffEqn symbol-ref="MAPK_PP" name="gained from reactions">
                    <Expression>k8 * MKK_PP * MAPK_P / (KK8 + MAPK_P) - V9 * MAPK_PP / (KK9 + MAPK_PP)</Expression>
                </DiffEqn>
                <Constant symbol="V9" value="0.5"/>
                <Constant symbol="KK9" value="15"/>
                <Constant symbol="V10" value="0.5"/>
                <Constant symbol="KK10" value="15"/>
            </System>
            <Constant symbol="uVol" value="1" name="compartment size"/>
            <Property symbol="MKKK" value="90" name="Mos"/>
            <Property symbol="MKKK_P" value="10" name="Mos-P"/>
            <Property symbol="MKK" value="280" name="Mek1"/>
            <Property symbol="MKK_P" value="10" name="Mek1-P"/>
            <Property symbol="MKK_PP" value="10" name="Mek1-PP"/>
            <Property symbol="MAPK" value="280" name="Erk2"/>
            <Property symbol="MAPK_P" value="10" name="Erk2-P"/>
            <Property symbol="MAPK_PP" value="10" name="Erk2-PP"/>
        </CellType>
    </CellTypes>
    <CellPopulations>
        <Population size="1" type="sbml_ct"/>
    </CellPopulations>
    <Analysis>
        <Logger time-step="stop/200">
            <Restriction>
                <Celltype celltype="sbml_ct"/>
            </Restriction>
            <Input>
                <Symbol symbol-ref="MAPK"/>
                <Symbol symbol-ref="MAPK_P"/>
                <Symbol symbol-ref="MAPK_PP"/>
                <Symbol symbol-ref="MKK"/>
                <Symbol symbol-ref="MKK_P"/>
                <Symbol symbol-ref="MKK_PP"/>
                <Symbol symbol-ref="MKKK"/>
                <Symbol symbol-ref="MKKK_P"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="-1">
                    <Style grid="true" style="lines" line-width="3.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="MAPK"/>
                        <Symbol symbol-ref="MAPK_P"/>
                        <Symbol symbol-ref="MAPK_PP"/>
                        <Symbol symbol-ref="MKK"/>
                        <Symbol symbol-ref="MKK_P"/>
                        <Symbol symbol-ref="MKK_PP"/>
                        <Symbol symbol-ref="MKKK"/>
                        <Symbol symbol-ref="MKKK_P"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/ODE/Predator-Prey/index.md
````markdown
---
MorpheusModelID: M0005

authors: [M. L. Rosenzweig]

title: "Predator-Prey Model by Rosenzweig"

date: "2021-02-22T17:04:00+01:00"
lastmod: "2021-02-23T16:54:00+01:00"

tags:
- Logger
- Lotka–Volterra Equations
- Predator–Prey

menu:
  Built-in Examples:
    parent: ODE
    weight: 50
weight: 60
---
## Introduction

This model implements an extension of the well-known [Lotka-Volterra system](https://en.wikipedia.org/wiki/Lotka%E2%80%93Volterra_equations).

It illustrates how to 

- create a simple ODE model and
- log and plot data as time course.

![](predator-prey.png "Output of predator-prey example model.")

## Description

The [Rosenzweig model](#reference) is the Lotka-Volterra model with logistic growth and type 2 functional response.

First, the `Space` and `Time` of a simulation is specified, here defined as a single lattice site and $5000\ \mathrm{atu}$ (arbitrary time units). In `Global` (see figure below), two `Variable`s for predator and prey densities are set up. The differential equations themselves are specified in a `System` which consists of a number of `Constant`s and two `DiffEqn` (differential equations) and are computed using the `runge-kutta` solver. 

![](predator-prey-global-section.png "Global section of the model.")

Output in terms of a text file as well as a plot is created by a `Logger`, the plugin in the `Analysis` section.

## Things to try

- Bring the system into a stable steady state (fixed point, no oscillations) by changing parameters in `Global`/`System`/`Constant`.

## Reference

>M. L. Rosenzweig: [Paradox of Enrichment: Destabilization of Exploitation Ecosystems in Ecological Time][reference]. *Science* **171** (3969): 385-387, 1971.

[reference]: https://doi.org/10.1126/science.171.3969.385
````

## File: Built-in Examples/ODE/Predator-Prey/PredatorPrey.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Example-PredatorPrey</Title>
        <Details>Example showing Predator-prey model by Rosenzweig.

The Rosenzweig model is the Lotka-Volterra model with logistic growth and type 2 functional response. 

Reference:
Rosenzweig, Michael. 1971. "The Paradox of Enrichment" Science Vol. 171: pp. 385–387


Illustrates how to 
- create a simple ODE model
- log and plot data as time course</Details>
    </Description>
    <Global>
        <Variable value="0.1" symbol="N"/>
        <Variable value="0.5" symbol="P"/>
        <System time-step="0.1" solver="Runge-Kutta [fixed, O(4)]">
            <Constant name="halftime" value="0.5" symbol="a"/>
            <Constant name="growth rate" value="0.1" symbol="r"/>
            <Constant name="consumption rate" value="0.1" symbol="c"/>
            <Constant name="conversion rate" value="0.05" symbol="b"/>
            <Constant name="mortality rate" value="0.01" symbol="m"/>
            <Constant name="Carrying capacity" value="0.8" symbol="K"/>
            <DiffEqn symbol-ref="N">
                <Expression>r*N*(1-N/K) - c*N / (a+N)*P
</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="P">
                <Expression>b*N / (a+N)*P - m*P</Expression>
            </DiffEqn>
            <!--    <Disabled>
        <Function symbol="c">
            <Expression>0.1 + time*0.00001</Expression>
        </Function>
    </Disabled>
-->
        </System>
        <Event trigger="when true" time-step="1">
            <Condition>N &lt; 0.001</Condition>
            <Rule symbol-ref="N">
                <Expression>0</Expression>
            </Rule>
        </Event>
    </Global>
    <Space>
        <Lattice class="linear">
            <Size value="1, 0, 0" symbol="size"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="5000" symbol="stoptime"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Analysis>
        <Logger time-step="5">
            <Input>
                <Symbol symbol-ref="N"/>
                <Symbol symbol-ref="P"/>
            </Input>
            <Output>
                <TextOutput file-format="csv"/>
            </Output>
            <Plots>
                <Plot time-step="-1">
                    <Style style="lines" line-width="2.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="N"/>
                        <Symbol symbol-ref="P"/>
                    </Y-axis>
                </Plot>
                <Plot time-step="-1">
                    <Style style="lines" line-width="2.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="N"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="P"/>
                    </Y-axis>
                    <Color-bar palette="rainbow">
                        <Symbol symbol-ref="time"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph include-tags="#untagged" format="svg" reduced="false"/>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/ODE/index.md
````markdown
---
# Order
weight: 10
---
````

## File: Built-in Examples/PDE/1D Activator-Inhibitor/ActivatorInhibitor_1D.xml
````xml
<MorpheusModel version="3">
    <Description>
        <Title>Example-ActivatorInhibitor1D</Title>
        <Details></Details>
    </Description>
    <Global>
        <Field symbol="a" value="rand_norm(0.5,0.1)" name="activator">
            <Diffusion rate="0.02"/>
        </Field>
        <Field symbol="i" value="0.1" name="inhibitor">
            <Diffusion rate="1"/>
        </Field>
        <System solver="runge-kutta" time-step="1">
            <DiffEqn symbol-ref="a">
                <Expression>(rho*a^2) / i - mu_a * a + rho_a</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="i">
                <Expression>(rho*a^2) - mu_i * i</Expression>
            </DiffEqn>
            <Constant symbol="rho_a" value="0.01"/>
            <Constant symbol="mu_i" value="0.03"/>
            <Constant symbol="mu_a" value="0.02"/>
            <Constant symbol="rho" value="0.001"/>
        </System>
    </Global>
    <Space>
        <Lattice class="linear">
            <Size symbol="size" value="100 0 0"/>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
            </BoundaryConditions>
            <NodeLength value="0.25"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="4000"/>
        <SaveInterval value="0"/>
        <!--    <Disabled>
        <RandomSeed value="1"/>
    </Disabled>
-->
        <TimeSymbol symbol="time"/>
    </Time>
    <Analysis>
        <Logger time-step="25">
            <Input>
                <Symbol symbol-ref="a"/>
                <Symbol symbol-ref="i"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="250" title="space plot">
                    <Style style="lines" line-width="3.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="space.x"/>
                    </X-axis>
                    <Y-axis minimum="0" maximum="3.5">
                        <Symbol symbol-ref="a"/>
                        <Symbol symbol-ref="i"/>
                    </Y-axis>
                    <Range>
                        <Time mode="current"/>
                    </Range>
                </Plot>
                <Plot time-step="-1" title="time-space plot">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="space.x"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="a"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/PDE/1D Activator-Inhibitor/index.md
````markdown
---
MorpheusModelID: M0011

authors: [A. Gierer, H. Meinhardt]

title: "1D Reaction-Diffusion: Activator-Inhibitor"
date: "2019-11-05T13:39:00+01:00"
lastmod: "2020-10-30T12:29:00+01:00"

aliases: [/examples/1d-reaction-diffusion-activator-inhibitor/]

menu:
  Built-in Examples:
    parent: PDE
    weight: 10
weight: 60
---

## Introduction

The first example models a 1D activator-inhibitor model ([Gierer and Meinhardt, 1972][gierer-1972]). 

![](1d-pde.png "Space-time plot of 1D reaction diffusion model.")

## Description

This 1D PDE model uses a ```Lattice``` with ```linear``` structure and periodic boundary conditions. 

The ```PDE``` defined two species called ```Layers```: $A$ (activator) and $I$ (inhibitor) with resp. low and high ```Diffusion``` rates. The reaction part of the equations are defined in the ```System```. Similar to ODE model, the ```System``` defines ```Constants``` and ```DiffEqn```s.

The results are recorded and visualized using the ```Logger``` and ```SpaceTimeLogger```. 

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/70815567?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

## Reference

A. Gierer, H. Meinhardt: [A Theory of Biological Pattern Formation.][gierer-1972] *Kybernetik* **12**: 30-39, 1972.

[gierer-1972]: http://www.eb.tuebingen.mpg.de/fileadmin/uploads/pdf/Emeriti/Hans_Meinhardt/kyb.pdf
````

## File: Built-in Examples/PDE/2D Activator-Inhibitor/ActivatorInhibitor_2D.xml
````xml
<MorpheusModel version="3">
    <Description>
        <Title>Example-ActivatorInhibitor-2D</Title>
        <Details></Details>
    </Description>
    <Global>
        <Field symbol="a" value="rand_norm(0.5,0.1)" name="activator">
            <Diffusion rate="0.02"/>
        </Field>
        <Field symbol="i" value="0.1" name="inhibitor">
            <Diffusion rate="1"/>
        </Field>
        <System solver="runge-kutta" time-step="5" name="Meinhardt">
            <Constant symbol="rho" value="0.001"/>
            <Constant symbol="rho_a" value="0.001"/>
            <Constant symbol="mu_i" value="0.03"/>
            <Constant symbol="mu_a" value="0.02"/>
            <Constant symbol="kappa" value="0.10"/>
            <DiffEqn symbol-ref="a">
                <Expression>(rho/i)*((a^2)/(1 + kappa*a^2)) - mu_a * a + rho_a</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="i">
                <Expression>rho*((a^2)/(1+kappa*a^2)) - mu_i *i</Expression>
            </DiffEqn>
        </System>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="150 150 0"/>
            <NodeLength value="1"/>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="12500"/>
        <SaveInterval value="0"/>
        <RandomSeed value="2"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Analysis>
        <Gnuplotter time-step="500" decorate="false">
            <Terminal size="400 400 0" name="png"/>
            <Plot>
                <Field symbol-ref="a" min="0"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="250">
            <Input>
                <Symbol symbol-ref="a"/>
            </Input>
            <Output>
                <TextOutput file-format="csv"/>
            </Output>
            <Plots>
                <Plot time-step="0">
                    <Style style="lines" line-width="5.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="space.x"/>
                    </X-axis>
                    <Y-axis minimum="0" maximum="3">
                        <Symbol symbol-ref="a"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="i"/>
                    </Color-bar>
                    <Range>
                        <Data/>
                        <Time mode="current"/>
                    </Range>
                </Plot>
            </Plots>
            <Restriction>
                <Slice value="size.y/2" axis="y"/>
            </Restriction>
        </Logger>
        <Logger time-step="100">
            <Input>
                <Symbol symbol-ref="a"/>
            </Input>
            <Output>
                <TextOutput file-format="matrix"/>
            </Output>
            <Plots>
                <SurfacePlot time-step="500">
                    <Color-bar>
                        <Symbol symbol-ref="a"/>
                    </Color-bar>
                    <Terminal terminal="png"/>
                </SurfacePlot>
            </Plots>
            <Restriction>
                <Slice value="size.y/2" axis="y"/>
            </Restriction>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/PDE/2D Activator-Inhibitor/index.md
````markdown
---
MorpheusModelID: M0012

authors: [A. Gierer, H. Meinhardt]

title: "2D Reaction-Diffusion: Activator-Inhibitor"
date: "2019-11-05T14:21:00+01:00"
lastmod: "2020-10-30T12:30:00+01:00"

aliases: [/examples/2d-reaction-diffusion-activator-inhibitor/]

menu:
  Built-in Examples:
    parent: PDE
    weight: 20
weight: 70
---

## Introduction

A 2D activator-inhibitor model ([Gierer and Meinhardt, 1972][gierer-1972]).

![](activator-inhibitor.png "Stripe pattern generated by 2D Gierer-Meinhardt model.")

## Description

This model uses a standard ```Lattice``` with ```square``` structure and periodic boundary conditions. 

The ```PDE``` defined two species or ```Layers``` $A$ (activator) and $I$ (inhibitor) with resp. low and high ```Diffusion``` rates. The reaction part of the equations are defined in the ```System```. 

The results are visualized using the ```Gnuplotter```. 

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/47171577?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

## Things to try

- Alter the level of saturation of the activator by changing ```kappa``` (for example, using a ```ParamSweep```). By changing this parameter, the model can generate stripes, nets and spots.

## Reference

A. Gierer, H. Meinhardt: [A Theory of Biological Pattern Formation.][gierer-1972] *Kybernetik* **12**: 30-39, 1972.

[gierer-1972]: http://www.eb.tuebingen.mpg.de/fileadmin/uploads/pdf/Emeriti/Hans_Meinhardt/kyb.pdf
````

## File: Built-in Examples/PDE/Excitable Media/ExcitableMedium_3D.xml
````xml
<MorpheusModel version="3">
    <Description>
        <Title>Example-ExcitableMedium-3D</Title>
        <Details>Simulates the Barkley model of an excitable medium, see: http://www.scholarpedia.org/article/Barkley_model
Derived from FitzHugh-Nagumo model and Hogdkin-Huxley model.

TIFF images can be viewed with external tools such as Fiji / ImageJ (http://fiji.sc/Fiji) or BioView3D (http://www.dimin.net/software/bioview3d/). The latter also reads the OME header for 3D,4D and 5D images.
 </Details>
    </Description>
    <Global>
        <Field symbol="u" value="if( l.x>=s.x/2-5 and l.x&lt;=s.x/2+5 and l.z>=s.z/2-5 and l.z&lt;=s.z/2+5 and l.y&lt;=s.y/4 , 1, 0 )">
            <Diffusion rate="0.5"/>
        </Field>
        <Field symbol="v" value="if(l.x&lt;=s.x/2 and l.z&lt;=(3*s.z)/4, 1, 0)">
            <Diffusion rate="0.5"/>
        </Field>
        <System solver="runge-kutta" time-step="0.05">
            <DiffEqn symbol-ref="u">
                <Expression>(1/e)*u*(1-u)*(u-((v+b)/a))</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="v">
                <Expression>u-v</Expression>
            </DiffEqn>
            <Constant symbol="e" value="0.02"/>
            <Constant symbol="a" value="0.8"/>
            <Constant symbol="b" value="0.01"/>
        </System>
    </Global>
    <Space>
        <Lattice class="cubic">
            <Size symbol="s" value="50 50 50"/>
            <BoundaryConditions>
                <Condition boundary="x" type="noflux"/>
                <Condition boundary="y" type="noflux"/>
                <Condition boundary="z" type="noflux"/>
                <Condition boundary="-x" type="noflux"/>
                <Condition boundary="-y" type="noflux"/>
                <Condition boundary="-z" type="noflux"/>
            </BoundaryConditions>
            <NodeLength value="1.0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="l" name="position in space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="25"/>
        <SaveInterval value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Analysis>
        <Gnuplotter time-step="5">
            <Terminal size="600 600 0" name="png"/>
            <Plot>
                <Field symbol-ref="u" slice="25"/>
            </Plot>
        </Gnuplotter>
        <TiffPlotter timelapse="true" format="32bit" OME-header="true" compression="false" time-step="0.5">
            <Channel symbol-ref="u"/>
            <Channel symbol-ref="v"/>
        </TiffPlotter>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/PDE/Excitable Media/index.md
````markdown
---
MorpheusModelID: M0015
title: "3D Reaction-Diffusion: Excitable Media"
date: "2019-11-06T14:35:00+01:00"
lastmod: "2020-10-30T12:34:00+01:00"

aliases: [/examples/3d-reaction-diffusion-excitable-media/]

menu:
  Built-in Examples:
    parent: PDE
    weight: 50
weight: 100
---

## Introduction

This example uses the [Barkley model of excitable media](http://www.scholarpedia.org/article/Barkley_model), similar to the [Fitzhugh-Nagumo model](https://en.wikipedia.org/wiki/FitzHugh%E2%80%93Nagumo_model) to show how to model and visualize reaction-diffusion models in 3D.

![](barkley_3d.png "Scroll wave appears in Barkley model of excitable media in 3D.")

## Description

This model defines a 3D ```cubic``` ```Lattice``` with ```noflux``` ```BoundaryConditions```. Two ```Layers``` are defined for the two species: $u$ is the signal, and $v$ the refractoriness. As in the examples above, the ```DiffEqn``` as specified in the ```System``` in ```PDE```. Nothing strange here.

To visualize the resulting scrolling waves in 3D, the ```TiffPlotter``` is used. This ```Analysis``` plugin writes TIFF image stacks that can be opened by image analysis software such as [Fiji ImageJ](http://fiji.sc/). To import Morpheus TIFF images into Fiji, macro scripts are available that help you to create 3D ($xyz$), 4D ($xyzt$) or even 5D ($xyzct$) images and movies of your simulations.

Although unable to plot 3D, the ```GnuPlotter``` can still be helpful to plot a 2D slice. See ```Analysis/Gnuplotter/PDE/slice```. 

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/47172325?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

## Things to try

- Import resulting sequence of TIFF images in ImageJ or Fiji, and create 4D movie using ImageJ's 3D plugin:
    - Open ```u_v.tif``` in ImageJ: ```File``` → ```Open```.
    - Create hyperstack: ```Image``` → ```Hyperstack``` → ```Convert to Hyperstack```. ```Channels``` ($c$): ```2```, ```Slices``` ($z$): ```50```, ```Frames``` ($t$): ```51```, ```Display Mode```: ```Composite```.
    - Display in 4D: ```Plugins``` → ```3D Viewer```. ```Use default parameters```. Press ```OK```.

## Reference

D. Barkley: [A model for fast computer simulation of waves in excitable media.][barkley-1991] Physica 49D, 61–70, 1991.

[barkley-1991]: https://homepages.warwick.ac.uk/staff/D.Barkley/Research/Papers/phys3d.pdf
````

## File: Built-in Examples/PDE/Irregular Domains/ActivatorInhibitor_Domain.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Example-ActivatorInhibitor-2D-Domain</Title>
        <Details>Meinhardt-Gierer (activator-inhibitor) model solved in a nonregular domain with constant boundaries.</Details>
    </Description>
    <Global>
        <Field symbol="a" name="activator" value="rand_norm(0.5,0.1)">
            <Diffusion rate="0.02"/>
            <BoundaryValue boundary="domain" value="0.01"/>
        </Field>
        <Field symbol="i" name="inhibitor" value="0.1">
            <Diffusion rate="0.25"/>
            <BoundaryValue boundary="domain" value="0"/>
        </Field>
        <System time-step="5" name="Meinhardt" solver="Runge-Kutta [fixed, O(4)]">
            <Constant symbol="rho" value="0.001"/>
            <Constant symbol="rho_a" value="0.001"/>
            <Constant symbol="mu_i" value="0.02"/>
            <Constant symbol="mu_a" value="0.04"/>
            <Constant symbol="kappa" value="0.10"/>
            <DiffEqn symbol-ref="a">
                <Expression>(rho/i)*((a^2)/(1 + kappa*a^2)) - mu_a * a + rho_a</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="i">
                <Expression>rho*((a^2)/(1+kappa*a^2)) - mu_i *i</Expression>
            </DiffEqn>
        </System>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="100 100 0"/>
            <NodeLength value="1"/>
            <Domain boundary-type="constant">
                <Image path="M0013_model_domain.tiff"/>
            </Domain>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="10000"/>
        <SaveInterval value="0"/>
        <RandomSeed value="2"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Analysis>
        <Gnuplotter time-step="200" decorate="false">
            <Terminal size="400 400 0" name="png"/>
            <Plot>
                <Field symbol-ref="a" min="0"/>
            </Plot>
        </Gnuplotter>
        <ModelGraph format="dot" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/PDE/Irregular Domains/index.md
````markdown
---
MorpheusModelID: M0013

aliases: [/examples/domains-reaction-diffusion-in-irregular-domains/]
menu:
  Built-in Examples:
    parent: PDE
    weight: 30
weight: 80

title: "Domains: Reaction-Diffusion in Irregular Domains"

authors: [A. Gierer, H. Meinhardt]

# Reference details
publication:
  #doi: "http://www.eb.tuebingen.mpg.de/fileadmin/uploads/pdf/Emeriti/Hans_Meinhardt/kyb.pdf"
  title: "A Theory of Biological Pattern Formation"
  journal: "Kybernetik"
  volume: 12
  #issue:
  page: "30-39"
  year: 1972
  original_model: false

tags:
- 2D
- Activator-Inhibitor Model
- BoundaryCondition
- Domain:Image
- Irregular Domain
- Spot Pattern
---

## Introduction

A 2D activator-inhibitor model ([Gierer and Meinhardt, 1972](#reference)), solved in a irregular domain that is loaded from an [image file](#model).

![](M0013_figure_domains.png "Spot pattern in Gierer-Meinhardt model with irregular domain.")

## Description

This model uses an irregular `Domain` with `constant` `BoundaryCondition`s. The domain is loaded from a [TIFF image](#model). See `Space`:`Lattice`:`Domain`.

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/70395104?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
````

## File: Built-in Examples/PDE/Irregular Domains/model.md
````markdown
{{% callout note %}}
This model requires the external file [`M0013_model_domain.tiff`](/media/model/m0013/M0013_model_domain.tiff), which must be inside the same directory as {{< model_quick_access "media/model/m0013/ActivatorInhibitor_Domain.xml" >}}.
{{% /callout %}}

![](M0013_model_graph.svg "Model Graph")
````

## File: Built-in Examples/PDE/Turing Patterns/index.md
````markdown
---
MorpheusModelID: M0014

authors: [S. Miyazawa, M. Okamoto, S. Kondo]

title: "Spatial Parameter Sweep: Turing Patterns"
date: "2019-11-05T15:52:00+01:00"
lastmod: "2020-10-30T12:33:00+01:00"

aliases: [/examples/spatial-parameter-sweep-turing-patterns/]

menu:
  Built-in Examples:
    parent: PDE
    weight: 40
weight: 90
---

## Introduction

This model shows the pattern formation abilities of Turing's linear activator-inhibitor model ([Miyazawa *et al.*, 2010][miyazawa-2010]). It shows how to vary parameters as a function of space.

![](turing-miyazawa.png "Spots and stripes appear under various conditions in linear Turing model.")

## Description

Instead of fixed parameters defined as ```Constant```s, this model uses ```Function```s for two parameters. The parameters $C$ (activator production) and $A$ (rate of auto-activation) are defined as ```Function``` of space and varied over the $x$- and $y$-axes respectively. This requires the definition of a ```SpaceSymbol``` that can be used in expressions.

The results show the appearance of white spots (left), black spots (right) and labyrinthine patterns (middle).

<div style="padding:75% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/47171578?loop=1" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>

## Reference

S. Miyazawa, M. Okamoto, S. Kondo: [Blending of animal colour patterns by hybridization][miyazawa-2010]. *Nat. Commun.* **1** (6): 66, 2010.

[miyazawa-2010]: http://www.ncbi.nlm.nih.gov/pmc/articles/PMC2982180/
````

## File: Built-in Examples/PDE/Turing Patterns/TuringPatterns.xml
````xml
<MorpheusModel version="3">
    <Description>
        <Title>Example-TuringPatterns</Title>
        <Details>
Miyazawa, Okamoto and Kondo, Blending of animal colour patterns by hybridization, Nature Communications, 2010</Details>
    </Description>
    <Global>
        <Field symbol="u" value="4.1+rand_uni(0,1)">
            <Diffusion rate="1"/>
        </Field>
        <Field symbol="v" value="4.84+rand_uni(0,1)">
            <Diffusion rate="20"/>
        </Field>
        <System solver="runge-kutta" time-step="0.25" name="Miyazawa">
            <Function symbol="A">
                <Expression>0.07 + ((0.07 * l.y)/ s.y)</Expression>
            </Function>
            <Constant symbol="B" value="0.08"/>
            <Function symbol="C">
                <Expression>-0.1 + ((0.5 * l.x)/ s.x)</Expression>
            </Function>
            <Constant symbol="D" value="0.03"/>
            <Constant symbol="E" value="0.10"/>
            <Constant symbol="F" value="0.12"/>
            <Constant symbol="G" value="0.06"/>
            <Constant symbol="R" value="20.0"/>
            <Constant symbol="synU_max" value="0.23"/>
            <Constant symbol="synV_max" value="0.50"/>
            <Function symbol="s_u">
                <Expression>max( 0, min( synU_max, A()*u-B*v+C()))</Expression>
            </Function>
            <Function symbol="s_v">
                <Expression>max( 0, min( synV_max, E*u - F))</Expression>
            </Function>
            <DiffEqn symbol-ref="u">
                <Expression>R*(s_u() - D*u)</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="v">
                <Expression>R*(s_v() - G*v)</Expression>
            </DiffEqn>
        </System>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="s" value="512 512 0"/>
            <NodeLength value="1"/>
            <BoundaryConditions>
                <Condition boundary="x" type="noflux"/>
                <Condition boundary="y" type="noflux"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="l"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="30"/>
        <SaveInterval value="0"/>
        <RandomSeed value="1"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Analysis>
        <Gnuplotter time-step="2" decorate="false">
            <Terminal persist="true" name="png"/>
            <Plot>
                <Field symbol-ref="u">
                    <ColorMap>
                        <Color value="1" color="black"/>
                        <Color value="0.0" color="white"/>
                    </ColorMap>
                </Field>
            </Plot>
        </Gnuplotter>
        <Logger time-step="0.0">
            <Input>
                <Symbol symbol-ref="u"/>
            </Input>
            <Output>
                <TextOutput file-format="csv"/>
            </Output>
            <Restriction>
                <Slice value="s.x/2" axis="x"/>
            </Restriction>
            <Plots>
                <Plot title="slice at half of x extension" time-step="-1">
                    <Style style="lines" line-width="3.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="l.y"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="u"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="v"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <Logger time-step="2">
            <Input>
                <Symbol symbol-ref="u"/>
            </Input>
            <Output>
                <TextOutput file-format="csv"/>
            </Output>
            <Plots>
                <SurfacePlot time-step="2">
                    <Color-bar>
                        <Symbol symbol-ref="u"/>
                    </Color-bar>
                    <Terminal terminal="png"/>
                </SurfacePlot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Built-in Examples/PDE/index.md
````markdown
---
# Order
weight: 20
---
````

## File: Built-in Examples/index.md
````markdown
---
date: "2019-11-11T18:59:00+01:00"
lastmod: "2020-11-24T12:58:00+01:00"

summary: "Didactic example models that are built-in with the GUI menu and may serve as templates for own models."

aliases:
- /examples/
- /example/
- /models/built-in-examples/
- /models/Built-in-Examples/
- /model/Built-in-Examples/

toc: false

menu:
  Built-in Examples:
    weight: -10
weight: 10
---
{{< figure src="featured.png" alt="Schematic image of a laptop" caption="[CC-BY 4.0](https://creativecommons.org/licenses/by/4.0/) [Font Awesome](https://fontawesome.com/license)" width="30%" >}}

Under this category you will find **didactic example models** that are **built-in with the GUI menu** and may serve as templates for own models. Each example model is explained in more detail.

These built-in examples aim to

- demonstrate **key features** of Morpheus,
- show the **diversity of modeling approaches**,
- introduce the **Morpheus model description language**,
- provide **templates and inspiration** for your own models.
````

## File: Contributed Examples/CPM/Agent-based Model/ABMmodel.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>BiasedRandomWalkers</Title>
        <Details>Full title:		Agent-based Model
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		23.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2016
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Random walkers in 2D. A population of cells are started at the center of the domain. For each one, the following rules of motion are used: At fixed time increments, the walker changes its direction of motion. Its velocity vector is then recomputed as a vector with random x and y components. This simulation has some similarities to the RunAndTumble.xml example (Morpheus Model ID: M0025, https://identifiers.org/morpheus/M0025). A bias in the move direction can be introduced by setting BiasOnOff to 0 (off) or 1 (on). The mean squared displacement is computed and plotted. Thanks: Uses some aspects of the example RunAndTumble.xml and MSD calculation provided by Lutz Brusch.</Details>
    </Description>
    <Global>
        <Variable symbol="MSD" value="0.0"/>
    </Global>
    <Space>
        <Lattice class="hexagonal">
            <Size symbol="size" value="500, 500, 0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="10000"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="Walker">
            <VolumeConstraint target="200" strength="1"/>
            <ConnectivityConstraint/>
            <PropertyVector symbol="move_dir" value="0.0, 0.0, 0.0"/>
            <PropertyVector symbol="displacement" value="0.0, 0.0, 0.0"/>
            <PropertyVector symbol="velocity" value="0.0, 0.0, 0.0"/>
            <PropertyVector symbol="BiasDirection" name="spatial cue direction" value="0, 1.0, 0.0"/>
            <Property symbol="BiasOnOff" name="Turn cue on (1) or off (0)" value="0.0"/>
            <Property symbol="run_time" name="run duration" value="50.0"/>
            <Property symbol="last_turn_time" name="last random event" value="0"/>
            <DirectedMotion direction="20*move_dir+BiasDirection*BiasOnOff" strength="1"/>
            <Event trigger="when-true" time-step="5" name="Change direction">
                <Condition>time >= last_turn_time+ run_time</Condition>
                <Rule symbol-ref="last_turn_time" name="Time of last random event">
                    <Expression>time</Expression>
                </Rule>
                <VectorRule symbol-ref="move_dir" name="new direction of motion">
                    <Expression>rand_uni(-1,1), rand_uni(-1,1) , 1</Expression>
                </VectorRule>
            </Event>
            <MotilityReporter time-step="1.0" name="Compute displacement and velocity">
                <Displacement symbol-ref="displacement"/>
                <Velocity symbol-ref="velocity"/>
            </MotilityReporter>
            <Mapper name="Compute MSD">
                <Input value="(displacement.abs)^2"/>
                <Output symbol-ref="MSD" mapping="average"/>
            </Mapper>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="Walker" type2="medium" value="4"/>
            <Contact type1="Walker" type2="Walker" value="10"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="0.6"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="Walker" size="1" name="Random Walker">
            <!--    <Disabled>
        <Cell id="1">
            <Nodes>100,100,0</Nodes>
        </Cell>
    </Disabled>
-->
            <InitCircle number-of-cells="10" random_displacement="5.0" mode="random">
                <Dimensions radius="30.0" center="250.0, 250.0, 0.0"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="200" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells value="cell.id"/>
                <CellArrows orientation="20*velocity" center="midpoint" style="1"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="10">
            <Input>
                <Symbol symbol-ref="cell.center.x"/>
                <Symbol symbol-ref="cell.center.y"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="-1">
                    <Style point-size="0.5" style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="cell.center.x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="cell.center.y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="cell.id"/>
                    </Color-bar>
                </Plot>
                <!--    <Disabled>
        <Plot>
            <Style point-size="0.5" style="points"/>
            <Terminal terminal="png"/>
            <X-axis>
                <Symbol symbol-ref="time"/>
            </X-axis>
            <Y-axis>
                <Symbol symbol-ref="MSD"/>
            </Y-axis>
        </Plot>
    </Disabled>
-->
            </Plots>
        </Logger>
        <DisplacementTracker time-step="10" name="data" celltype="Walker"/>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Agent-based Model/index.md
````markdown
---
MorpheusModelID: M2016

title: Agent-based Model

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true
#  preprint: false

tags:
- ABM
- Agent-based Model
- Cell Tracking
- Cellular Potts Model
- CPM
- DirectedMotion
- DisplacementTracker
- Local Model
- Mean Squared Displacement
- MSD
- Neural Activity
- Non-local Model
- Random Motion
- Random Walk
- Random Walker
- Run and Tumble
- Single Cell
- Trajectory
- Unbiased Random Walk

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> An agent-based model where each cell's position and velocity is tracked

## Introduction

We expand our exploration of local and non-local models to the class of agent-based models.

## Description

Instead of tracking continuous distributions of cell density, neural activity, or other properties that vary continuously across space, we adopt a different kind of modeling approach by tracking the trajectories and behavior of individual cells.

For this, the mean squared displacement (MSD) of <a href="/model/M2003" title="<i class='fas fa-dna pr-1'></i>Morpheus Model ID: <code class='model-id-tooltip'>M2003</code>">random walkers in 2D</a> is calculated and plotted using a <span title="//CellTypes/CellType[@name='Walker']/Mapper/Output[@symbol-ref='MSD']">`Mapper`</span>.

## Results

![](ABMChapHeader.png "The cells spread out (left to right). Each cell's position and velocity is tracked along with their trajectories plotted in the right panel.")

<figure>
    ![](M2016_agent-based-model_movie.mp4)
    <figcaption >
        Video of the simulation of {{< model_quick_access "media/model/m2016/ABMmodel.xml" >}} showing individual cells running and tumbling throughout the entire two-dimensional domain.
    </figcaption>
</figure>
````

## File: Contributed Examples/CPM/Agent-based Model/model.md
````markdown
![](M2016_agent-based-model_model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/Cell Sorting (Simplified)/CellSortingLEK.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>CellSorting2D</Title>
        <Details>Full title:		Simplified Cell Sorting
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		04.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2007
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		A simplified version of the example model CellSorting_2D.xml provided in Morpheus (Morpheus Model ID: M0021, https://identifiers.org/morpheus/M0021), showing only the way that the cells sort. Reference: Graner and Glazier, Simulation of biological cell sorting using a two-dimensional extended Potts model, Phys. Rev. Lett. 69, 2013–2016 (1992).</Details>
    </Description>
    <Global/>
    <Space>
        <SpaceSymbol symbol="l"/>
        <Lattice class="square">
            <Size symbol="size" value="200, 200, 0"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </Lattice>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="5000"/>
        <RandomSeed value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="ct1">
            <VolumeConstraint target="200" strength="1"/>
        </CellType>
        <CellType class="biological" name="ct2">
            <VolumeConstraint target="200" strength="1"/>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction default="0.0">
            <Contact type1="ct1" type2="medium" value="12"/>
            <Contact type1="ct2" type2="medium" value="6"/>
            <Contact type1="ct1" type2="ct1" value="6"/>
            <Contact type1="ct2" type2="ct2" value="6"/>
            <Contact type1="ct1" type2="ct2" value="16"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="2"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>6</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="ct1" size="0">
            <InitCircle number-of-cells="50" mode="random">
                <Dimensions radius="size.x/3" center="size.x/2, size.y/2, 0"/>
            </InitCircle>
        </Population>
        <Population type="ct2" size="0">
            <InitCircle number-of-cells="50" mode="random">
                <Dimensions radius="size.x/3" center="size.x/2, size.y/2, 0"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="100" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells flooding="true" value="cell.type"/>
            </Plot>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Cell Sorting (Simplified)/index.md
````markdown
---
MorpheusModelID: M2007

title: "Simplified Cell Sorting"

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
publication:
  doi: "10.1103/PhysRevE.47.2128"
  title: "Simulation of the differential adhesion driven rearrangement of biological cells"
  authors: [J. A. Glazier, F. Graner]
  journal: "Phys. Rev. E"
  volume: 47
  issue: 3
  page: "2128"
  year: 1993
  #original_model: true

tags:
- Adhesion
- Adhesion Energy
- Cell-cell Contact
- Cell-medium Contact
- Contact
- Contact Energy
- Cell Sorting
- Cellular Potts Model
- Checkerboard
- CPM
- DAH
- Differential Adhesion
- Differential Adhesion Hypothesis
- Dispersal
- Engulfment
- Glazier-Graner-Hogeweg Model
- Glazier-Graner Model
- Interaction
- Medium
- MetropolisKinetics
- Reversal
- Separation
- Steinberg
- Target Area
- Target Volume
- Temperature
- Tissue Configuration
- VolumeConstraint

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> A simplified version of the Morpheus cell sorting example

## Introduction

A simplified version of the Morpheus built-in example of <a href="/model/m0021/" title="Morpheus Model ID: <code class='model-id-tooltip'>M0021</code>">cell sorting</a> showing the effect of cell-cell and cell-medium contact energies on the tissue configuration.

## Description

The different cell configurations were simulated with the parameters in the table attached, with b) being the preset behavior in {{< model_quick_access "media/model/m0007/CellSortingLEK.xml" >}}.

<figure>
<div class="d-flex justify-content-center">
<div>

| Type | <span title="//CPM/Interaction/Contact[@type1='ct1'][@type2='ct1']/@value">$`J_{11}`$</span> | <span title="//CPM/Interaction/Contact[@type1='ct2'][@type2='ct2']/@value">$`J_{22}`$</span> | <span title="//CPM/Interaction/Contact[@type1='ct1'][@type2='ct2']/@value">$`J_{12}`$</span> | <span title="//CPM/Interaction/Contact[@type1='ct1'][@type2='medium']/@value">$`J_{1 \mathrm m}`$</span> | <span title="//CPM/Interaction/Contact[@type1='ct2'][@type2='medium']/@value">$`J_{2 \mathrm m}`$</span> | <span title="//CPM/MonteCarloSampler/MetropolisKinetics/@temperature">$`T`$</span> | <span title="//CellTypes/CellType[name='ct1' or name='ct2']/VolumeConstraint/@strength">$`\lambda`$</span> |
|:---|---:|---:|---:|---:|---:|---:|---:|
| a) Checkerboard | $`10`$ | $`8`$ | $`6`$ | $`12`$ | $`12`$ | $`10`$ | $`1`$ |
| **b) Separation** | $`6`$ | $`6`$ | $`16`$ | $`12`$ | $`6`$ | $`2`$ | $`1`$ |
| c) Engulfment | $`14`$ | $`2`$ | $`11`$ | $`16`$ | $`16`$ | $`2`$ | $`1`$ |
| d) Reversal | $`14`$ | $`2`$ | $`11`$ | $`30`$ | $`16`$ | $`2`$ | $`1`$ |
| e) Dispersal 1 | $`14`$ | $`2`$ | $`9`$ | $`16`$ | $`16`$ | $`5`$ | $`1`$ |
| f) Dispersal 2 | $`14`$ | $`4`$ | $`11`$ | $`2`$ | $`16`$ | $`5`$ | $`1`$ |
</div>
</div>
<figcaption>Parameters as in <a href="#reference">Glazier <em>et al.</em>, 1993</a> used for the simulations</figcaption>
</figure>

## Results

![](CellSortingLEK.png "Regimes that can be found in a mixture of two cell types: a) checkerboard, b) separation (default in [`CellSortingLEK.xml`](#model)), c) engulfment, d) reversal, e) dispersal 1, f) dispersal 2.")

<figure>
  ![](M2007_cell-sorting-simplified_movie.mp4)
  <figcaption>
    Simulation video of <a href="#model"><code>CellSortingLEK.xml</code></a> with default behavior b)
  </figcaption>
</figure>
````

## File: Contributed Examples/CPM/Cell Sorting (Simplified)/model.md
````markdown
![](M2007_cell-sorting-simplified_model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/Chemotaxis/index.md
````markdown
---
MorpheusModelID: M2010

title: "Chemotaxis"

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true

tags:
- 2D
- Boundary
- BoundaryValue
- Cell Motion
- Cell Trajectory
- Cellular Potts Model
- Chemical Attractant
- Chemoattractant
- Chemotaxis
- CPM
- Decay
- DiffEqn
- Diffusion
- Domain
- Domain Boundary
- Drift
- Field
- Gradient
- Heat Map
- Keller-Segel Chemotaxis
- Keller-Segel Cells
- PDE
- Secretion
- Trajectory

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> Diffusion model with cells endowed with chemotactic ability

## Introduction

Previously developed diffusion models can be used to model chemotaxis by adding cells endowed with chemotactic ability. Here, chemotaxis of a group of cells towards a chemical diffusing into the domain with a high level at the right boundary is demonstrated, as well as in a second model, Keller-Segel cells being the sources of their own attractant.
## Description

Cells are endowed with the property of <span title="//CellTypes/CellType/Chemotaxis[@field='c'][@strength='chi']">`Chemotaxis`</span> with some rate <span title="//CellTypes/CellType/Constant[@symbol='chi'] or //CellTypes/CellType/Function[@symbol='chi']">$`\chi`$</span> towards a chemical <span title="//Global/Field[@symbol='c']">$`c`$</span>.

### Chemotaxis of Cells towards Domain Boundary

In {{< model_quick_access "media/model/m2010/SimpleChemotaxis_main.xml" >}}, the chemical level is initially high (<span title="//Global/Field/BoundaryValue[boundary='x']/@value">`BoundaryValue`&nbsp;$`= 5.0`$</span>) only along the right boundary of the domain. <span title="//Global/Field[@symbol='c']/Diffusion">`Diffusion`</span> and a <span title="//Global/System/DiffEqn[@symbol-ref='c']">`DiffEqn`</span> for decay then result in the gradient from left to right that directs the cell motion.

### Keller-Segel Chemotaxis

In {{< model_quick_access "media/model/m2010/KellerSegelChemotaxis.xml" >}}, the cells are sources of their own attractant, and move by chemotaxis in response to that attractant. The secreted chemical then diffuses and decays in the domain.
## Results

![](SimpleChemotaxis.png "Chemotaxis of cells towards a chemical attractant $`c`$ whose gradient is established by diffusion from the right boundary. Shown are the cells (bottom panels) at $`t = 100, 200, 300`$ time steps (left to right). The level of $`c`$ is indicated by red (high) to yellow (low) shades. Cells started at $`t = 0`$ in the small circle shown in the bottom left panel. The trajectories of the cells from $`t = 0`$ up to the given times are shown on the top panels. Produced with Morpheus file [`SimpleChemotaxis_main.xml`](#model).")

<figure>
  ![](M2010_chemotaxis_movie_SimpleChemotaxis_main.mp4)
  <figcaption>
    Simulation video of {{< model_quick_access "media/model/m2010/SimpleChemotaxis_main.xml" >}} showing chemotaxis of cells towards the chemical attractant
  </figcaption>
</figure>

<figure>
  ![](M2010_chemotaxis_movie_SimpleChemotaxis_main_trajectories.mp4)
  <figcaption>
    Simulation video of {{< model_quick_access "media/model/m2010/SimpleChemotaxis_main.xml" >}} showing the trajectories of the attracted cells
  </figcaption>
</figure>

![](KellerSegelChemoSim.png "A simulation of the Keller-Segel chemotaxis, illustrating the aggregation of cells that produce a chemical and are attracted by it. A time sequence from left to right and top to bottom starting with time $`t = 5`$ in increments of $`\Delta t = 15`$. The level of the chemical attractant is shown in shades from white to yellow and red as its concentration increases. Cells are all identical, but colored differently for ease of tracking their motions. Produced by Morpheus file [`KellerSegelChemotaxis.xml`](#downloads).")

<figure>
  ![](M2010_chemotaxis_movie_KellerSegelChemotaxis.mp4)
  <figcaption>
    Simulation video of {{< model_quick_access "media/model/m2010/KellerSegelChemotaxis.xml" >}}
  </figcaption>
</figure>
````

## File: Contributed Examples/CPM/Chemotaxis/KellerSegelChemotaxis.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>Keller-Segel chemotaxis </Title>
        <Details>Full title:		Chemotaxis
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		05.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2010
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		A group of cells secrete and are attracted by a chemical, c. The chemical diffuses and decays in the domain. This model is a hybrid implementation of Keller-Segel Chemotaxis, e.g. in the paper: Keller, Evelyn F., Lee A. Segel. "Initiation of slime mold aggregation viewed as an instability." Journal of Theoretical Biology 26.3 (1970): 399-415.</Details>
    </Description>
    <Global>
        <Field symbol="c" name="attractant" value="0">
            <Diffusion rate="1"/>
            <BoundaryValue boundary="x" value="0"/>
            <BoundaryValue boundary="-x" value="0"/>
            <BoundaryValue boundary="y" value="0"/>
            <BoundaryValue boundary="-y" value="0"/>
            <Annotation>The chemical, c, diffuses, is produced by cells, and decays </Annotation>
        </Field>
        <System time-step="0.1" solver="Euler [fixed, O(1)]">
            <Constant symbol="k1" value="0.5"/>
            <Constant symbol="k2" value="0.05"/>
            <DiffEqn symbol-ref="c">
                <Expression>is_source*k1 - k2*c</Expression>
            </DiffEqn>
        </System>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="l" value="150, 150, 0"/>
            <BoundaryConditions>
                <Condition type="constant" boundary="x"/>
                <Condition type="constant" boundary="-x"/>
                <Condition type="constant" boundary="y"/>
                <Condition type="constant" boundary="-y"/>
            </BoundaryConditions>
            <NodeLength value="0.1"/>
            <Neighborhood>
                <Distance>1.5</Distance>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime symbol="end" value="120"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="medium" name="medium">
            <Property symbol="max_c" value="0"/>
            <Property symbol="is_source" value="0"/>
        </CellType>
        <CellType class="biological" name="amoeba">
            <VolumeConstraint target="40" strength="1"/>
            <Chemotaxis name="attraction to higher c levels" strength="chi" field="c"/>
            <Property symbol="is_source" value="1">
                <Annotation>Cells are sources of the chemical and also undergo chemotaxis towards the chemical.</Annotation>
            </Property>
            <Property symbol="cs" name="Sensed chemical" value="0"/>
            <Function symbol="chi" name="Chemotaxis coefficient">
                <Expression>4</Expression>
            </Function>
            <Mapper name="sensing the chemical">
                <Input value="c"/>
                <Output symbol-ref="cs" mapping="average"/>
            </Mapper>
            <Annotation>The mapper takes values of the field and computes a cell property, namely the value of the chemical that the cells sense.</Annotation>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="amoeba" type2="amoeba" value="4"/>
            <Contact type1="amoeba" type2="medium" value="2"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration symbol="MCStime" value="0.001875"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics yield="0.1" temperature="1.0"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>1.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="amoeba" size="1">
            <InitCircle number-of-cells="20" mode="random">
                <Dimensions radius="l.x/2" center="l.x/2, l.y/2, 0"/>
            </InitCircle>
        </Population>
    </CellPopulations>>
    <Analysis>
        <Gnuplotter time-step="5" decorate="false">
            <Terminal name="png" size="400 400 0"/>
            <Plot>
                <Field symbol-ref="c" max="1.0" min="0">
                    <ColorMap>
                        <Color value="0" color="white"/>
                        <Color value="2.5" color="yellow"/>
                        <Color value="5.0" color="red"/>
                    </ColorMap>
                </Field>
                <Cells opacity="0.65" max="20" min="0.0" value="cell.id">
                    <ColorMap>
                        <Color value="1" color="red"/>
                        <Color value="20" color="blue"/>
                    </ColorMap>
                </Cells>
            </Plot>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Chemotaxis/model.md
````markdown
![](M2010_chemotaxis_model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/Chemotaxis/SimpleChemotaxis_main.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details>Full title:		Chemotaxis
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		05.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2010
File type:		Main model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Illustration of chemotaxis for a group of cells. A chemical c in a 2D domain, diffuses at rate D and decays at rate k. Periodic BCs in y direction, constant c on x boundaries, with high level at the right boundary. Heat map in 2D of the chemical to show its diffusion into the domain: Chemotaxis plug-in implemented in Morpheus. Cells have some attraction (with chemotaxis rate chi) towards the high chemical concentration. We also keep track of the cell trajectories over time to show the net drift towards the right.</Details>
        <Title>SimpleChemotaxis</Title>
    </Description>
    <Space>
        <Lattice class="square">
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Size symbol="size" value="150, 150, 0"/>
            <BoundaryConditions>
                <Condition type="constant" boundary="x"/>
                <Condition type="constant" boundary="-x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <NodeLength symbol="dx" value="0.1"/>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="300"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Global>
        <Field symbol="c" name="attractant" value="0">
            <Diffusion rate="0.5"/>
            <BoundaryValue boundary="x" value="5.0"/>
        </Field>
        <System time-step="0.5" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="c" name="attractant">
                <Expression>-k*c</Expression>
            </DiffEqn>
            <Constant symbol="k" name="decay rate" value="0.001"/>
        </System>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
        <Function symbol="y">
            <Expression>dx*space.y</Expression>
        </Function>
    </Global>
    <Analysis>
        <!--    <Disabled>
        <Logger time-step="5" name="chemical profile">
            <Input>
                <Symbol symbol-ref="c"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="25" title="chemical profile">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="c"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
    </Disabled>
-->
        <Gnuplotter time-step="5">
            <Plot title="chemotaxis of cells to chemical">
                <Field symbol-ref="c">
                    <ColorMap>
                        <Color value="5" color="red"/>
                        <Color value="2" color="yellow"/>
                    </ColorMap>
                </Field>
                <Cells max="10" min="0" value="cell.id"/>
            </Plot>
            <Terminal name="png"/>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
        <Logger time-step="1">
            <Input>
                <Symbol symbol-ref="cell.center.x"/>
                <Symbol symbol-ref="cell.center.y"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="50" title="Cell trajectories">
                    <Style point-size="0.5" style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis minimum="0.0" maximum="150.0">
                        <Symbol symbol-ref="cell.center.x"/>
                    </X-axis>
                    <Y-axis minimum="0.0" maximum="150.0">
                        <Symbol symbol-ref="cell.center.y"/>
                    </Y-axis>
                    <Color-bar minimum="0.0" maximum="10.0">
                        <Symbol symbol-ref="cell.id"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
    <CellTypes>
        <CellType class="biological" name="neutrophil">
            <Chemotaxis strength="chi" field="c&#xa;"/>
            <Constant symbol="chi" name="chemotactic coefficient" value="1.0"/>
            <VolumeConstraint target="50" strength="1"/>
            <ConnectivityConstraint/>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="neutrophil" type2="neutrophil" value="8"/>
            <Contact type1="neutrophil" type2="medium" value="4"/>
            <!--    <Disabled>
        <Contact type1="medium" type2="medium" value="0"/>
    </Disabled>
-->
        </Interaction>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>4</Order>
            </Neighborhood>
        </ShapeSurface>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="0.00375"/>
            <MetropolisKinetics yield="0.1" temperature="2"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </MonteCarloSampler>
    </CPM>
    <CellPopulations>
        <Population type="neutrophil" size="1">
            <InitCircle number-of-cells="10" mode="random">
                <Dimensions radius="size.x/10" center="size.x/10, size.y/2, 0.0"/>
            </InitCircle>
        </Population>
    </CellPopulations>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Circle Dance/CircleDance.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Example-CircleDance</Title>
        <Details>Demonstration of dynamically regulated cell-cell adhesion as a function of changing cell properties.
        
        Date: May 8, 2020
            
        Author: joern.starruss@tu-dresden.de
            
        Software: Morpheus (open-source), download from https://morpheus.gitlab.io  
        </Details>
    </Description>
    <Global/>
    <Space>
        <SpaceSymbol symbol="l"/>
        <Lattice class="square">
            <Size symbol="size" value="200, 200, 0"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </Lattice>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="12000"/>
        <RandomSeed value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType name="ct1" class="biological">
            <VolumeConstraint target="200" strength="1"/>
            <Property symbol="contact_length" value="0.0"/>
            <NeighborhoodReporter name="contact_length">
                <Input scaling="length" value="cell.type == celltype.ct1.id"/>
                <Output symbol-ref="contact_length" mapping="sum"/>
            </NeighborhoodReporter>
            <Property symbol="contact_fraction" value="0"/>
            <Equation symbol-ref="contact_fraction">
                <Expression>contact_length / cell.surface</Expression>
            </Equation>
            <Property symbol="adhesive" value="0.0"/>
            <System solver="Dormand-Prince [adaptive, O(5)]">
                <DiffEqn symbol-ref="adhesive">
                    <Expression>0.05*(1-contact_fraction) - 0.01 * adhesive</Expression>
                </DiffEqn>
            </System>
            <DelayProperty symbol="adhesive_d" name="concentration of adhesive molecules in membrane, turnover is delayed due to transport" delay="500" value="0.0"/>
            <Equation symbol-ref="adhesive_d">
                <Expression>adhesive</Expression>
            </Equation>
        </CellType>
        <CellType name="medium" class="medium">
            <Constant symbol="adhesive_d" value="0.0"/>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction default="0.0">
            <Contact type2="medium" type1="ct1" value="6"/>
            <Contact type2="ct1" type1="ct1" value="16">
                <HomophilicAdhesion strength="-3.0" adhesive="adhesive_d"/>
            </Contact>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="2"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>6</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="ct1" size="0">
            <InitCircle mode="random" number-of-cells="50">
                <Dimensions center="size.x/2, size.y/2, 0" radius="size.x/3"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="100" decorate="true">
            <Terminal name="png"/>
            <Plot title="adhesive state of cells">
                <Cells max="3" flooding="true" min="0" value="adhesive_d">
                    <ColorMap adaptive-range="false">
                        <Color color="red" value="3"/>
                        <Color color="yellow" value="1.5"/>
                        <Color color="white" value="0"/>
                    </ColorMap>
                </Cells>
            </Plot>
            <!--    <Disabled>
        <Plot>
            <Cells flooding="true" value="contact_fraction"/>
        </Plot>
    </Disabled>
-->
        </Gnuplotter>
        <ModelGraph include-tags="#untagged" reduced="false" format="svg"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Circle Dance/index.md
````markdown
---
MorpheusModelID: M8638

title: "Circle Dance"
#linktitle: ""
subtitle: "Demonstration of dynamically regulated cell-cell adhesion as a function of changing cell properties"

authors: [J. Starruß]
contributors: [J. Starruß, S. Pastor, L. Fischer]
submitters: [S. Pastor, L. Fischer]
curators: [D. Jahn]

# Peer review options
hidden: false
private: false

# date: "2020-05-08T00:00:00+02:00"

#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true
#  preprint: false

tags:
- Adhesion
- Adhesive
- Adhesive Molecule
- Antagonistic Process
- Attachment
- Cell-Cell Adhesion
- Cell Property
- Delayed Degradation
- Detachment
- Gnuplot
- Homophilic Adhesion
- Neighborhood Reporter
- Oscillation

#categories:
#- ... 
--- 
>Demonstration of dynamically regulated cell-cell adhesion as a function of changing cell properties

## Introduction

This model is an artistic example of cell-state-dependent adhesion.

![](plot_example.png "This is an example from the middle of the simulation. The red color shows a high concentration of the adhesive molecule while the white color demonstrates a low concentration. Correspondingly, red cells attach on the left and the white cells disperse on the right")

## Description

Cells in isolation produce an adhesive molecule which, if sufficiently high, lets the cells attach to each other. An antagonistic process causes delayed degradation of adhesive molecules when cells are actually in contact. The result is an oscillation with repeated attachment and detachment of cells, reminding of a dance.

The adhesive concentration is used in the `HomophilicAdhesion` plugin in the `//CPM/Interaction/Contact` section, i.e. adhesive molecules are required in both neighboring cells to make them adhesive.

Since the `HomophilicAdhesion` plugin looks for the symbol `adhesive_d` in all neighboring nodes of a cell, it must also be declared there, including in the medium. To respond with a default value for `adhesive_d` from medium nodes (or potentially other cell types), we can either declare a default of $`0`$ in `//Global` or specifically in `//CellType/Medium` (done here).

## Results

![A movie visualizing the effect of the adhesion molecules in the cells.](CircleDance.mp4)
**Movie:** Visualization of the effect of the adhesion molecules in the cells

When opening the model in the GUI, you may also switch on the so far disabled second `Gnuplot` with a further state variable (`contact_fraction`) of the process, which is measured per cell by the `NeighborhoodReporter`.
````

## File: Contributed Examples/CPM/Circle Dance/model.md
````markdown
![](model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/Correlated Random Walkers/CRW-ActinBranching.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>CRW-ActinBranchingUnlimited Arp2-3</Title>
        <Details>Full title:		Correlated Random Walkers
Authors:		L. Edelstein-Keshet
Contributors:	D. Jahn
Date:		19.02.2021
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2000
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Particles moving left and right (as well as up) to mimic actin filament barbed ends as in the paper: Grimm HP, Verkhovsky AB, Mogilner A, Meister JJ. Analysis of actin dynamics at the leading edge of crawling cells: implications for the shape of keratocyte lamellipodia. European Biophysics Journal. 2003 Oct 1;32(6):563-77. Initialize with a few close to y = 0, assign them random left or right directions. Asymmetric "cell division" is used to create branches at some constant probability. One daughter goes left, one goes right. This simulation mimics the "unlimited Arp2/3 scenario" where branching is not limited, and where branching takes place only close to the filament barbed ends. The trajectory of the particles represents the actin filaments. The cell x coordinate modulo the size of the x range is also kept, so that the cell trajectories "wrap around" (so we see "the filaments" of ends that wandered off the edge of the domain).</Details>
    </Description>
    <Global>
        <Constant symbol="xc" value="0.0"/>
    </Global>
    <Space>
        <SpaceSymbol symbol="space"/>
        <Lattice class="square">
            <Size symbol="size" value="200, 200, 0"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="noflux" boundary="y"/>
                <Condition type="noflux" boundary="-y"/>
                <Condition type="periodic" boundary="-x"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </Lattice>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="1400"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="medium" name="medium"/>
        <CellType class="biological" name="BarbedEnd">
            <Annotation>The barbed ends are assumed to grow left and right along a "motile cell edge" (not explicitly modeled). The actin filaments are depicted by the trails formed by barbed ends. Those are shown in the analysis, but not modeled explicitly otherwise.</Annotation>
            <VolumeConstraint target="50" strength="1"/>
            <ConnectivityConstraint/>
            <Property symbol="s" name="the direction" value="if(rand_uni(0,1)&lt;0.5,1,-1)"/>
            <Property symbol="nd" name="Number of divisions (branch order) so far" value="0.0"/>
            <Property symbol="xc" name="x coordinate modulo 200" value="0.0"/>
            <DirectedMotion direction="s, 1, 0.0" name="Move right/left (+1, -1) and up" strength="1.0"/>
            <CellDeath name="some death to avoid too many ">
                <Condition>rand_uni(0,1)&lt;0.0002</Condition>
                <Annotation>The "death" rate represents capping of an actin filament that prevents a barbed end from growing further. Those ends are essentially "dead".</Annotation>
            </CellDeath>
            <CellDivision orientation="1.0, 0.0, 0.0" division-plane="oriented" daughterID="daughter" name="Assymetric division">
                <Condition>rand_uni(0,1)&lt;0.002</Condition>
                <Triggers name="Create one daughter going left, one going right">
                    <Rule symbol-ref="s" name="assign different direction to each daughter">
                        <Expression>if(daughter==1,-1,1)</Expression>
                    </Rule>
                    <Rule symbol-ref="nd" name="increase branch order by one">
                        <Expression>nd+1</Expression>
                    </Rule>
                </Triggers>
                <Annotation>The "division" represents an event where the actin filament branches (via the Arp2/3 complex). Here the branching is assumed to take place right at the barber end. Each branching results in one daughter branch going left and a second going right. This is implemented using the asymmetric cell division of Morpheus.</Annotation>
            </CellDivision>
            <System name="x coordinate modulo 200" solver="Dormand-Prince [adaptive, O(5)]">
                <Rule symbol-ref="xc" name="Compute x coordinate modulo size of x axis">
                    <Expression>mod(cell.center.x,size.x)</Expression>
                </Rule>
                <Annotation>This modified x-coordinate is used for the wrap-around domain, so that particles that leave the domain edge are given a coordinate modulo the domain length. This method is used to insure that the trails (a.k.a. actin flaments) of all the particles are shown on the same periodic domain.</Annotation>
            </System>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction default="0.0">
            <Contact type1="BarbedEnd" type2="BarbedEnd" value="40"/>
            <Contact type1="BarbedEnd" type2="medium" value="20"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="2"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>6</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="BarbedEnd" size="1">
            <InitRectangle random-offset="5" number-of-cells="5" mode="random">
                <Dimensions origin="0.0, 0.0, 0.0" size="200.0, 20.0, 0.0"/>
            </InitRectangle>
            <Annotation>Initate all the barbed ends close to the lower part of the domain, so we can watch them move up.</Annotation>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="20" decorate="true">
            <Terminal name="png"/>
            <Annotation>Plot the actual locations of the barbed ends and assign them each the "branch order" (i.e. number of divisions) that they belong to.</Annotation>
            <Plot>
                <Cells flooding="true" min="0" value="nd">
                    <ColorMap>
                        <Color value="0" color="yellow"/>
                        <Color value="5" color="red"/>
                        <Color value="8" color="blue"/>
                        <Color value="12" color="black"/>
                    </ColorMap>
                </Cells>
                <CellLabels value="nd"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="10">
            <Annotation>Draw the "trails" left by the particles, i.e. the branched structure of the actin filaments.</Annotation>
            <Input>
                <Symbol symbol-ref="cell.center.x"/>
                <Symbol symbol-ref="cell.center.y"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="-1">
                    <Style point-size="1" style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis maximum="200.0" minimum="0.0">
                        <Symbol symbol-ref="xc"/>
                    </X-axis>
                    <Y-axis maximum="200.0" minimum="0.0">
                        <Symbol symbol-ref="cell.center.y"/>
                    </Y-axis>
                    <Color-bar reverse-palette="true">
                        <Symbol symbol-ref="time"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Correlated Random Walkers/index.md
````markdown
---
MorpheusModelID: M2000

title: Correlated Random Walkers

authors: [L. Edelstein-Keshet]
contributors: [D. Jahn]

# Under review
#hidden: true
#private: true

# Reference details
publication:
  doi: "10.1007/s00249-003-0300-4"
  title: "Analysis of actin dynamics at the leading edge of crawling cells: implications for the shape of keratocyte lamellipodia"
  authors: [H. P. Grimm, A. B. Verkhovsky, A. Mogilner, J.-J. Meister]
  journal: "Eur. Biophys. J."
  volume: 32
  #issue:
  page: "563–577"
  year: 2003
  #original_model: true

date: "2021-02-18T00:09:00+01:00"

tags:
- Actin
- Actin Dynamics
- Arp 2/3
- Arp2/3 Complex
- Asymmetric Cell Division
- Barbed End
- BoundaryConditions
- Branching
- CellDivision
- Filament
- Particle
- Periodic
- Periodic BoundaryConditions
- Trajectory

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
#- DOI:10.1007/s00249-003-0300-4
---
>Particles moving left and right (as well as up) to mimic actin filament barbed ends

## Introduction

Particles are moving left and right (as well as up) to mimic actin filament barbed ends as motivated by the [referenced paper](#reference).

<figure>
![](movie.mp4)
<figcaption>
Movie of the simulation showing the movement of particles representing actin filament barbed ends.
</figcaption>
</figure>

## Description

The simulation is initialized with a few cells close to <span title="//CellPopulations/Population[type='BarbedEnd']/InitRectangle[@mode='random' and @number-of-cells='5']/Dimensions[@size='200.0, 20.0, 0.0']">$`y = 0`$</span>, which are assigned random left or right directions.

Asymmetric <span title="//CellTypes/CellType[@name='BarbedEnd']/CellDivision[@orientation='1.0, 0.0, 0.0']">`CellDivision`</span> is used to create branches at some constant probability. One daughter goes left, one goes right.

The cell $`x`$ coordinate modulo the size of the $`x`$ range is also kept via a <span title="//CellTypes/CellType[@name='BarbedEnd']/System/Rule[@symbol-ref='xc']">`Rule`</span>, so that the cell trajectories ‘wrap around’ (so we see ‘the filaments’ of ends that wandered off the edge of the domain).

## Results

This simulation mimics the ‘unlimited Arp2/3 scenario’ where branching is not limited, and where branching takes place only close to the filament barbed ends.

![](plot_00800.png "Snapshot of the actual locations of the barbed ends with the ‘branch order’ (i.e. number of divisions) that they belong to assigned to each of them.")

The trajectory of the particles represents the actin filaments.

![](logger_plot_xc_cell.center.y_time_01400.png "‘Trails’ left by the particles, i.e. the branched structure of the actin filaments.")
````

## File: Contributed Examples/CPM/Correlated Random Walkers/model.md
````markdown
![](model-graph.svg "Model Graph.")
````

## File: Contributed Examples/CPM/Hold Cell in Place/index.md
````markdown
---
MorpheusModelID: M5495

title: "Hold cell in place"

authors: [J. Starruß]
contributors: [L. Brusch]
submitters: [L. Brusch]
curators: [L. Brusch]

# Under review
hidden: false
private: false

tags:
- 2D
- Agent-based Simulation
- Cellular Potts Model
- CPM
- DirectedMotion
- FreezeMotion
- Membrane
- MembraneProperty
- Signaling
- Spatial Model
- Stochastic Model

#categories:

---
> Can a CPM cell be held in a defined position and continue its other dynamics?

## Introduction

CPM cells inherently interact with other cells by volume exclusion (steric interaction) and can get pushed out of the way. Here, we compare three cell behaviors where, in addition to steric interactions, either a cell's center of mass or the entire cell shape get fixed. All other dynamics continue inside each cell and on each cell shape. This example was motivated by [Ivan in the Morpheus user forum](https://groups.google.com/g/morpheus-users/c/GMLfPr8wa7g).

## Model Description

This model has two `CellTypes`. The first, our cells of interest, is used to initialize 3 cells in a column. All model elements that control aspects of the cell shape are tagged with `cell`. Just to demonstrate that all other dynamics continue inside each cell, on its membrane and in its interaction with a global field, we also let these cells perform intracellular and membrane dynamics (tagged `membrane`) that interact with an extracellular field (tagged `global`). 

![Snapshot of the three cells of interest](snapshot.png "The three cells of interest are placed on the central column and the runner cell passes from top to bottom on the right lane. The right panel shows the global field that receives a substance, secreted from selected membrane domains.")

The second `CellTypes` gives a single runner cell on the right lane that just aims to perturb the three other cells.

## Results

Based on the cells' IDs, we let cell ID=1 (bottom cell in column and red trajectory in following plot) perform the normal membrane fluctuations of a CPM. Its center of mass fluctuates strongly and gets pushed away 3 lattice units (within the shown 1000 MCS) from its initial position.

The cell with ID=2 (middle and green trajectory) stores the initial position of its center of mass and uses `DirectedMotion` in opposite direction from its displacement to restore that position after a perturbation. This yields minute fluctuations of less than a lattice unit. The strength parameter of `DirectedMotion` allows to tune the rigidity of the center of mass position. The cell shape remains flexible.

The cell with ID=3 (top and blue trajectory) freezes its entire shape after an initial time step (the condition to freeze after one time step is chosen such that a short line becomes visible in the trajectory plot). 

The runner cell then squeezes around the frozen cell, reversibly deforms the middle cell (that is held in place) and it pushes aside the normal bottom cell.

![Trajectories of three cells of interest](trajectories.png "Each of the three cells of interest tracks the displacement vector of its center of mass from its initial position. The bottom cell of the following movie has ID=1 and its trajectory is shown in red. The middle cell controls its center of mass and is depicted in green. The top cell has a frozen shape and its center of mass rests, represented by the short blue trajectory.")

![](movie.mp4)

We can also record the history of lattice nodes that once were occupied by the membranes of cells 1, 2, 3 (see following plots). The runner cell was excluded here. 

![History of cell shapes](Shape_history.png "Lattice nodes that were once occupied by a cell membrane during 50k MCS are shown red (binary data, left) and the same shape history is shown as the cumulative time fraction that each lattice node was occupied by a cell membrane (density data, right).")

The same method may also be used to force cells along arbitrary (microscopy image-derived) trajectories by inserting data into the calculation of the displacement vector.
````

## File: Contributed Examples/CPM/Hold Cell in Place/model.md
````markdown
![](model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/Hold Cell in Place/model.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details>Full title:	Hold cell in place
Authors:		J. Starruß
Contributors:	L. Brusch
Date:		21.10.2024
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M5495
</Details>
        <Title>Hold cell</Title>
    </Description>
    <Space>
        <Lattice class="square">
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Size symbol="size" value="50, 150, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="-x"/>
                <Condition type="periodic" boundary="y"/>
                <Condition type="periodic" boundary="-y"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="space"/>
        <MembraneLattice>
            <Resolution symbol="memsize" value="100"/>
            <SpaceSymbol symbol="memspace"/>
            <Annotation>MembraneLattice resolution is defined here. In CellType, this then allows to use dynamics of spatial fields on the membrane of CPM cells. Please see the InApp-Docu for more details on MembraneLattice.</Annotation>
        </MembraneLattice>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="1000"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType name="cell" class="biological">
            <VolumeConstraint target="400" strength="1" tags="cell"/>
            <SurfaceConstraint target="1" strength="1" mode="aspherity" tags="cell"/>
            <MembraneProperty symbol="m" name="membrane substance" tags="membrane" value="sin(angle_secretion-memspace.phi) * (sin(angle_secretion-memspace.phi)>0)">
                <Diffusion rate="0.0"/>
                <Annotation>Just for demonstration purposes, this MembraneProperty is controlling the directed secretion of the substanc.</Annotation>
            </MembraneProperty>
            <PropertyVector symbol="cell.center.initial" tags="cell" value="cell.center"/>
            <PropertyVector symbol="cell.center.displacement" tags="cell" value="0.0, 0.0, 0.0"/>
            <VectorEquation symbol-ref="cell.center.displacement" tags="cell">
                <Expression>cell.center - cell.center.initial</Expression>
            </VectorEquation>
            <DirectedMotion strength="1*(cell.id==2)" direction="- cell.center.displacement" tags="cell"/>
            <FreezeMotion tags="cell">
                <Condition>(time>0)*(cell.id==3)</Condition>
            </FreezeMotion>
            <Property symbol="angle_secretion" tags="membrane" value="0.0"/>
            <System time-step="100" name="Demo intracellular dynamics" solver="Euler [fixed, O(1)]" tags="membrane">
                <Rule symbol-ref="angle_secretion">
                    <Expression>rand_uni(0,2*pi)</Expression>
                </Rule>
            </System>
            <System time-step="100" name="Demo membrane dynamics on cell shape" solver="Euler [fixed, O(1)]" tags="membrane">
                <Rule symbol-ref="m">
                    <Expression>sin(angle_secretion-memspace.phi) * (sin(angle_secretion-memspace.phi)>0)</Expression>
                </Rule>
            </System>
        </CellType>
        <CellType name="runner" class="biological">
            <VolumeConstraint target="400" strength="1" tags="cell"/>
            <SurfaceConstraint target="1" strength="1" mode="aspherity" tags="cell"/>
            <DirectedMotion strength="1" direction="0,-1,0" tags="cell"/>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction/>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>optimal</Order>
            </Neighborhood>
        </ShapeSurface>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <MetropolisKinetics temperature="1"/>
            <Neighborhood>
                <Order>optimal</Order>
            </Neighborhood>
        </MonteCarloSampler>
    </CPM>
    <CellPopulations>
        <Population type="cell" size="0">
            <InitCellObjects mode="distance" tags="cell">
                <Arrangement repetitions="1, 3, 1" displacements="0, 50, 0">
                    <Sphere center="25,25,0" radius="10"/>
                </Arrangement>
            </InitCellObjects>
        </Population>
        <Population type="runner" size="1">
            <InitCellObjects mode="distance" tags="cell">
                <Arrangement repetitions="1, 1, 1" displacements="0, 0, 0">
                    <Sphere center="37,100,0" radius="10"/>
                </Arrangement>
            </InitCellObjects>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="10">
            <Terminal name="png"/>
            <Plot>
                <Cells value="m">
                    <ColorMap>
                        <Color color="red" value="2"/>
                        <Color color="yellow" value="1"/>
                        <Color color="white" value="0"/>
                    </ColorMap>
                </Cells>
            </Plot>
            <Plot>
                <Field symbol-ref="c" max="160" min="0"/>
            </Plot>
        </Gnuplotter>
        <ModelGraph include-tags="#untagged,global,membrane,cell" format="dot" reduced="false"/>
        <Logger time-step="1.0">
            <Input/>
            <Output>
                <TextOutput file-separation="cell"/>
            </Output>
            <Plots>
                <Plot time-step="-1">
                    <Style style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis minimum="-5" maximum="5">
                        <Symbol symbol-ref="cell.center.displacement.x"/>
                    </X-axis>
                    <Y-axis minimum="-5" maximum="5">
                        <Symbol symbol-ref="cell.center.displacement.y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="cell.id"/>
                    </Color-bar>
                </Plot>
            </Plots>
            <Restriction>
                <Celltype celltype="cell"/>
            </Restriction>
        </Logger>
    </Analysis>
    <Global>
        <Field symbol="c" name="global substance" tags="global" value="0">
            <Diffusion rate="0.01"/>
            <Annotation>Global Field for secreted substance. This field is initialized as 0 and will then "take up" the substance that is secreted by the cells.</Annotation>
        </Field>
        <Constant symbol="m" name="membrane substance" tags="membrane" value="0">
            <Annotation>We need to introduce another constant for the substance in the Global scope wherever it is not reset by the value of the membrane field with the same Symbol (with its dynamics defined in the Cell scope).</Annotation>
        </Constant>
        <System time-step="1.0" name="Secretion System" solver="Runge-Kutta [fixed, O(4)]" tags="membrane, global">
            <DiffEqn symbol-ref="c">
                <Expression>m - 0.001*c</Expression>
            </DiffEqn>
        </System>
    </Global>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Init Population/index.md
````markdown
---
MorpheusModelID: M5492

contributors: [G. Burger, L. Brusch]

title: Initialize cell population from CSV
date: "2023-11-06T10:42:00+02:00"
lastmod: "2023-11-07T14:49:00+01:00"

tags:
- 2D
- Adhesion
- Cellular Potts Model
- Cell Sorting
- CPM
- CSVReader
- Initial Condition
- Multicellular Model
- Spatial Model
- Stochastic Model

---

{{% callout note %}}
This model also requires the separate file [`Population_M.csv`](#downloads) with the list of lattice nodes where cells shall be initialized.
{{% /callout %}}

## Introduction

Initializing the spatial configuration of cells is a key step of every simulation and Morpheus offers all the flexibility for this:
1. the model section ```CellPopulations/Population``` (in the GUI and xml) can declare geometrical rules incl.
- ```InitCellObjects/Arrangement``` (cell repetitions in (x,y,z), displacements in (x,y,z) and random_displacement) of different cell shapes with adjustable sizes and rotation angles (Point, Box, Sphere, Ellipsoid, Cylinder)
- ```InitCircle``` (seed cells in a circular subdomain), ```InitDistribute```, ```InitHexLattice```, ```InitPoissonDisc```, ```InitRectangle```, ```InitVoronoi```
2. you can overlay multiple ```CellPopulations/Population``` groups with the above constructs
3. all these arrangements together can be masked by ```Lattice/Domain```
4. you may specify the initial cell shapes or just set single points that will inflate into cell shapes during an initial transient of the model simulation
5. you can load a ```CellPopulations/Population``` from files, both CSV (for lists of nodes for seeding as shown below) or TIFF (for pixel-based spatial layout where pixel color is interpreted as ```CellID```, so you can segment from microscopy images or draw arbitrary areas each with the same color)
6. you can run a helper model that distributes the cells as you need and saves a snapshot of the spatial configuration with ```Time/SaveInterval``` (then load the snapshot ```model.xml``` and copy/paste its ```CellPopulations/Population``` from the snapshot model to your main model)

All these rules for initializing the spatial configuration of cells are included in the same xml file as the model rules. So you can reproduce the exact same initialization from the model.xml.

For a realistic epithelial cell arrangement, see this [Blog post](https://morpheus.gitlab.io/post/2019/07/01/poisson-disc-sampling/).

## Description

Here we use the file ```Population_M.csv``` with a list of seeding positions to initialize one of two cell populations with the shape of the letter M. 

![](plot_00000.png "Snapshot at time=0 with the loaded single nodes forming an M for the (red) cell population superimposed on another randomly placed set of nodes for the (yellow) cell population.")

![](plot_00100.png "Snapshot at time=100, color code as described for previous figure.")

![](movie.mp4)
The video shows how the single nodes inflate to cell shapes during 100 Monte Carlo steps.
````

## File: Contributed Examples/CPM/Init Population/model.md
````markdown
{{% callout note %}}
This model also requires the separate file [`Population_M.csv`](#downloads).
{{% /callout %}}

![](model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/Init Population/Population_M.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Example-CellSorting-2D</Title>
        <Details>Demo of cell population initialization from a file (here Population_M.csv).
        </Details>
    </Description>
    <Global/>
    <Space>
        <SpaceSymbol symbol="l"/>
        <Lattice class="square">
            <Size symbol="size" value="200, 200, 0"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </Lattice>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="100"/>
        <RandomSeed value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType name="ct1" class="biological">
            <VolumeConstraint target="100" strength="1"/>
        </CellType>
        <CellType name="ct2" class="biological">
            <VolumeConstraint target="100" strength="1"/>
        </CellType>
        <CellType name="medium" class="medium"/>
    </CellTypes>
    <CPM>
        <Interaction default="0.0">
            <Contact type2="medium" type1="ct1" value="12"/>
            <Contact type2="medium" type1="ct2" value="6"/>
            <Contact type2="ct1" type1="ct1" value="6"/>
            <Contact type2="ct2" type1="ct2" value="6"/>
            <Contact type2="ct2" type1="ct1" value="16"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="2"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>6</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="ct1" size="0">
            <CSVReader filename="Population_M.csv" scaling="1.0, 1.0, 1.0"/>
        </Population>
        <Population type="ct2" size="0">
            <InitCircle mode="regular" number-of-cells="100">
                <Dimensions center="size.x/2, size.y/2, 0" radius="size.x/3"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="10" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells flooding="true" value="cell.type"/>
            </Plot>
        </Gnuplotter>
        <ModelGraph include-tags="#untagged" format="dot" reduced="false"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Logical Operators/index.md
````markdown
---
MorpheusModelID: M5494

contributors: [Erwin, J. Starruß, L. Brusch]

title: Logical Operators
date: "2021-10-31T10:42:00+02:00"
lastmod: "2021-10-31T14:49:00+01:00"
---

>Use logical operators ```and```, ```or``` and ```xor``` in ```Condition``` for ```ChangeCellType```.

## Introduction

This example model demonstrates the use of logical operators. Please also see the built-in docu at ```GUI/Documentation/MathematicalExpressions```. Beyond conditions, logical operator anywhere evaluate to 0 or 1, which can be included as numerical terms in any formula. The latter may be useful as a shorter alternative notation of ```if()``` statements. This example was motivated by [Erwin in the Morpheus user forum](https://groups.google.com/g/morpheus-users/c/VaMIwFwSpqg).

## Description

Derived from the built-in model [CellSorting-2D](https://morpheus.gitlab.io/model/M0021/), the added plugin ```ChangeCellType``` in ct1 now gradually creates cells of ct2 (shown yellow) from initially 100 cells of ct1. The ```Condition``` 

```
(rand_uni(0,1)<p) 
and ((cell.center.x<0.4*size.x) or (cell.center.x>0.6*size.x)) 
and ((time>200) xor (celltype.ct2.size>50))
```

combines the logical operators ```and```, ```or``` and ```xor``` to probabilistically (p=0.1% per ct1 cell per MCS, as defined in ```Global```) change cell type after t>200 and only to the left or right and only until 50 yellow cells were created (just to demo the use of ```xor```).

![](movie.mp4)

Movie visualising the condition-dependent ChangeCellType after t>200 and only to the left or right and only until 50 yellow cells were created. The left panel shows cell type ct1 (red) and ct2 (yellow), the middle panel for each cell shows the number of neighbors of a different cell type and the right panel for each cell shows the length of contact to all neighbors of a different cell type.
````

## File: Contributed Examples/CPM/Logical Operators/LogicalOperators.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Example-CellSorting-2D-LogicalOperators</Title>
        <Details>The condition in ChangeCellType in ct1 demonstrates the use of logical operators.

Reference for the cell sorting model:
Graner and Glazier, Simulation of biological cell sorting using a two-dimensional extended Potts model, Phys. Rev. Lett. 69, 2013–2016 (1992)
</Details>
    </Description>
    <Global>
        <Variable value="0.0" name="Boundary length of CT1 with other cell types" symbol="boundary"/>
        <Constant value="0.0" symbol="b"/>
        <Constant value="0.0" symbol="b2"/>
        <Constant value="0.001" name="0.1% ChangeCellType" symbol="p"/>
    </Global>
    <Space>
        <SpaceSymbol symbol="l"/>
        <Lattice class="square">
            <Size value="200, 200, 0" symbol="size"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </Lattice>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="5000"/>
        <RandomSeed value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="ct1">
            <VolumeConstraint target="200" strength="1"/>
            <NeighborhoodReporter>
                <Input scaling="length" value="cell.type == celltype.ct2.id"/>
                <Output symbol-ref="boundary" mapping="sum"/>
            </NeighborhoodReporter>
            <Property value="0" symbol="b"/>
            <NeighborhoodReporter>
                <Input scaling="cell" value="cell.type == celltype.ct2.id"/>
                <Output symbol-ref="b" mapping="sum"/>
            </NeighborhoodReporter>
            <NeighborhoodReporter>
                <Input scaling="length" value="cell.type == celltype.ct2.id"/>
                <Output symbol-ref="b2" mapping="sum"/>
            </NeighborhoodReporter>
            <Property value="0" name="Interface with ct2" symbol="b2"/>
            <ChangeCellType name="to ct2" newCellType="ct2">
                <Condition>(rand_uni(0,1)&lt;p) 
and ((cell.center.x&lt;0.4*size.x) or (cell.center.x>0.6*size.x)) 
and ((time>200) xor (celltype.ct2.size>50))</Condition>
            </ChangeCellType>
        </CellType>
        <CellType class="biological" name="ct2">
            <VolumeConstraint target="200" strength="1"/>
            <Property value="0" symbol="b"/>
            <NeighborhoodReporter>
                <Input scaling="cell" value="cell.type == celltype.ct1.id"/>
                <Output symbol-ref="b" mapping="sum"/>
            </NeighborhoodReporter>
            <Property value="0" name="Interface with ct1" symbol="b2"/>
            <NeighborhoodReporter>
                <Input scaling="length" value="cell.type == celltype.ct1.id"/>
                <Output symbol-ref="b2" mapping="sum"/>
            </NeighborhoodReporter>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction default="0.0">
            <Contact value="12" type2="medium" type1="ct1"/>
            <Contact value="6" type2="medium" type1="ct2"/>
            <Contact value="6" type2="ct1" type1="ct1"/>
            <Contact value="6" type2="ct2" type1="ct2"/>
            <Contact value="16" type2="ct2" type1="ct1"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="2"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>6</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="ct1" size="0">
            <InitCircle mode="random" number-of-cells="100">
                <Dimensions radius="size.x/3" center="size.x/2, size.y/2, 0"/>
            </InitCircle>
        </Population>
        <!--    <Disabled>
        <Population type="ct2" size="0">
            <InitCircle mode="random" number-of-cells="50">
                <Dimensions radius="size.x/3" center="size.x/2, size.y/2, 0"/>
            </InitCircle>
        </Population>
    </Disabled>
-->
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="100" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells value="cell.type" flooding="true"/>
            </Plot>
            <Plot>
                <Cells value="b" flooding="true">
                    <ColorMap>
                        <Color value="2" color="red"/>
                        <Color value="1" color="yellow"/>
                        <Color value="0" color="white"/>
                    </ColorMap>
                </Cells>
                <CellLabels fontsize="10" value="b" precision="0"/>
            </Plot>
            <Plot>
                <Cells value="b2" per-frame-range="true">
                    <ColorMap>
                        <Color value="2" color="red"/>
                        <Color value="1" color="yellow"/>
                        <Color value="0" color="white"/>
                    </ColorMap>
                </Cells>
                <CellLabels fontsize="10" value="b2" precision="0"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="10.0">
            <Input>
                <Symbol symbol-ref="boundary"/>
                <Symbol symbol-ref="b"/>
                <Symbol symbol-ref="b2"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="500">
                    <Style style="linespoints"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="boundary"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="dot" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Logical Operators/model.md
````markdown
![](model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/Logistic Proliferation/index.md
````markdown
---
MorpheusModelID: M8639

title: "Logistic Proliferation"
#linktitle: ""
subtitle: "Regulation of cell proliferation by shared resource as in a stem cell niche"

authors: [M. Odonkor, L. Brusch]
contributors: [L. Brusch]
submitters: [L. Brusch]
curators: [L. Brusch]

# Peer review options
hidden: false
private: false

# date: "2024-06-15T15:00:00+02:00"

#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true
#  preprint: false

tags:
- Agent based model
- Proliferation
- Differentiation
- CPM

#categories:
#- ... 
--- 
>How to dynamically regulate individual cell proliferation?

## Introduction

Proliferation of individual cells may be coupled through the dependence on common resources. This turns the otherwise exponential growth of the population size into, for example, logistic growth. Stem cell populations in their niche may be modeled this way such that a bounded population size of stem cells results and generates a constant flux of differentiated cells. The latter scenario was motivated by Mavis in the [User Forum](https://groups.google.com/g/morpheus-users/c/IR4xHp8wGSU) and is picked up in this model.

## Description

![](Logistic_Proliferation.png "Snapshot of the simulation with a stem cell niche (red) and differentiated cells (blue).")

The model considers two cell types, stem cells (red) and differentiated cells (blue). Stem cells proliferate with a rate 'r*(1-N_SC/K)' where 'r' is the maximum division rate of an isolated cell, 'N_SC' is the number of coupled stem cells (provided by Morpheus through the Symbol 'celltype.stem_cell.size') and 'K' is the carrying capacity of the niche. Differentiated cells, just for illustration, shrink their volume and migrate outward. Differentiation occurs with rate 'd'. The parameters 'r', 'K' and 'd' can be set in the 'Global' section of the model. The simulation is initialized with a single stem cell in the center.

## Results

![Visualization of the logistic proliferation of individual cells (red) and differentiation into migrating cells (blue).](Logistic_Proliferation.mp4)
**Movie:** Simulation of the logistic proliferation of individual cells (red) and differentiation into migrating cells (blue).

The number of simulated stem cells can be counted (purple in the time course plot) and shows the emergent balance of proliferation (coupled through a common carrying capacity) and differentiation. Also the number of differentiated cells is counted (green curve) and shows a linear increase after the stem cell population has reached its balance.

![](logger.png "Number of stem cells and differentiated cells in the above simulation movie.")
````

## File: Contributed Examples/CPM/Logistic Proliferation/Logistic_Proliferation.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details></Details>
        <Title>Logistic_Proliferation</Title>
    </Description>
    <Space>
        <Lattice class="hexagonal">
            <Neighborhood>
                <Order>optimal</Order>
            </Neighborhood>
            <Size symbol="size" value="200, 200, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="y"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="2000"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Analysis>
        <ModelGraph include-tags="#untagged" format="dot" reduced="true"/>
        <Gnuplotter time-step="100">
            <Plot>
                <Cells max="2" min="1" value="cell.type">
                    <ColorMap adaptive-range="false">
                        <Color color="red" value="1"/>
                        <Color color="blue" value="2"/>
                    </ColorMap>
                </Cells>
            </Plot>
            <Terminal name="png"/>
        </Gnuplotter>
        <Logger time-step="1.0">
            <Input/>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot title="Population size" time-step="-1">
                    <Style style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis minimum="0" maximum="60">
                        <Symbol symbol-ref="N_stem_cell"/>
                        <Symbol symbol-ref="N_differentiated_cell"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
        <Function symbol="N_stem_cell" name="number of stem cells">
            <Expression>celltype.stem_cell.size</Expression>
        </Function>
        <Function symbol="N_differentiated_cell" name="number of differentiated cells">
            <Expression>celltype.differentiated_cell.size</Expression>
        </Function>
    </Analysis>
    <Global>
        <Constant symbol="r" name="proliferation rate" value="0.01"/>
        <Constant symbol="K" name="carrying capacity" value="50"/>
        <Constant symbol="d" name="differentiation rate" value="0.001"/>
    </Global>
    <CellTypes>
        <CellType name="medium" class="medium"/>
        <CellType name="stem_cell" class="biological">
            <VolumeConstraint target="50" strength="1"/>
            <SurfaceConstraint target="0.9" strength="1" mode="aspherity"/>
            <ConnectivityConstraint/>
            <CellDivision name="logistic proliferation" division-plane="major">
                <Condition>rand_uni(0,1) &lt; r*(1-celltype.stem_cell.size/K)*mcs_duration</Condition>
            </CellDivision>
            <ChangeCellType time-step="mcs_duration" newCellType="differentiated_cell" name="differentiation">
                <Condition>rand_uni(0,1) &lt; d*mcs_duration</Condition>
            </ChangeCellType>
        </CellType>
        <CellType name="differentiated_cell" class="biological">
            <VolumeConstraint target="10" strength="1"/>
            <SurfaceConstraint target="0.8" strength="2" mode="aspherity"/>
            <ConnectivityConstraint/>
            <DirectedMotion strength="0.5" name="motility" direction="cell.center.x-size.x/2, cell.center.y-size.y/2, 0"/>
        </CellType>
    </CellTypes>
    <CellPopulations>
        <Population type="stem_cell" size="1">
            <InitCellObjects mode="distance">
                <Arrangement repetitions="1, 1, 1" displacements="1, 1, 1">
                    <Sphere center="size.x/2, size.y/2, 0" radius="4"/>
                </Arrangement>
            </InitCellObjects>
        </Population>
    </CellPopulations>
    <CPM>
        <Interaction>
            <!--    <Disabled>
        <Contact type2="medium" type1="stem_cell" value="5"/>
    </Disabled>
-->
            <!--    <Disabled>
        <Contact type2="medium" type1="differentiated_cell" value="5"/>
    </Disabled>
-->
            <!--    <Disabled>
        <Contact type2="differentiated_cell" type1="stem_cell" value="6"/>
    </Disabled>
-->
            <Contact type2="stem_cell" type1="stem_cell" value="-2"/>
            <!--    <Disabled>
        <Contact type2="differentiated_cell" type1="differentiated_cell" value="6"/>
    </Disabled>
-->
        </Interaction>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>optimal</Order>
            </Neighborhood>
        </ShapeSurface>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration symbol="mcs_duration" value="1"/>
            <MetropolisKinetics temperature="1"/>
            <Neighborhood>
                <Order>optimal</Order>
            </Neighborhood>
        </MonteCarloSampler>
    </CPM>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Logistic Proliferation/model.md
````markdown
![](model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/Mix and Sort/index.md
````markdown
---
MorpheusModelID: M5480

title: Repeated Adhesion-based Mixing and Sorting of Cells

contributors: [W. de Back, F. El-Hendi]

categories:
- DOI:10.1103/PhysRevLett.69.2013

tags:
- 2D
- Adhesion
- Contributed Examples
- Cell-Cell Adhesion
- Cellular Potts Model
- CPM
- Homophilic Adhesion
- HomophilicAdhesion
- Interaction
---

>Changing the adhesion parameters `CPM`/`Interaction`/`Contact` `value` during simulation runtime

## Introduction

This example model demonstrates the use of variable adhesion values in the `CPM`/`Interaction`/`Contact`/`HomophilicAdhesion` plugin. Please also see the built-in docu at `MorpheuML`/`CPM`/`Interaction`/`Contact`/`HomophilicAdhesion`. The same is possible for the `HeterophilicAdhesion` as well. Here the adhesive variable is time-dependent, but other forms are possible as well, e.g. space-dependent. This example was motivated by a Morpheus user in the [Morpheus user forum](https://groups.google.com/g/morpheus-users/c/M6F0S8VxyBo)

## Description

Based on the [built-in example](/model/built-in-examples/) `Examples` → `CPM` → `CellSorting_2D.xml` ([M0021](/model/M0021/)), a cell Property `c` (for cadherin) is created and this is used as a symbol for the adhesive in `HomophilicAdhesion` for the contact between the celltypes `ct1` and `ct2`. The value of `c` is changed by the `Equation`:

```
c = sin(time / 1000.0) + 1 
```

which modulates cell-cell adhesion as a function of time according to a sine wave. 

As a result, the cell types `ct1` and `ct2` will sort out, then mix, sort out again, mix etc.

Movie visualising the change in adhesion properties over time:

![Movie visualising the change in adhesion properties over time.](mix_and_sort.mp4)

The panel shows cell type `ct1` (red) and `ct2` (yellow).
````

## File: Contributed Examples/CPM/Mix and Sort/mix_and_sort.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Mix and Sort</Title>
        <Details>Demonstration of dynamic cell-cell interactions in CPM module. This example shows the use of the HomoohilicAdhesion Plugin using a time-dependent adhesive variable. 

In the model (based on the CPM/CellSorting_2D.xml example), a cell Property "c" (for cadherin) is created and this is used as a symbol for the adhesive in HomophilicAdhesion for the Contact between the celltpes ct1 and ct2. The value of "c" is changed by an Equation which modulates cell-cell adhesion as a function of time according to a sine wave. 
  
As a result, the cell types ct1 and ct2 will sort out, then mix, sort out again, mix, etc. 
  
Steps to reproduce: 
1. Define a symbol for time, e.g. Time / TimeSymbol = "time" 
2. Define a Cell Property, e.g. "c". Note that this needs to be defined for all cell types (including medium). 
3. Define an Equation (in one of the cell types) that changes "c" as a function of "time". 
4. Add an adhesion plugin in CPM/Interaction/Contact/HomophilicAdhesion and with nonzero strength and use "c" as an adhesive. 
  
This works for HeterophilicAdhesion as well. 
  
Reference: 
Graner and Glazier, Simulation of biological cell sorting using a two-dimensional extended Potts model, Phys. Rev. Lett. 69, 2013–2016 (1992) 
  
Date: March 2, 2022 
	Author: walter@deback.net 
	Contributor: ferras_mahmoud.el-hendi@tu-dresden.de 
	Software: Morpheus (open-source), download from https://morpheus.gitlab.io </Details>
    </Description>
    <Space>
        <SpaceSymbol symbol="l"/>
        <Lattice class="square">
            <Size symbol="size" value="100, 100, 0"/>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
            </BoundaryConditions>
            <Neighborhood>
                <Distance>3.9</Distance>
            </Neighborhood>
        </Lattice>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="5e4"/>
        <!--    <Disabled>
        <SaveInterval value="5e3"/>
    </Disabled>
-->
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType tags="ct1" class="biological" name="ct1">
            <VolumeConstraint target="53" strength="1"/>
            <Property name="cadherin" symbol="c" value="10.0">
                <Annotation>Cell property to control HomophilicAdhesion</Annotation>
            </Property>
            <Equation tags="ct1" symbol-ref="c">
                <Expression>sin(time / 1000.0) + 1</Expression>
                <Annotation>Equation changes the value of the symbol "c". This modulates cell-cell adhesion as a function of time according to a sine wave. </Annotation>
            </Equation>
        </CellType>
        <CellType tags="ct1" class="biological" name="ct2">
            <VolumeConstraint target="53" strength="1"/>
            <Property symbol="c" value="10.0"/>
        </CellType>
        <CellType tags="medium" class="medium" name="medium">
            <Property symbol="c" value="0.0"/>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction default="0.0">
            <Contact type2="medium" value="12" type1="ct1"/>
            <Contact type2="medium" value="5" type1="ct2"/>
            <Contact type2="ct1" value="8" type1="ct1"/>
            <Contact type2="ct2" value="8" type1="ct2"/>
            <Contact type2="ct2" value="0" type1="ct1">
                <HomophilicAdhesion tags="ct1, ct2" adhesive="c" strength="12">
                    <Annotation>Adhesive value is set to variable "c", which is calculated as result of a time dependent equation. See CellTypes/ct1/Equation .</Annotation>
                </HomophilicAdhesion>
            </Contact>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="1"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>3</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population size="25" type="ct1">
            <Annotation>Create specific population for cells of cell type ct1 such that populations are "well-mixed".</Annotation>
            <Cell name="1" id="1">
                <Center>44.2692 47.6346 0</Center>
                <Nodes>44 43 0;43 44 0;44 44 0;45 44 0;46 44 0;47 44 0;42 45 0;43 45 0;44 45 0;45 45 0;46 45 0;47 45 0;42 46 0;43 46 0;44 46 0;45 46 0;46 46 0;47 46 0;42 47 0;43 47 0;44 47 0;45 47 0;46 47 0;47 47 0;41 48 0;42 48 0;43 48 0;44 48 0;45 48 0;46 48 0;47 48 0;41 49 0;42 49 0;43 49 0;44 49 0;45 49 0;46 49 0;47 49 0;41 50 0;42 50 0;43 50 0;44 50 0;45 50 0;46 50 0;47 50 0;41 51 0;42 51 0;43 51 0;44 51 0;45 51 0;46 51 0;47 51 0</Nodes>
            </Cell>
            <Cell name="2" id="2">
                <Center>52.4615 67.75 0</Center>
                <Nodes>51 63 0;52 63 0;50 64 0;51 64 0;52 64 0;53 64 0;50 65 0;51 65 0;52 65 0;53 65 0;54 65 0;55 65 0;50 66 0;51 66 0;52 66 0;53 66 0;54 66 0;55 66 0;50 67 0;51 67 0;52 67 0;53 67 0;54 67 0;55 67 0;50 68 0;51 68 0;52 68 0;53 68 0;54 68 0;55 68 0;49 69 0;50 69 0;51 69 0;52 69 0;53 69 0;54 69 0;55 69 0;50 70 0;51 70 0;52 70 0;53 70 0;54 70 0;55 70 0;51 71 0;52 71 0;53 71 0;54 71 0;55 71 0;56 71 0;52 72 0;53 72 0;54 72 0</Nodes>
            </Cell>
            <Cell name="3" id="3">
                <Center>73.5849 53.0943 0</Center>
                <Nodes>73 49 0;74 49 0;75 49 0;72 50 0;73 50 0;74 50 0;75 50 0;76 50 0;71 51 0;72 51 0;73 51 0;74 51 0;75 51 0;76 51 0;71 52 0;72 52 0;73 52 0;74 52 0;75 52 0;76 52 0;77 52 0;78 52 0;71 53 0;72 53 0;73 53 0;74 53 0;75 53 0;76 53 0;77 53 0;78 53 0;71 54 0;72 54 0;73 54 0;74 54 0;75 54 0;76 54 0;77 54 0;70 55 0;71 55 0;72 55 0;73 55 0;74 55 0;75 55 0;76 55 0;70 56 0;71 56 0;72 56 0;73 56 0;74 56 0;70 57 0;71 57 0;72 57 0;73 57 0</Nodes>
            </Cell>
            <Cell name="4" id="4">
                <Center>38.6981 40.8868 0</Center>
                <Nodes>35 38 0;36 38 0;37 38 0;38 38 0;39 38 0;40 38 0;41 38 0;42 38 0;35 39 0;36 39 0;37 39 0;38 39 0;39 39 0;40 39 0;41 39 0;42 39 0;35 40 0;36 40 0;37 40 0;38 40 0;39 40 0;40 40 0;41 40 0;42 40 0;35 41 0;36 41 0;37 41 0;38 41 0;39 41 0;40 41 0;41 41 0;42 41 0;36 42 0;37 42 0;38 42 0;39 42 0;40 42 0;41 42 0;42 42 0;36 43 0;37 43 0;38 43 0;39 43 0;40 43 0;41 43 0;42 43 0;36 44 0;37 44 0;38 44 0;39 44 0;40 44 0;41 44 0;42 44 0</Nodes>
            </Cell>
            <Cell name="5" id="5">
                <Center>37.2885 55.2885 0</Center>
                <Nodes>38 51 0;35 52 0;36 52 0;37 52 0;38 52 0;39 52 0;40 52 0;34 53 0;35 53 0;36 53 0;37 53 0;38 53 0;39 53 0;40 53 0;34 54 0;35 54 0;36 54 0;37 54 0;38 54 0;39 54 0;40 54 0;34 55 0;35 55 0;36 55 0;37 55 0;38 55 0;39 55 0;40 55 0;35 56 0;36 56 0;37 56 0;38 56 0;39 56 0;40 56 0;34 57 0;35 57 0;36 57 0;37 57 0;38 57 0;39 57 0;40 57 0;35 58 0;36 58 0;37 58 0;38 58 0;39 58 0;40 58 0;36 59 0;37 59 0;38 59 0;39 59 0;40 59 0</Nodes>
            </Cell>
            <Cell name="6" id="6">
                <Center>30.5472 49.1132 0</Center>
                <Nodes>32 45 0;33 45 0;28 46 0;29 46 0;30 46 0;31 46 0;32 46 0;33 46 0;27 47 0;28 47 0;29 47 0;30 47 0;31 47 0;32 47 0;33 47 0;26 48 0;27 48 0;28 48 0;29 48 0;30 48 0;31 48 0;32 48 0;33 48 0;27 49 0;28 49 0;29 49 0;30 49 0;31 49 0;32 49 0;33 49 0;28 50 0;29 50 0;30 50 0;31 50 0;32 50 0;33 50 0;28 51 0;29 51 0;30 51 0;31 51 0;32 51 0;33 51 0;34 51 0;29 52 0;30 52 0;31 52 0;32 52 0;33 52 0;34 52 0;30 53 0;31 53 0;32 53 0;33 53 0</Nodes>
            </Cell>
            <Cell name="7" id="7">
                <Center>61.0943 33.8113 0</Center>
                <Nodes>57 31 0;58 31 0;59 31 0;60 31 0;61 31 0;62 31 0;63 31 0;57 32 0;58 32 0;59 32 0;60 32 0;61 32 0;62 32 0;63 32 0;64 32 0;65 32 0;57 33 0;58 33 0;59 33 0;60 33 0;61 33 0;62 33 0;63 33 0;64 33 0;57 34 0;58 34 0;59 34 0;60 34 0;61 34 0;62 34 0;63 34 0;64 34 0;65 34 0;58 35 0;59 35 0;60 35 0;61 35 0;62 35 0;63 35 0;64 35 0;65 35 0;59 36 0;60 36 0;61 36 0;62 36 0;63 36 0;64 36 0;65 36 0;60 37 0;61 37 0;62 37 0;63 37 0;64 37 0</Nodes>
            </Cell>
            <Cell name="8" id="8">
                <Center>25.5283 40.8491 0</Center>
                <Nodes>25 36 0;26 36 0;27 36 0;24 37 0;25 37 0;26 37 0;27 37 0;24 38 0;25 38 0;26 38 0;27 38 0;28 38 0;23 39 0;24 39 0;25 39 0;26 39 0;27 39 0;28 39 0;23 40 0;24 40 0;25 40 0;26 40 0;27 40 0;28 40 0;23 41 0;24 41 0;25 41 0;26 41 0;27 41 0;28 41 0;23 42 0;24 42 0;25 42 0;26 42 0;27 42 0;28 42 0;23 43 0;24 43 0;25 43 0;26 43 0;27 43 0;28 43 0;23 44 0;24 44 0;25 44 0;26 44 0;27 44 0;28 44 0;23 45 0;24 45 0;25 45 0;26 45 0;27 45 0</Nodes>
            </Cell>
            <Cell name="9" id="9">
                <Center>38.3654 63.5192 0</Center>
                <Nodes>37 60 0;38 60 0;39 60 0;40 60 0;36 61 0;37 61 0;38 61 0;39 61 0;40 61 0;41 61 0;35 62 0;36 62 0;37 62 0;38 62 0;39 62 0;40 62 0;41 62 0;42 62 0;35 63 0;36 63 0;37 63 0;38 63 0;39 63 0;40 63 0;41 63 0;42 63 0;35 64 0;36 64 0;37 64 0;38 64 0;39 64 0;40 64 0;41 64 0;42 64 0;35 65 0;36 65 0;37 65 0;38 65 0;39 65 0;40 65 0;41 65 0;35 66 0;36 66 0;37 66 0;38 66 0;39 66 0;40 66 0;41 66 0;37 67 0;38 67 0;39 67 0;40 67 0</Nodes>
            </Cell>
            <Cell name="10" id="10">
                <Center>30.3333 65 0</Center>
                <Nodes>28 62 0;29 62 0;30 62 0;31 62 0;32 62 0;33 62 0;34 62 0;27 63 0;28 63 0;29 63 0;30 63 0;31 63 0;32 63 0;33 63 0;34 63 0;27 64 0;28 64 0;29 64 0;30 64 0;31 64 0;32 64 0;33 64 0;34 64 0;26 65 0;27 65 0;28 65 0;29 65 0;30 65 0;31 65 0;32 65 0;33 65 0;34 65 0;27 66 0;28 66 0;29 66 0;30 66 0;31 66 0;32 66 0;33 66 0;34 66 0;27 67 0;28 67 0;29 67 0;30 67 0;31 67 0;32 67 0;33 67 0;28 68 0;29 68 0;30 68 0;31 68 0;32 68 0;29 69 0;30 69 0</Nodes>
            </Cell>
            <Cell name="11" id="11">
                <Center>49.2642 82.0377 0</Center>
                <Nodes>47 79 0;48 79 0;49 79 0;50 79 0;51 79 0;52 79 0;46 80 0;47 80 0;48 80 0;49 80 0;50 80 0;51 80 0;52 80 0;53 80 0;46 81 0;47 81 0;48 81 0;49 81 0;50 81 0;51 81 0;52 81 0;53 81 0;45 82 0;46 82 0;47 82 0;48 82 0;49 82 0;50 82 0;51 82 0;52 82 0;53 82 0;45 83 0;46 83 0;47 83 0;48 83 0;49 83 0;50 83 0;51 83 0;52 83 0;53 83 0;47 84 0;48 84 0;49 84 0;50 84 0;51 84 0;52 84 0;47 85 0;48 85 0;49 85 0;50 85 0;51 85 0;48 86 0;50 86 0</Nodes>
            </Cell>
            <Cell name="12" id="12">
                <Center>60.2692 73.6538 0</Center>
                <Nodes>59 70 0;60 70 0;61 70 0;62 70 0;63 70 0;57 71 0;58 71 0;59 71 0;60 71 0;61 71 0;62 71 0;63 71 0;57 72 0;58 72 0;59 72 0;60 72 0;61 72 0;62 72 0;63 72 0;57 73 0;58 73 0;59 73 0;60 73 0;61 73 0;62 73 0;63 73 0;58 74 0;59 74 0;60 74 0;61 74 0;62 74 0;63 74 0;57 75 0;58 75 0;59 75 0;60 75 0;61 75 0;62 75 0;63 75 0;58 76 0;59 76 0;60 76 0;61 76 0;62 76 0;63 76 0;59 77 0;60 77 0;61 77 0;62 77 0;60 78 0;61 78 0;60 79 0</Nodes>
            </Cell>
            <Cell name="13" id="13">
                <Center>48 74.6604 0</Center>
                <Nodes>47 71 0;48 71 0;49 71 0;50 71 0;46 72 0;47 72 0;48 72 0;49 72 0;50 72 0;51 72 0;44 73 0;45 73 0;46 73 0;47 73 0;48 73 0;49 73 0;50 73 0;51 73 0;45 74 0;46 74 0;47 74 0;48 74 0;49 74 0;50 74 0;51 74 0;44 75 0;45 75 0;46 75 0;47 75 0;48 75 0;49 75 0;50 75 0;51 75 0;45 76 0;46 76 0;47 76 0;48 76 0;49 76 0;50 76 0;51 76 0;45 77 0;46 77 0;47 77 0;48 77 0;49 77 0;50 77 0;51 77 0;46 78 0;47 78 0;48 78 0;49 78 0;50 78 0;51 78 0</Nodes>
            </Cell>
            <Cell name="14" id="14">
                <Center>39.6792 72.3208 0</Center>
                <Nodes>37 68 0;38 68 0;39 68 0;37 69 0;38 69 0;39 69 0;40 69 0;37 70 0;38 70 0;39 70 0;40 70 0;41 70 0;42 70 0;37 71 0;38 71 0;39 71 0;40 71 0;41 71 0;42 71 0;43 71 0;37 72 0;38 72 0;39 72 0;40 72 0;41 72 0;42 72 0;43 72 0;37 73 0;38 73 0;39 73 0;40 73 0;41 73 0;42 73 0;43 73 0;37 74 0;38 74 0;39 74 0;40 74 0;41 74 0;42 74 0;43 74 0;44 74 0;37 75 0;38 75 0;39 75 0;40 75 0;41 75 0;42 75 0;43 75 0;37 76 0;38 76 0;39 76 0;40 76 0</Nodes>
            </Cell>
            <Cell name="15" id="15">
                <Center>44.8654 30.4615 0</Center>
                <Nodes>43 27 0;44 27 0;43 28 0;44 28 0;45 28 0;46 28 0;47 28 0;48 28 0;49 28 0;41 29 0;42 29 0;43 29 0;44 29 0;45 29 0;46 29 0;47 29 0;48 29 0;49 29 0;40 30 0;41 30 0;42 30 0;43 30 0;44 30 0;45 30 0;46 30 0;47 30 0;48 30 0;49 30 0;41 31 0;42 31 0;43 31 0;44 31 0;45 31 0;46 31 0;47 31 0;48 31 0;42 32 0;43 32 0;44 32 0;45 32 0;46 32 0;47 32 0;48 32 0;43 33 0;44 33 0;45 33 0;46 33 0;47 33 0;43 34 0;44 34 0;45 34 0;46 34 0</Nodes>
            </Cell>
            <Cell name="16" id="16">
                <Center>25.0943 57.0943 0</Center>
                <Nodes>24 53 0;25 53 0;26 53 0;27 53 0;23 54 0;24 54 0;25 54 0;26 54 0;27 54 0;28 54 0;23 55 0;24 55 0;25 55 0;26 55 0;27 55 0;28 55 0;23 56 0;24 56 0;25 56 0;26 56 0;27 56 0;28 56 0;22 57 0;23 57 0;24 57 0;25 57 0;26 57 0;27 57 0;28 57 0;22 58 0;23 58 0;24 58 0;25 58 0;26 58 0;27 58 0;28 58 0;22 59 0;23 59 0;24 59 0;25 59 0;26 59 0;27 59 0;22 60 0;23 60 0;24 60 0;25 60 0;26 60 0;27 60 0;23 61 0;24 61 0;25 61 0;26 61 0;27 61 0</Nodes>
            </Cell>
            <Cell name="17" id="17">
                <Center>46.7547 61.3585 0</Center>
                <Nodes>46 58 0;47 58 0;48 58 0;49 58 0;50 58 0;45 59 0;46 59 0;47 59 0;48 59 0;49 59 0;50 59 0;43 60 0;44 60 0;45 60 0;46 60 0;47 60 0;48 60 0;49 60 0;50 60 0;42 61 0;43 61 0;44 61 0;45 61 0;46 61 0;47 61 0;48 61 0;49 61 0;50 61 0;43 62 0;44 62 0;45 62 0;46 62 0;47 62 0;48 62 0;49 62 0;50 62 0;43 63 0;44 63 0;45 63 0;46 63 0;47 63 0;48 63 0;49 63 0;50 63 0;44 64 0;45 64 0;46 64 0;47 64 0;48 64 0;49 64 0;47 65 0;48 65 0;49 65 0</Nodes>
            </Cell>
            <Cell name="18" id="18">
                <Center>58.9434 46.7736 0</Center>
                <Nodes>59 43 0;55 44 0;56 44 0;57 44 0;58 44 0;59 44 0;60 44 0;55 45 0;56 45 0;57 45 0;58 45 0;59 45 0;60 45 0;61 45 0;55 46 0;56 46 0;57 46 0;58 46 0;59 46 0;60 46 0;61 46 0;62 46 0;63 46 0;64 46 0;55 47 0;56 47 0;57 47 0;58 47 0;59 47 0;60 47 0;61 47 0;62 47 0;63 47 0;55 48 0;56 48 0;57 48 0;58 48 0;59 48 0;60 48 0;61 48 0;62 48 0;63 48 0;55 49 0;56 49 0;58 49 0;59 49 0;60 49 0;61 49 0;62 49 0;63 49 0;60 50 0;61 50 0;62 50 0</Nodes>
            </Cell>
            <Cell name="19" id="19">
                <Center>61.8679 60.9057 0</Center>
                <Nodes>58 58 0;59 58 0;60 58 0;61 58 0;62 58 0;63 58 0;64 58 0;65 58 0;58 59 0;59 59 0;60 59 0;61 59 0;62 59 0;63 59 0;64 59 0;65 59 0;58 60 0;59 60 0;60 60 0;61 60 0;62 60 0;63 60 0;64 60 0;65 60 0;58 61 0;59 61 0;60 61 0;61 61 0;62 61 0;63 61 0;64 61 0;65 61 0;58 62 0;59 62 0;60 62 0;61 62 0;62 62 0;63 62 0;64 62 0;65 62 0;60 63 0;61 63 0;62 63 0;63 63 0;64 63 0;65 63 0;61 64 0;62 64 0;63 64 0;64 64 0;65 64 0;64 65 0;65 65 0</Nodes>
            </Cell>
            <Cell name="20" id="20">
                <Center>34.9434 80.566 0</Center>
                <Nodes>35 77 0;36 77 0;37 77 0;31 78 0;32 78 0;33 78 0;34 78 0;35 78 0;36 78 0;37 78 0;38 78 0;31 79 0;32 79 0;33 79 0;34 79 0;35 79 0;36 79 0;37 79 0;38 79 0;31 80 0;32 80 0;33 80 0;34 80 0;35 80 0;36 80 0;37 80 0;38 80 0;32 81 0;33 81 0;34 81 0;35 81 0;36 81 0;37 81 0;38 81 0;32 82 0;33 82 0;34 82 0;35 82 0;36 82 0;37 82 0;38 82 0;33 83 0;34 83 0;35 83 0;36 83 0;37 83 0;38 83 0;33 84 0;34 84 0;35 84 0;36 84 0;37 84 0;38 84 0</Nodes>
            </Cell>
            <Cell name="21" id="21">
                <Center>50.6792 37.566 0</Center>
                <Nodes>48 33 0;49 33 0;50 33 0;51 33 0;48 34 0;49 34 0;50 34 0;51 34 0;52 34 0;48 35 0;49 35 0;50 35 0;51 35 0;52 35 0;53 35 0;48 36 0;49 36 0;50 36 0;51 36 0;52 36 0;53 36 0;48 37 0;49 37 0;50 37 0;51 37 0;52 37 0;53 37 0;49 38 0;50 38 0;51 38 0;52 38 0;53 38 0;49 39 0;50 39 0;51 39 0;52 39 0;53 39 0;49 40 0;50 40 0;51 40 0;52 40 0;53 40 0;49 41 0;50 41 0;51 41 0;52 41 0;53 41 0;54 41 0;49 42 0;50 42 0;51 42 0;52 42 0;53 42 0</Nodes>
            </Cell>
            <Cell name="22" id="22">
                <Center>30.8491 32.0189 0</Center>
                <Nodes>29 28 0;30 28 0;31 28 0;32 28 0;29 29 0;30 29 0;31 29 0;32 29 0;33 29 0;28 30 0;29 30 0;30 30 0;31 30 0;32 30 0;33 30 0;34 30 0;29 31 0;30 31 0;31 31 0;32 31 0;33 31 0;34 31 0;35 31 0;28 32 0;29 32 0;30 32 0;31 32 0;32 32 0;33 32 0;34 32 0;27 33 0;28 33 0;29 33 0;30 33 0;31 33 0;32 33 0;33 33 0;28 34 0;29 34 0;30 34 0;31 34 0;32 34 0;33 34 0;28 35 0;29 35 0;30 35 0;31 35 0;32 35 0;33 35 0;29 36 0;30 36 0;32 36 0;33 36 0</Nodes>
            </Cell>
            <Cell name="23" id="23">
                <Center>70.7736 41.4906 0</Center>
                <Nodes>68 38 0;69 38 0;70 38 0;71 38 0;72 38 0;68 39 0;69 39 0;70 39 0;71 39 0;72 39 0;73 39 0;68 40 0;69 40 0;70 40 0;71 40 0;72 40 0;73 40 0;74 40 0;68 41 0;69 41 0;70 41 0;71 41 0;72 41 0;73 41 0;74 41 0;67 42 0;68 42 0;69 42 0;70 42 0;71 42 0;72 42 0;73 42 0;74 42 0;75 42 0;67 43 0;68 43 0;69 43 0;70 43 0;71 43 0;72 43 0;73 43 0;74 43 0;75 43 0;67 44 0;68 44 0;69 44 0;70 44 0;71 44 0;72 44 0;73 44 0;71 45 0;72 45 0;73 45 0</Nodes>
            </Cell>
            <Cell name="24" id="24">
                <Center>28.4231 73.8269 0</Center>
                <Nodes>28 69 0;26 70 0;27 70 0;28 70 0;29 70 0;30 70 0;26 71 0;27 71 0;28 71 0;29 71 0;30 71 0;31 71 0;26 72 0;27 72 0;28 72 0;29 72 0;30 72 0;31 72 0;26 73 0;27 73 0;28 73 0;29 73 0;30 73 0;31 73 0;26 74 0;27 74 0;28 74 0;29 74 0;30 74 0;31 74 0;26 75 0;27 75 0;28 75 0;29 75 0;30 75 0;31 75 0;26 76 0;27 76 0;28 76 0;29 76 0;30 76 0;31 76 0;26 77 0;27 77 0;28 77 0;29 77 0;30 77 0;31 77 0;26 78 0;28 78 0;29 78 0;30 78 0</Nodes>
            </Cell>
            <Cell name="25" id="25">
                <Center>51.5472 53.3019 0</Center>
                <Nodes>51 50 0;52 50 0;53 50 0;54 50 0;55 50 0;49 51 0;50 51 0;51 51 0;52 51 0;53 51 0;54 51 0;55 51 0;48 52 0;49 52 0;50 52 0;51 52 0;52 52 0;53 52 0;54 52 0;55 52 0;48 53 0;49 53 0;50 53 0;51 53 0;52 53 0;53 53 0;54 53 0;55 53 0;48 54 0;49 54 0;50 54 0;51 54 0;52 54 0;53 54 0;54 54 0;55 54 0;48 55 0;49 55 0;50 55 0;51 55 0;52 55 0;53 55 0;54 55 0;55 55 0;48 56 0;49 56 0;50 56 0;51 56 0;52 56 0;53 56 0;55 56 0;48 57 0;49 57 0</Nodes>
            </Cell>
        </Population>
        <Population size="25" type="ct2">
            <Annotation>Create specific population for cells of cell type ct2 such that populations are "well-mixed".</Annotation>
            <Cell name="26" id="26">
                <Center>45.283 38.9057 0</Center>
                <Nodes>47 34 0;43 35 0;44 35 0;45 35 0;46 35 0;47 35 0;42 36 0;43 36 0;44 36 0;45 36 0;46 36 0;47 36 0;42 37 0;43 37 0;44 37 0;45 37 0;46 37 0;47 37 0;43 38 0;44 38 0;45 38 0;46 38 0;47 38 0;48 38 0;43 39 0;44 39 0;45 39 0;46 39 0;47 39 0;48 39 0;43 40 0;44 40 0;45 40 0;46 40 0;47 40 0;48 40 0;43 41 0;44 41 0;45 41 0;46 41 0;47 41 0;48 41 0;43 42 0;44 42 0;45 42 0;46 42 0;47 42 0;48 42 0;43 43 0;45 43 0;46 43 0;47 43 0;48 43 0</Nodes>
            </Cell>
            <Cell name="27" id="27">
                <Center>54.0769 59.9808 0</Center>
                <Nodes>54 56 0;50 57 0;51 57 0;52 57 0;53 57 0;54 57 0;55 57 0;56 57 0;57 57 0;51 58 0;52 58 0;53 58 0;54 58 0;55 58 0;56 58 0;57 58 0;51 59 0;52 59 0;53 59 0;54 59 0;55 59 0;56 59 0;57 59 0;51 60 0;52 60 0;53 60 0;54 60 0;55 60 0;56 60 0;57 60 0;51 61 0;52 61 0;53 61 0;54 61 0;55 61 0;56 61 0;57 61 0;51 62 0;52 62 0;53 62 0;54 62 0;55 62 0;56 62 0;57 62 0;53 63 0;54 63 0;55 63 0;56 63 0;57 63 0;54 64 0;55 64 0;56 64 0</Nodes>
            </Cell>
            <Cell name="28" id="28">
                <Center>54.9815 76.7593 0</Center>
                <Nodes>55 72 0;56 72 0;52 73 0;53 73 0;54 73 0;55 73 0;56 73 0;52 74 0;53 74 0;54 74 0;55 74 0;56 74 0;57 74 0;52 75 0;53 75 0;54 75 0;55 75 0;56 75 0;52 76 0;53 76 0;54 76 0;55 76 0;56 76 0;57 76 0;52 77 0;53 77 0;54 77 0;55 77 0;56 77 0;57 77 0;58 77 0;52 78 0;53 78 0;54 78 0;55 78 0;56 78 0;57 78 0;58 78 0;59 78 0;53 79 0;54 79 0;55 79 0;56 79 0;57 79 0;58 79 0;54 80 0;55 80 0;56 80 0;57 80 0;58 80 0;54 81 0;55 81 0;56 81 0;57 81 0</Nodes>
            </Cell>
            <Cell name="29" id="29">
                <Center>37.717 26.9811 0</Center>
                <Nodes>40 23 0;37 24 0;38 24 0;39 24 0;40 24 0;41 24 0;34 25 0;35 25 0;36 25 0;37 25 0;38 25 0;39 25 0;40 25 0;41 25 0;34 26 0;35 26 0;36 26 0;37 26 0;38 26 0;39 26 0;40 26 0;41 26 0;34 27 0;35 27 0;36 27 0;37 27 0;38 27 0;39 27 0;40 27 0;41 27 0;42 27 0;34 28 0;35 28 0;36 28 0;37 28 0;38 28 0;39 28 0;40 28 0;41 28 0;42 28 0;34 29 0;35 29 0;36 29 0;37 29 0;38 29 0;39 29 0;40 29 0;35 30 0;36 30 0;37 30 0;38 30 0;39 30 0;36 31 0</Nodes>
            </Cell>
            <Cell name="30" id="30">
                <Center>37.2353 47.6863 0</Center>
                <Nodes>35 44 0;34 45 0;35 45 0;36 45 0;37 45 0;38 45 0;39 45 0;40 45 0;41 45 0;34 46 0;35 46 0;36 46 0;37 46 0;38 46 0;39 46 0;40 46 0;41 46 0;34 47 0;35 47 0;36 47 0;37 47 0;38 47 0;39 47 0;40 47 0;41 47 0;34 48 0;35 48 0;36 48 0;37 48 0;38 48 0;39 48 0;40 48 0;34 49 0;35 49 0;36 49 0;37 49 0;38 49 0;39 49 0;40 49 0;34 50 0;35 50 0;36 50 0;37 50 0;38 50 0;39 50 0;40 50 0;35 51 0;36 51 0;37 51 0;39 51 0;40 51 0</Nodes>
            </Cell>
            <Cell name="31" id="31">
                <Center>69.6731 34.2692 0</Center>
                <Nodes>69 31 0;70 31 0;66 32 0;67 32 0;68 32 0;69 32 0;70 32 0;71 32 0;72 32 0;73 32 0;65 33 0;66 33 0;67 33 0;68 33 0;69 33 0;70 33 0;71 33 0;72 33 0;73 33 0;66 34 0;67 34 0;68 34 0;69 34 0;70 34 0;71 34 0;72 34 0;73 34 0;74 34 0;66 35 0;67 35 0;68 35 0;69 35 0;70 35 0;71 35 0;72 35 0;73 35 0;74 35 0;66 36 0;67 36 0;68 36 0;69 36 0;70 36 0;71 36 0;72 36 0;73 36 0;74 36 0;67 37 0;68 37 0;69 37 0;70 37 0;71 37 0;72 37 0</Nodes>
            </Cell>
            <Cell name="32" id="32">
                <Center>41.8654 79.5769 0</Center>
                <Nodes>41 76 0;42 76 0;43 76 0;44 76 0;38 77 0;39 77 0;40 77 0;41 77 0;42 77 0;43 77 0;44 77 0;39 78 0;40 78 0;41 78 0;42 78 0;43 78 0;44 78 0;45 78 0;39 79 0;40 79 0;41 79 0;42 79 0;43 79 0;44 79 0;45 79 0;46 79 0;39 80 0;40 80 0;41 80 0;42 80 0;43 80 0;44 80 0;45 80 0;39 81 0;40 81 0;41 81 0;42 81 0;43 81 0;44 81 0;45 81 0;39 82 0;40 82 0;41 82 0;42 82 0;43 82 0;44 82 0;39 83 0;40 83 0;41 83 0;42 83 0;43 83 0;44 83 0</Nodes>
            </Cell>
            <Cell name="33" id="33">
                <Center>63.7736 41.0755 0</Center>
                <Nodes>65 37 0;66 37 0;61 38 0;62 38 0;63 38 0;64 38 0;65 38 0;66 38 0;67 38 0;61 39 0;62 39 0;63 39 0;64 39 0;65 39 0;66 39 0;67 39 0;61 40 0;62 40 0;63 40 0;64 40 0;65 40 0;66 40 0;67 40 0;61 41 0;62 41 0;63 41 0;64 41 0;65 41 0;66 41 0;67 41 0;61 42 0;62 42 0;63 42 0;64 42 0;65 42 0;66 42 0;60 43 0;61 43 0;62 43 0;63 43 0;64 43 0;65 43 0;66 43 0;61 44 0;62 44 0;63 44 0;64 44 0;65 44 0;66 44 0;62 45 0;63 45 0;64 45 0;65 45 0</Nodes>
            </Cell>
            <Cell name="34" id="34">
                <Center>33.9231 71.9808 0</Center>
                <Nodes>34 67 0;35 67 0;36 67 0;33 68 0;34 68 0;35 68 0;36 68 0;31 69 0;32 69 0;33 69 0;34 69 0;35 69 0;36 69 0;31 70 0;32 70 0;33 70 0;34 70 0;35 70 0;36 70 0;32 71 0;33 71 0;34 71 0;35 71 0;36 71 0;32 72 0;33 72 0;34 72 0;35 72 0;36 72 0;32 73 0;33 73 0;34 73 0;35 73 0;36 73 0;32 74 0;33 74 0;34 74 0;35 74 0;36 74 0;32 75 0;33 75 0;34 75 0;35 75 0;36 75 0;32 76 0;33 76 0;34 76 0;35 76 0;36 76 0;32 77 0;33 77 0;34 77 0</Nodes>
            </Cell>
            <Cell name="35" id="35">
                <Center>52.8269 30.3077 0</Center>
                <Nodes>52 26 0;53 26 0;50 27 0;51 27 0;52 27 0;53 27 0;54 27 0;55 27 0;50 28 0;51 28 0;52 28 0;53 28 0;54 28 0;55 28 0;50 29 0;51 29 0;52 29 0;53 29 0;54 29 0;55 29 0;50 30 0;51 30 0;52 30 0;53 30 0;54 30 0;55 30 0;49 31 0;50 31 0;51 31 0;52 31 0;53 31 0;54 31 0;55 31 0;56 31 0;49 32 0;50 32 0;51 32 0;52 32 0;53 32 0;54 32 0;55 32 0;56 32 0;52 33 0;53 33 0;54 33 0;55 33 0;56 33 0;53 34 0;54 34 0;55 34 0;56 34 0;54 35 0</Nodes>
            </Cell>
            <Cell name="36" id="36">
                <Center>44.8868 67.9057 0</Center>
                <Nodes>43 64 0;42 65 0;43 65 0;44 65 0;45 65 0;46 65 0;42 66 0;43 66 0;44 66 0;45 66 0;46 66 0;47 66 0;48 66 0;49 66 0;41 67 0;42 67 0;43 67 0;44 67 0;45 67 0;46 67 0;47 67 0;48 67 0;49 67 0;40 68 0;41 68 0;42 68 0;43 68 0;44 68 0;45 68 0;46 68 0;47 68 0;48 68 0;49 68 0;41 69 0;42 69 0;43 69 0;44 69 0;45 69 0;46 69 0;47 69 0;48 69 0;43 70 0;44 70 0;45 70 0;46 70 0;47 70 0;48 70 0;49 70 0;44 71 0;45 71 0;46 71 0;44 72 0;45 72 0</Nodes>
            </Cell>
            <Cell name="37" id="37">
                <Center>37.9623 34.2075 0</Center>
                <Nodes>37 31 0;38 31 0;39 31 0;40 31 0;35 32 0;36 32 0;37 32 0;38 32 0;39 32 0;40 32 0;41 32 0;34 33 0;35 33 0;36 33 0;37 33 0;38 33 0;39 33 0;40 33 0;41 33 0;42 33 0;34 34 0;35 34 0;36 34 0;37 34 0;38 34 0;39 34 0;40 34 0;41 34 0;42 34 0;34 35 0;35 35 0;36 35 0;37 35 0;38 35 0;39 35 0;40 35 0;41 35 0;42 35 0;34 36 0;35 36 0;36 36 0;37 36 0;38 36 0;39 36 0;40 36 0;41 36 0;35 37 0;36 37 0;37 37 0;38 37 0;39 37 0;40 37 0;41 37 0</Nodes>
            </Cell>
            <Cell name="38" id="38">
                <Center>58.9423 53.4808 0</Center>
                <Nodes>57 49 0;56 50 0;57 50 0;58 50 0;59 50 0;56 51 0;57 51 0;58 51 0;59 51 0;60 51 0;61 51 0;62 51 0;56 52 0;57 52 0;58 52 0;59 52 0;60 52 0;61 52 0;62 52 0;56 53 0;57 53 0;58 53 0;59 53 0;60 53 0;61 53 0;62 53 0;56 54 0;57 54 0;58 54 0;59 54 0;60 54 0;61 54 0;62 54 0;56 55 0;57 55 0;58 55 0;59 55 0;60 55 0;61 55 0;62 55 0;56 56 0;57 56 0;58 56 0;59 56 0;60 56 0;61 56 0;62 56 0;58 57 0;59 57 0;60 57 0;61 57 0;62 57 0</Nodes>
            </Cell>
            <Cell name="39" id="39">
                <Center>68.4151 47.7925 0</Center>
                <Nodes>66 45 0;67 45 0;68 45 0;69 45 0;70 45 0;65 46 0;66 46 0;67 46 0;68 46 0;69 46 0;70 46 0;71 46 0;72 46 0;73 46 0;64 47 0;65 47 0;66 47 0;67 47 0;68 47 0;69 47 0;70 47 0;71 47 0;72 47 0;73 47 0;64 48 0;65 48 0;66 48 0;67 48 0;68 48 0;69 48 0;70 48 0;71 48 0;72 48 0;73 48 0;64 49 0;65 49 0;66 49 0;67 49 0;68 49 0;69 49 0;70 49 0;71 49 0;72 49 0;65 50 0;66 50 0;67 50 0;68 50 0;69 50 0;70 50 0;71 50 0;68 51 0;69 51 0;70 51 0</Nodes>
            </Cell>
            <Cell name="40" id="40">
                <Center>46.0577 23.9423 0</Center>
                <Nodes>44 21 0;45 21 0;46 21 0;47 21 0;49 21 0;43 22 0;44 22 0;45 22 0;46 22 0;47 22 0;48 22 0;49 22 0;50 22 0;42 23 0;43 23 0;44 23 0;45 23 0;46 23 0;47 23 0;48 23 0;49 23 0;50 23 0;42 24 0;43 24 0;44 24 0;45 24 0;46 24 0;47 24 0;48 24 0;49 24 0;50 24 0;42 25 0;43 25 0;44 25 0;45 25 0;46 25 0;47 25 0;48 25 0;49 25 0;50 25 0;42 26 0;43 26 0;44 26 0;45 26 0;46 26 0;47 26 0;48 26 0;49 26 0;45 27 0;46 27 0;47 27 0;48 27 0</Nodes>
            </Cell>
            <Cell name="41" id="41">
                <Center>50.8846 46.3846 0</Center>
                <Nodes>49 43 0;50 43 0;51 43 0;52 43 0;53 43 0;54 43 0;48 44 0;49 44 0;50 44 0;51 44 0;52 44 0;53 44 0;54 44 0;48 45 0;49 45 0;50 45 0;51 45 0;52 45 0;53 45 0;54 45 0;48 46 0;49 46 0;50 46 0;51 46 0;52 46 0;53 46 0;54 46 0;48 47 0;49 47 0;50 47 0;51 47 0;52 47 0;53 47 0;54 47 0;48 48 0;49 48 0;50 48 0;51 48 0;52 48 0;53 48 0;54 48 0;48 49 0;49 49 0;50 49 0;51 49 0;52 49 0;53 49 0;54 49 0;48 50 0;49 50 0;50 50 0;48 51 0</Nodes>
            </Cell>
            <Cell name="42" id="42">
                <Center>69.1887 61.1509 0</Center>
                <Nodes>66 58 0;67 58 0;68 58 0;69 58 0;70 58 0;71 58 0;72 58 0;66 59 0;67 59 0;68 59 0;69 59 0;70 59 0;71 59 0;72 59 0;66 60 0;67 60 0;68 60 0;69 60 0;70 60 0;71 60 0;72 60 0;66 61 0;67 61 0;68 61 0;69 61 0;70 61 0;71 61 0;72 61 0;73 61 0;66 62 0;67 62 0;68 62 0;69 62 0;70 62 0;71 62 0;72 62 0;73 62 0;66 63 0;67 63 0;68 63 0;69 63 0;70 63 0;71 63 0;72 63 0;73 63 0;66 64 0;67 64 0;68 64 0;69 64 0;70 64 0;71 64 0;69 65 0;70 65 0</Nodes>
            </Cell>
            <Cell name="43" id="43">
                <Center>77.3396 57.8113 0</Center>
                <Nodes>78 54 0;79 54 0;80 54 0;77 55 0;78 55 0;79 55 0;80 55 0;81 55 0;75 56 0;76 56 0;77 56 0;78 56 0;79 56 0;80 56 0;81 56 0;74 57 0;75 57 0;76 57 0;77 57 0;78 57 0;79 57 0;80 57 0;81 57 0;73 58 0;74 58 0;75 58 0;76 58 0;77 58 0;78 58 0;79 58 0;80 58 0;81 58 0;73 59 0;74 59 0;75 59 0;76 59 0;77 59 0;78 59 0;79 59 0;80 59 0;81 59 0;73 60 0;74 60 0;75 60 0;76 60 0;77 60 0;78 60 0;79 60 0;75 61 0;76 61 0;77 61 0;78 61 0;77 62 0</Nodes>
            </Cell>
            <Cell name="44" id="44">
                <Center>31.4423 57.9615 0</Center>
                <Nodes>29 54 0;30 54 0;31 54 0;32 54 0;33 54 0;29 55 0;30 55 0;31 55 0;32 55 0;33 55 0;29 56 0;30 56 0;31 56 0;32 56 0;33 56 0;34 56 0;29 57 0;30 57 0;31 57 0;32 57 0;33 57 0;29 58 0;30 58 0;31 58 0;32 58 0;33 58 0;34 58 0;28 59 0;29 59 0;30 59 0;31 59 0;32 59 0;33 59 0;34 59 0;35 59 0;28 60 0;29 60 0;30 60 0;31 60 0;32 60 0;33 60 0;34 60 0;35 60 0;36 60 0;28 61 0;29 61 0;30 61 0;31 61 0;32 61 0;33 61 0;34 61 0;35 61 0</Nodes>
            </Cell>
            <Cell name="45" id="45">
                <Center>77.6415 46.9057 0</Center>
                <Nodes>77 43 0;74 44 0;75 44 0;76 44 0;77 44 0;78 44 0;79 44 0;80 44 0;74 45 0;75 45 0;76 45 0;77 45 0;78 45 0;79 45 0;80 45 0;81 45 0;74 46 0;75 46 0;76 46 0;77 46 0;78 46 0;79 46 0;80 46 0;81 46 0;74 47 0;75 47 0;76 47 0;77 47 0;78 47 0;79 47 0;80 47 0;81 47 0;74 48 0;75 48 0;76 48 0;77 48 0;78 48 0;79 48 0;80 48 0;81 48 0;76 49 0;77 49 0;78 49 0;79 49 0;80 49 0;81 49 0;77 50 0;78 50 0;79 50 0;80 50 0;77 51 0;78 51 0;79 51 0</Nodes>
            </Cell>
            <Cell name="46" id="46">
                <Center>43.6981 55.3774 0</Center>
                <Nodes>41 52 0;42 52 0;43 52 0;44 52 0;45 52 0;46 52 0;47 52 0;41 53 0;42 53 0;43 53 0;44 53 0;45 53 0;46 53 0;47 53 0;41 54 0;42 54 0;43 54 0;44 54 0;45 54 0;46 54 0;47 54 0;41 55 0;42 55 0;43 55 0;44 55 0;45 55 0;46 55 0;47 55 0;41 56 0;42 56 0;43 56 0;44 56 0;45 56 0;46 56 0;47 56 0;41 57 0;42 57 0;43 57 0;44 57 0;45 57 0;46 57 0;47 57 0;41 58 0;42 58 0;43 58 0;44 58 0;45 58 0;41 59 0;42 59 0;43 59 0;44 59 0;41 60 0;42 60 0</Nodes>
            </Cell>
            <Cell name="47" id="47">
                <Center>59.5 66.7885 0</Center>
                <Nodes>58 63 0;59 63 0;57 64 0;58 64 0;59 64 0;60 64 0;56 65 0;57 65 0;58 65 0;59 65 0;60 65 0;61 65 0;62 65 0;63 65 0;56 66 0;57 66 0;58 66 0;59 66 0;60 66 0;61 66 0;62 66 0;63 66 0;64 66 0;56 67 0;57 67 0;58 67 0;59 67 0;60 67 0;61 67 0;62 67 0;63 67 0;64 67 0;56 68 0;57 68 0;58 68 0;59 68 0;60 68 0;61 68 0;62 68 0;63 68 0;64 68 0;56 69 0;57 69 0;58 69 0;59 69 0;60 69 0;61 69 0;62 69 0;63 69 0;56 70 0;57 70 0;58 70 0</Nodes>
            </Cell>
            <Cell name="48" id="48">
                <Center>31.5849 40.8113 0</Center>
                <Nodes>31 36 0;30 37 0;31 37 0;32 37 0;33 37 0;34 37 0;29 38 0;30 38 0;31 38 0;32 38 0;33 38 0;34 38 0;29 39 0;30 39 0;31 39 0;32 39 0;33 39 0;34 39 0;29 40 0;30 40 0;31 40 0;32 40 0;33 40 0;34 40 0;29 41 0;30 41 0;31 41 0;32 41 0;33 41 0;34 41 0;29 42 0;30 42 0;31 42 0;32 42 0;33 42 0;34 42 0;35 42 0;29 43 0;30 43 0;31 43 0;32 43 0;33 43 0;34 43 0;35 43 0;29 44 0;30 44 0;31 44 0;32 44 0;33 44 0;34 44 0;29 45 0;30 45 0;31 45 0</Nodes>
            </Cell>
            <Cell name="49" id="49">
                <Center>56.8077 39.1923 0</Center>
                <Nodes>55 35 0;56 35 0;57 35 0;54 36 0;55 36 0;56 36 0;57 36 0;58 36 0;54 37 0;55 37 0;56 37 0;57 37 0;58 37 0;59 37 0;54 38 0;55 38 0;56 38 0;57 38 0;58 38 0;59 38 0;60 38 0;54 39 0;55 39 0;56 39 0;57 39 0;58 39 0;59 39 0;60 39 0;54 40 0;55 40 0;56 40 0;57 40 0;58 40 0;59 40 0;60 40 0;55 41 0;56 41 0;57 41 0;58 41 0;59 41 0;60 41 0;54 42 0;55 42 0;56 42 0;57 42 0;58 42 0;59 42 0;60 42 0;55 43 0;56 43 0;57 43 0;58 43 0</Nodes>
            </Cell>
            <Cell name="50" id="50">
                <Center>66.0385 53.9038 0</Center>
                <Nodes>63 50 0;64 50 0;63 51 0;64 51 0;65 51 0;66 51 0;67 51 0;63 52 0;64 52 0;65 52 0;66 52 0;67 52 0;68 52 0;69 52 0;70 52 0;63 53 0;64 53 0;65 53 0;66 53 0;67 53 0;68 53 0;69 53 0;70 53 0;63 54 0;64 54 0;65 54 0;66 54 0;67 54 0;68 54 0;69 54 0;70 54 0;63 55 0;64 55 0;65 55 0;66 55 0;67 55 0;68 55 0;69 55 0;63 56 0;64 56 0;65 56 0;66 56 0;67 56 0;68 56 0;69 56 0;63 57 0;64 57 0;65 57 0;66 57 0;67 57 0;68 57 0;69 57 0</Nodes>
            </Cell>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter tags="analysis" time-step="100">
            <Annotation>Plot cell populations, colored by cell type.</Annotation>
            <Terminal name="png" size="400 400 0"/>
            <Plot>
                <Cells value="cell.type"/>
            </Plot>
        </Gnuplotter>
        <Logger tags="analysis" time-step="100">
            <Annotation>Log change of "c" in cells of cell type ct1 over time.</Annotation>
            <Input>
                <!--    <Disabled>
        <Global/>
    </Disabled>
-->
                <Symbol symbol-ref="celltype.ct1.id"/>
                <Symbol symbol-ref="c"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
        </Logger>
        <ModelGraph format="dot" include-tags="#untagged,analysis,ct1,ct2,medium" reduced="false"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Mix and Sort/model.md
````markdown
![](model-graph.svg "Model Graph.")
````

## File: Contributed Examples/CPM/Mixed Cell Types/index.md
````markdown
---
MorpheusModelID: M2008

title: Mixed Cell Types

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true

tags:
- 2D
- Area
- Cell Shape
- Cellular Potts Model
- Contact
- CPM
- Interaction
- Interaction Cost
- Length
- LengthConstraint
- Medium
- Perimeter
- Shape
- Strength
- Surface
- SurfaceConstraint
- Volume
- VolumeConstraint

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> Simulations of four types of cells with different shapes to demonstrate how the combined target volume, surface area, and medium contact interaction determine the shape of the cell

## Introduction

By setting the volume, surface, and length constraints, a CPM simulation can produce a variety of cell shapes.

## Description

In this example, there are four cell types with preferred volumes <span title="//CellTypes/CellType/VolumeConstraint/@target">$`V_i`$</span> (area in 2D), surfaces <span title="//CellTypes/CellType/SurfaceConstraint/@target">$`S_i`$</span> (perimeter in 2D) and lengths <span title="//CellTypes/CellType/LengthConstraint/@target">$`L_i`$</span> set to values:

- <span title="//CellTypes/CellType[name='ct1']/VolumeConstraint/@target">$`V_1`$</span>&nbsp;$`= 2100`$, <span title="//CellTypes/CellType[name='ct1']/LengthConstraint/@target">$`L_1`$</span>&nbsp;$`= 120`$ (red);
- <span title="//CellTypes/CellType[name='ct2']/VolumeConstraint/@target">$`V_2`$</span>&nbsp;$`= 1800`$, <span title="//CellTypes/CellType[name='ct2']/SurfaceConstraint/@target">$`S_2`$</span>&nbsp;$`= 250`$ (yellow);
- <span title="//CellTypes/CellType[name='ct3']/VolumeConstraint/@target">$`V_3`$</span>&nbsp;$`= 1800`$, <span title="//CellTypes/CellType[name='ct4']/SurfaceConstraint/@target">$`S_3`$</span>&nbsp;$`= 100`$ (green);
- <span title="//CellTypes/CellType[name='ct4']/VolumeConstraint/@target">$`V_4`$</span>&nbsp;$`= 2250`$, <span title="//CellTypes/CellType[name='ct4']/SurfaceConstraint/@target">$`S_4`$</span>&nbsp;$`= 400`$ (blue).

The <span title="//CellTypes/CellType/*Constraint/@strength">`strength`</span>s of all constraints is the same <span title="//CellTypes/CellType/*Constraint/@strength">$`\lambda`$</span>&nbsp;$`= 1`$.

## Results

The cells have all been assigned a low <span title="//CPM/Interaction/Contact[@type1='ct*'][@type2='medium']">`Interaction`</span> cost with the medium and a higher <span title="//CPM/Interaction/Contact[@type1='ct*'][@type2='ct*']">`Interaction`</span> cost with one another. Hence, we see that all cells avoid coming into contact.

![](MorpheusCellShapes.png "The cells prefer not to touch one another in this simulation, where the interaction energy with the medium is lower than that of the cells with one another.")

<figure>
  ![](M2008_mixed-cell-types_movie.mp4)
  <figcaption>
    Simulation video of {{< model_quick_access "media/model/m2008/MixedCellTypes.xml" >}}
  </figcaption>
</figure>
````

## File: Contributed Examples/CPM/Mixed Cell Types/MixedCellTypes.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>MixedCellTypes</Title>
        <Details>Full title:		Mixed Cell Types
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		22.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2008
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Simulations of four types of cells with different shapes to demonstrate how the combined target volume, surface area, and medium contact interaction work to determine the shape of the cell. Cell properties are as follows:
Type ), M=contact with medium, V=target volume, L=target length, S=target surface, C = connectivity constraint. 1) M = 3, V = 2100, L = 120, C. 2) M = 2,  V = 1800, S = 250, C. 3) M = 2, V = 1800, S = 100, C. 4) M = 5, V = 2250, S = 400, C.</Details>
    </Description>
    <Global>
        <Variable symbol="boundary" name="Boundary length of CT1 with other cell types" value="0.0"/>
        <Constant symbol="b" value="0.0"/>
        <Constant symbol="b2" value="0.0"/>
    </Global>
    <Space>
        <SpaceSymbol symbol="l"/>
        <Lattice class="square">
            <Size symbol="size" value="500, 500, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="y"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </Lattice>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="500"/>
        <!--    <Disabled>
        <SaveInterval value="5e3"/>
    </Disabled>
-->
        <!--    <Disabled>
        <RandomSeed value="3362"/>
    </Disabled>
-->
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="ct1">
            <VolumeConstraint target="2100" strength="1"/>
            <LengthConstraint target="120" strength="1" mode="length"/>
            <ConnectivityConstraint/>
        </CellType>
        <CellType class="biological" name="ct2">
            <VolumeConstraint target="1800" strength="1"/>
            <SurfaceConstraint target="250" strength="1" mode="surface"/>
            <ConnectivityConstraint/>
        </CellType>
        <CellType class="biological" name="ct3">
            <VolumeConstraint target="1800" strength="1"/>
            <ConnectivityConstraint/>
            <SurfaceConstraint target="100" strength="1" mode="surface"/>
        </CellType>
        <CellType class="biological" name="ct4">
            <VolumeConstraint target="2250" strength="1"/>
            <ConnectivityConstraint/>
            <SurfaceConstraint target="400" strength="1" mode="surface"/>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction default="0.0">
            <Contact type1="ct1" type2="medium" value="3"/>
            <Contact type1="ct2" type2="medium" value="2"/>
            <Contact type1="ct3" type2="medium" value="2"/>
            <Contact type1="ct4" type2="medium" value="5"/>
            <Contact type1="ct1" type2="ct1" value="30"/>
            <Contact type1="ct2" type2="ct2" value="30"/>
            <Contact type1="ct1" type2="ct2" value="30"/>
            <Contact type1="ct1" type2="ct3" value="30"/>
            <Contact type1="ct2" type2="ct3" value="30"/>
            <Contact type1="ct3" type2="ct3" value="30"/>
            <Contact type1="ct1" type2="ct4" value="30"/>
            <Contact type1="ct2" type2="ct4" value="30"/>
            <Contact type1="ct3" type2="ct4" value="30"/>
            <Contact type1="ct4" type2="ct4" value="30"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="2"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>6</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="ct1" size="0">
            <InitCircle number-of-cells="4" mode="random">
                <Dimensions radius="size.x/3" center="size.x/2, size.y/2, 0"/>
            </InitCircle>
            <!--    <Disabled>
        <InitRectangle number-of-cells="10" mode="random">
            <Dimensions origin="size.x/2,size.y/2,0" size="size.x/2,size.y/2,0"/>
        </InitRectangle>
    </Disabled>
-->
        </Population>
        <Population type="ct2" size="0">
            <InitCircle number-of-cells="3" mode="random">
                <Dimensions radius="size.x/3" center="size.x/2, size.y/2, 0"/>
            </InitCircle>
        </Population>
        <Population type="ct3" size="0">
            <!--    <Disabled>
        <InitRectangle number-of-cells="10" mode="random">
            <Dimensions origin="size.x/2, size.y/2, 0" size="size.x/2"/>
        </InitRectangle>
    </Disabled>
-->
            <InitCircle number-of-cells="4" random_displacement="30.0" mode="random">
                <Dimensions radius="size.x/3" center="size.x/2, size.y/2,0"/>
            </InitCircle>
        </Population>
        <Population type="ct4" size="1">
            <InitCircle number-of-cells="5" mode="random">
                <Dimensions radius="size.x/3" center="size.x/2,size.y/2,0"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="20" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells flooding="true" value="cell.type"/>
            </Plot>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Mixed Cell Types/model.md
````markdown
![](M2008_mixed-cell-types_model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/Non-local Chemical Signals/index.md
````markdown
---
MorpheusModelID: M2015

title: Non-local Chemical Signals

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true
#  preprint: false

tags:
- Aggregation
- Attractant
- Attraction
- Cell Aggregation
- Cellular Potts Model
- Chemical Secretion
- Chemical Signals
- Chemoattraction
- Chemotaxis
- Cluster
- Concentration Field
- CPM
- Decay
- Difussion
- Keller-Segel Model
- Production
- Repellent
- Repulsion
- Secretion

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> Hybrid continuum-chemical and agent-based cell model

## Introduction

The idea that the diffusion of extracellular signaling molecules sets up non-local cellular communications can also be used to simulate non-local forces using chemoattraction and repulsion.

## Description

We compose a hybrid model with CPM cells that secrete two types of chemicals to which they respond chemotactically. We denote by <span title="//Global/Field[@symbol='c1']">$`c_1`$</span> the concentration field of the attractant, and by <span title="//Global/Field[@symbol='c2']">$`c_2`$</span> the repellent.

The is a simple generalization of the <a href="/model/m2010" title="<i class='fas fa-dna pr-1'></i>Morpheus Model ID: <code class='model-id-tooltip'>M2010</code>">‘Keller-Segel’ simulation</a> to have two rather than a single chemical. While the Keller-Segel model (with its pure attraction of cells) could produce cell aggregation under the appropriate conditions, the interplay of both attraction and repulsion cues can account for a greater variety of behaviors.


## Results

Cells each produce diffusible chemicals of two types, an attractant and a repellent. Depending on the relative rates of production, decay, and diffusion of attractant and repellent, the cells may either avoid each other (top), or cluster or aggregate (bottom).

![](CellGroupsNonlocMorpheus.png "Cell simulations with an attractant and a repellent chemical. Both chemicals diffuse, are produced by cells at rates <span title='//Global/System/Constant[@value=&#39;alpha1&#39;]'>$`\alpha_1`$</span>, <span title='//Global/System/Constant[@value=&#39;beta1&#39;]'>$`\beta_1`$</span> and decay at rates <span title='//Global/System/Constant[@value=&#39;alpha2&#39;]'>$`\alpha_2`$</span>, <span title='//Global/System/Constant[@value=&#39;beta2&#39;]'>$`\beta_2`$</span>. We see distinct behaviors, corresponding to a) pure repulsion of the cells, b) organized spacing, c) a few tight clusters, and d) a single large cluster of adherent cells.")

{{% callout note %}}
By adjusting the relative rates of diffusion (a.k.a. spatial ranges) and relative concentrations (a.k.a. magnitudes) of the corresponding ‘chemotactic forces’, we see distinct behaviors. **Try the following experiments** using model [`NonlocalChemSign.xml`](#model), which is set to behavior b) by default, to reproduce all behaviors shown in the figure above:

| Behavior | <span title="//Global/System/Constant[@value='alpha1']">$`\alpha_1`$</span> | <span title="//Global/System/Constant[@value='alpha2']">$`\alpha_2`$</span> | <span title="//Global/System/Constant[@value='beta1']">$`\beta_1`$</span> | <span title="//Global/System/Constant[@value='beta2']">$`\beta_2`$</span> | <span title="//Global/Field[@symbol='c1']/Diffusion/@rate">$`D_1`$</span> | <span title="//Global/Field[@symbol='c2']/Diffusion/@rate">$`D_2`$</span> |
|---|---|---|---|---|---|---|
| a) | $`0.5`$ | $`0.5`$ | $`1`$ | $`0.1`$ | $`0.5`$ | $`1`$ |
| **b)** | $`0.05`$ | $`0.05`$ | $`2`$ | $`0.5`$ | $`1`$ | $`0.5`$ |
| c) | $`4`$ | $`0.5`$ | $`1`$ | $`0.1`$ | $`0.5`$ | $`1`$ |
| d) | $`0.5`$ | $`0.05`$ | $`0.01`$ | $`0.5`$ | $`1`$ | $`0.5`$ |
{{% /callout %}}

<figure>
    ![](M2015_non-local-chemical-signals_video_behavior-b.mp4)
    <figcaption>
        Simulation video of {{< model_quick_access "media/model/m2015/NonlocalChemSign.xml" >}} with the preset behavior b).
    </figcaption>
</figure>
````

## File: Contributed Examples/CPM/Non-local Chemical Signals/model.md
````markdown
![](M2015_non-local-chemical-signals_model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/Non-local Chemical Signals/NonlocalChemSign.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>Nonlocal Chemical Signaling</Title>
        <Details>Full title:		Non-local Chemical Signals
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		23.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2015
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		A group of cells that secrete both attractive and repulsive chemicals. Cells chemotax towards/away from the attractant/repellent. This hybrid cell-agent-based/chemical-continuum model mimics nonlocal interactions of cells (agents) with attraction-repulsion Morse potential. It can demonstrate cell clustering, cell spacing, and other dynamics. For distinct behaviours, try the following experiments: a) alpha_1 = 0.5, alpha_2 = 0.5, beta_1 = 1, beta_2 = 0.1, D1 = 0.5, D_2 = 1. b) alpha_1 = 0.05, alpha_2 = 0.05, beta_1 = 2, beta_2 = 0.5, D1 = 1, D_2 = 0.5. c) alpha_1 = 4, alpha_2 =  0.5, beta_1 = 1, beta_2 = 0.1, D1 = 0.5, D_2 = 1. d) alpha_1 = 0.5, alpha_2 = 0.05, beta_1 = 0.01, beta_2 = 0.5, D1 = 1, D_2 = 0.5.</Details>
    </Description>
    <Global>
        <Field symbol="c1" name="attractant_1" value="0">
            <Diffusion rate="1"/>
            <Annotation>First define the chemical and set its boundary conditions. Also set the rate of diffusion of the chemical.
 
</Annotation>
        </Field>
        <Field symbol="c2" name="Repellent" value="0">
            <Diffusion rate="0.5"/>
        </Field>
        <Field symbol="c" name="total stimulus" value="0">
            <Diffusion rate="0"/>
        </Field>
        <System time-step="0.01" solver="Euler [fixed, O(1)]">
            <Constant symbol="time_scaling" value="10"/>
            <Constant symbol="alpha1" value="0.05"/>
            <Constant symbol="alpha2" value="0.05"/>
            <Constant symbol="beta1" value="2"/>
            <Constant symbol="beta2" value="0.5"/>
            <DiffEqn symbol-ref="c1">
                <Expression>time_scaling * (is_source1*alpha1 - alpha2*c1)</Expression>
                <Annotation>The chemicals are produced at every point in space
 where "is_source1" or "is_source2" is nonzero.
 At every point in the region, the chemical will diffuse
and also decay at the rate called "decay".
 </Annotation>
            </DiffEqn>
            <DiffEqn symbol-ref="c2">
                <Expression>time_scaling * (is_source2*beta1 - beta2*c2)</Expression>
            </DiffEqn>
        </System>
        <Equation symbol-ref="c" name="difference of two fields c1 and c2">
            <Expression>c1-c2</Expression>
            <Annotation>Algebraic equations should be given outside the &lt;System...>
        and will be evaluated as often as anything changes and is used.
        The "System" is reserved for differential equations and recurrence rules
        (and their constants and helper functions).
 </Annotation>
        </Equation>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="l" value="150, 150, 0"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <NodeLength value="0.1"/>
            <Neighborhood>
                <Distance>1.5</Distance>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime symbol="end" value="50"/>
        <TimeSymbol symbol="time"/>
        <RandomSeed value="124403"/>
    </Time>
    <CellTypes>
        <CellType class="medium" name="medium">
            <Property symbol="max_c1" value="0"/>
            <Property symbol="max_c2" value="0"/>
            <Property symbol="max_c" value="0"/>
            <Property symbol="min_c" value="0"/>
            <Property symbol="is_source1" value="0"/>
            <Property symbol="is_source2" value="0"/>
            <Annotation>The medium is not a source of any chemical.
Cells are sources of chemicals and are attracted to c=c1-c2 by chemotaxis
 </Annotation>
        </CellType>
        <CellType class="biological" name="amoeba">
            <VolumeConstraint target="40" strength="1"/>
            <Chemotaxis strength="mu" field="c"/>
            <Property symbol="is_source1" value="1"/>
            <Property symbol="is_source2" value="1"/>
            <Property symbol="max_c1" value="0"/>
            <Property symbol="max_c2" value="0"/>
            <Property symbol="max_c" value="0"/>
            <Property symbol="min_c" value="0"/>
            <Function symbol="mu">
                <Expression>2</Expression>
            </Function>
            <Mapper>
                <Input value="c"/>
                <Output symbol-ref="max_c" mapping="maximum"/>
            </Mapper>
            <Mapper>
                <Input value="c"/>
                <Output symbol-ref="min_c" mapping="minimum"/>
            </Mapper>
            <Annotation>Cells are a source of both attractant and repellant. Mu sets the value of the chemotaxis rate.
 
 </Annotation>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="amoeba" type2="amoeba" value="6"/>
            <Contact type1="amoeba" type2="medium" value="2"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration symbol="MCStime" value="0.001875"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics yield="0.1" temperature="1.0"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>1.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="amoeba" size="1">
            <InitCircle number-of-cells="50" mode="random">
                <Dimensions radius="l.x/8" center="l.x/2, l.y/2, 0"/>
            </InitCircle>
            <Annotation>Initializes the cells to all be inside a little circle of radius 1/8 the domain size
 </Annotation>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="1" decorate="false">
            <Terminal size="400 400 0" name="png"/>
            <Plot>
                <Field symbol-ref="c" min="-0.5" max="0.5">
                    <ColorMap>
                        <Color value="-0.1" color="white"/>
                        <Color value="0" color="yellow"/>
                        <Color value="0.3" color="red"/>
                    </ColorMap>
                </Field>
                <Cells opacity="0.65" min="0.0" max="20" value="cell.id">
                    <ColorMap>
                        <Color value="1" color="red"/>
                        <Color value="50" color="blue"/>
                    </ColorMap>
                </Cells>
            </Plot>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/One CPM Cell/index.md
````markdown
---
MorpheusModelID: M2002

title: "One CPM Cell"

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true

tags:
- Cellular Potts Model
- ConnectivityConstraint
- Contact
- CPM
- Deformation
- Irregular Cell Shape
- Irregular Shape
- MetropolisKinetics
- SurfaceConstraint
- Single Cell
- Target Area
- Target Perimeter
- Temperature
- Time-step
- VolumeConstraint
- Yield

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
>Time sequence showing the changing shape of a CPM cell

## Introduction

Not all cell shapes are circular. In this example, a single cell undergoes a whole series of deformations resulting in the development of irregular cell shapes.

## Description

For a time sequence showing the shape of a CPM cell every $`50`$ <span title="//Analysis/Gnuplotter/@time-step">`time-step`</span>s the following parameters were used:

- Target area (<span title="//CellTypes/CellType[@name='amoeba']/VolumeConstraint/@target">`VolumeConstraint`</span>) $`a_0 = 400`$,
  - <span title="//CellTypes/CellType[@name='amoeba']/VolumeConstraint/@strength">`strength`</span> $`\lambda_a = 1`$,
- target perimeter (<span title="//CellTypes/CellType[@name='amoeba']/SurfaceConstraint/@target">`SurfaceConstraint`</span>) $`p_0 = 120`$,
  - <span title="//CellTypes/CellType[@name='amoeba']/SurfaceConstraint/@strength">`strength`</span> $`\lambda_p = 1`$,
- <span title="//CellTypes/CellType[@name='amoeba']/ConnectivityConstraint">`ConnectivityConstraint`</span> enabled,
- cell-medium <span title="//CPM/Interaction/Contact[@type1='amoeba'][@type2='medium']/@value">`Contact`</span> strength&nbsp;$` = 2`$,
- <span title="//CPM/MonteCarloSampler/MetropolisKinetics/@temperature">`temperature`&nbsp;$`= 1`$,
- <span title="//CPM/MonteCarloSampler/MetropolisKinetics/@yield">`yield`&nbsp;$`= 0.1`$.

## Results

The cell continuously puts out protrusions in various directions. 

![](OneCPMCell.png "A time sequence showing the shape of a CPM cell every $`50`$ time steps.")

<figure>
![](M2002_one-cpm-cell_movie.mp4)
<figcaption>Simulation video of <a href="#model"><code>OneCPMCell.xml</code></a></figcaption>
</figure>
````

## File: Contributed Examples/CPM/One CPM Cell/model.md
````markdown
![](M2002_one-cpm-cell_model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/One CPM Cell/OneCPMCell.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>One CPM Cell</Title>
        <Details>Full title:		One CPM Cell
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		02.05.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2002
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		A time sequence showing the shape of a CPM cell every 50 time steps. The cell continuously puts out protrusions in various directions.</Details>
    </Description>
    <Space>
        <Lattice class="square">
            <Size symbol="l" value="150, 150, 0"/>
            <BoundaryConditions>
                <Condition type="constant" boundary="x"/>
                <Condition type="constant" boundary="-x"/>
                <Condition type="constant" boundary="y"/>
                <Condition type="constant" boundary="-y"/>
            </BoundaryConditions>
            <NodeLength value="0.37"/>
            <Neighborhood>
                <Distance>1.5</Distance>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime symbol="end" value="750"/>
        <TimeSymbol symbol="time"/>
        <RandomSeed value="1227903"/>
    </Time>
    <CellTypes>
        <CellType class="medium" name="medium"/>
        <CellType class="biological" name="amoeba">
            <VolumeConstraint target="400" strength="1"/>
            <SurfaceConstraint target="120" strength="1" mode="surface"/>
            <ConnectivityConstraint/>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="amoeba" type2="amoeba" value="4"/>
            <Contact type1="amoeba" type2="medium" value="2"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration symbol="MCStime" value="0.1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics yield="0.1" temperature="1.0"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>1.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="amoeba" size="1">
            <InitCircle number-of-cells="1" mode="random">
                <Dimensions radius="l.x/8" center="l.x/2, l.y/2, 0"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="50" decorate="false">
            <Terminal name="png" size="400 400 0"/>
            <Plot>
                <Cells opacity="0.65" min="0.0" max="10" value="cell.id">
                    <ColorMap>
                        <Color value="1" color="red"/>
                        <Color value="10" color="blue"/>
                    </ColorMap>
                </Cells>
            </Plot>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
    <Global/>
</MorpheusModel>
````

## File: Contributed Examples/CPM/One Random Walker/index.md
````markdown
---
MorpheusModelID: M2003

title: "One Random Walker"

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true

tags:
- 2D
- Bacterium
- Biased Random Motion
- Biased Random Walk
- Chemical Bias
- Cellular Potts Model
- CPM
- DirectedMotion
- Directed Movement
- Directional Bias
- Disturbance
- Forward Direction
- Logger
- MCSDuration
- Random Motion
- Random Walk
- Random Walker
- Run
- Run and Tumble
- Single Cell
- StopTime
- Trajectory
- Tumble
- Unbiased Random Walk

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> Unbiased and biased random walkers

## Introduction

We can simulate the swimming motion of a cell, such as a bacterium, by interspersing short periods of directed motion with random turns or random scrambling of the cell’s velocity.

## Description

A cell is started at the center of the domain. At fixed time increments, the walker changes its direction of motion. Its velocity vector is then recomputed in an <span title="//CellTypes/CellType[@name='Walker']/Event[@name='Change direction']">`Event`</span> as a vector with random <span title="//CellTypes/CellType[@name='Walker']/Event/VectorRule/Expression[@value='rand_uni(-1,1), rand_uni(-1,1) , 1']">$`x`$ and $`y`$</span> components. A bias in the move direction can be introduced by setting <span title="//CellTypes/CellType[@name='Walker']/Property[@symbol='BiasOnOff']/@value">`BiasOnOff`</span> to $`0`$ (off) or $`1`$ (on).

## Results

Sample trajectories of a random walker with bias (right, <span title="//CellTypes/CellType[@name='Walker']/Property[@symbol='BiasOnOff']/@value">`BiasOnOff`&nbsp;$`= 1`$</span>) and without bias (left, <span title="//CellTypes/CellType[@name='Walker']/Property[@symbol='BiasOnOff']/@value">`BiasOnOff`&nbsp;$`= 0`$</span>) towards the <span title="//CellTypes/CellType[@name='Walker']/PropertyVector[@symbol='BiasDirection']/@value">$`y`$</span> direction. At fixed time increments, the walker changes its direction of motion, with new velocity vector recomputed with random $`x`$ and $`y`$ components. Time along the trajectories is color-coded from black to yellow.

![](OneRandomWalker.png "A random walker in 2D: a cell is started at the center of the domain. Produced with [`OneRandomWalker_main.xml`](#model).")

![](ChemicalBias.png "Left: Three sample snapshots of the cell and chemical concentration. Right: Cell trajectory over <span title='//Time/StopTime[@value=&#39;15000&#39;] and //CPM/MonteCarloSampler/MCSDuration[@value=&#39;1&#39;]'>$`15000\ \mathrm{MCS}`$</span>. The cell spends most of its time in the high <span title='//Global/Field[@symbol=&#39;c&#39;]'>$`c`$</span> region, as its run length drops and frequency of turning increases with <span title='//Global/Field[@symbol=&#39;c&#39;]'>$`c`$</span>. Produced with [`OneRandomWalkerWithChemicalBias.xml`](#downloads).")

<figure>
![](M2003_one-random-walker_video_OneRandomWalkerWithChemicalBias.mp4)
<figcaption>Simulation video of <a href="#downloads"><code>OneRandomWalkerWithChemicalBias.xml</code></a></figcaption>
</figure>
````

## File: Contributed Examples/CPM/One Random Walker/model.md
````markdown
![](M2003_one-random-walker_model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/One Random Walker/OneRandomWalker_main.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>OneRandomWalker</Title>
        <Details>Full title:		One Random Walker
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		10.05.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2003
File type:		Main model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		A Random walker in 2D: a cell is started at the center of the domain. At fixed time increments, the walker changes its direction of motion. Its velocity vector is then recomputed as a vector with random x and y components. A bias in the move direction can be introduced by setting BiasOnOff to 0 (Off) or 1 (On). Thanks: Uses some aspects of example RunAndTumble (Morpheus Model ID: M0025, https://identifiers.org/morpheus/M0025) provided in Morpheus.</Details>
    </Description>
    <Global/>
    <Space>
        <Lattice class="hexagonal">
            <Size symbol="size" value="200, 200, 0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="10000"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="Walker">
            <VolumeConstraint target="200" strength="1"/>
            <ConnectivityConstraint/>
            <PropertyVector symbol="move_dir" value="0.0, 0.0, 0.0"/>
            <PropertyVector symbol="displacement" value="0.0, 0.0, 0.0"/>
            <PropertyVector symbol="velocity" value="0.0, 0.0, 0.0"/>
            <PropertyVector symbol="BiasDirection" name="spatial cue direction" value="0, 1.0, 0.0"/>
            <Property symbol="BiasOnOff" name="Turn cue on (1) or off (0)" value="0.0"/>
            <Property symbol="run_time" name="run duration" value="5.0"/>
            <Property symbol="last_turn_time" name="last random event" value="0"/>
            <DirectedMotion direction="20*move_dir+BiasDirection*BiasOnOff" strength="1"/>
            <Event trigger="when-true" time-step="5" name="Change direction">
                <Condition>time >= last_turn_time+ run_time</Condition>
                <Rule symbol-ref="last_turn_time" name="Time of last random event">
                    <Expression>time</Expression>
                </Rule>
                <VectorRule symbol-ref="move_dir" name="new direction of motion">
                    <Expression>rand_uni(-1,1), rand_uni(-1,1) , 1</Expression>
                </VectorRule>
            </Event>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="Walker" type2="medium" value="4"/>
            <Contact type1="Walker" type2="Walker" value="10"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="0.6"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="Walker" size="1" name="Random Walker">
            <!--    <Disabled>
        <Cell id="1" name="1">
            <Nodes>100,100,0</Nodes>
        </Cell>
    </Disabled>
-->
            <InitCircle number-of-cells="1" random_displacement="5.0" mode="random">
                <Dimensions radius="10.0" center="100.0, 100.0, 0.0"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="200" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells value="cell.id"/>
                <CellArrows orientation="20*velocity" center="midpoint" style="1"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="10">
            <Input>
                <Symbol symbol-ref="cell.center.x"/>
                <Symbol symbol-ref="cell.center.y"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="5000">
                    <Style line-width="1.5" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="cell.center.x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="cell.center.y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="time"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <DisplacementTracker time-step="10" name="data" celltype="Walker"/>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/One Random Walker/OneRandomWalkerWithBias.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>OneRandomWalker</Title>
        <Details>Full title:		One Random Walker
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		10.05.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2003
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		A Random walker in 2D: a cell is started at the center of the domain. At fixed time increments, the walker changes its direction of motion. Its velocity vector is then recomputed as a vector with random x and y components. A bias in the move direction can be introduced by setting BiasOnOff to 0 (Off) or 1 (On). Thanks: Uses some aspects of example RunAndTumble (Morpheus Model ID: M0025, https://identifiers.org/morpheus/M0025) provided in Morpheus.
</Details>
    </Description>
    <Global/>
    <Space>
        <Lattice class="hexagonal">
            <Size symbol="size" value="200, 200, 0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="10000"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="Walker">
            <VolumeConstraint target="200" strength="1"/>
            <ConnectivityConstraint/>
            <PropertyVector symbol="move_dir" value="0.0, 0.0, 0.0"/>
            <PropertyVector symbol="displacement" value="0.0, 0.0, 0.0"/>
            <PropertyVector symbol="velocity" value="0.0, 0.0, 0.0"/>
            <PropertyVector symbol="BiasDirection" name="spatial cue direction" value="0, 1.0, 0.0"/>
            <Property symbol="BiasOnOff" name="Turn cue on (1) or off (0)" value="1.0"/>
            <Property symbol="run_time" name="run duration" value="5.0"/>
            <Property symbol="last_turn_time" name="last random event" value="0"/>
            <DirectedMotion direction="20*move_dir+BiasDirection*BiasOnOff" strength="1"/>
            <Event trigger="when-true" time-step="5" name="Change direction">
                <Condition>time >= last_turn_time+ run_time</Condition>
                <Rule symbol-ref="last_turn_time" name="Time of last random event">
                    <Expression>time</Expression>
                </Rule>
                <VectorRule symbol-ref="move_dir" name="new direction of motion">
                    <Expression>rand_uni(-1,1), rand_uni(-1,1) , 1</Expression>
                </VectorRule>
            </Event>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="Walker" type2="medium" value="4"/>
            <Contact type1="Walker" type2="Walker" value="10"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="0.6"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="Walker" size="1" name="Random Walker">
            <!--    <Disabled>
        <Cell id="1" name="1">
            <Nodes>100,100,0</Nodes>
        </Cell>
    </Disabled>
-->
            <InitCircle number-of-cells="1" random_displacement="5.0" mode="random">
                <Dimensions radius="10.0" center="100.0, 100.0, 0.0"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="200" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells value="cell.id"/>
                <CellArrows orientation="20*velocity" center="midpoint" style="1"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="10">
            <Input>
                <Symbol symbol-ref="cell.center.x"/>
                <Symbol symbol-ref="cell.center.y"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="5000">
                    <Style line-width="1.5" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="cell.center.x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="cell.center.y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="time"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <DisplacementTracker time-step="10" name="data" celltype="Walker"/>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/One Random Walker/OneRandomWalkerWithChemicalBias.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>OneRandomWalkerWithChemicalBias</Title>
        <Details>Full title:		One Random Walker
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		10.05.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2003
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Cell attracted up a chemical gradient. As in OneRandomWalker_main.xml, but the frequency of the random changes in direction increases with the level of chemical sensed in the cell's environment. The cell starts at the center of the domain. A chemical gradient is created by a chemical (c) that diffuses from the left edge of the domain. The cell senses the average level of that chemical at its location (cs) and changes its direction of motion at increments of the run_time*(1+cs). The larger cs, the faster this happens. When the cell changes direction, its velocity vector is recomputed as a vector with random x and y components. As a result of this chemical-dependence, the cell tends to spend more time close to the higher chemical level.</Details>
    </Description>
    <Global>
        <Field symbol="c" name="Attractant" value="0.0">
            <Diffusion rate="0.2"/>
            <BoundaryValue boundary="x" value="5.0"/>
            <BoundaryValue boundary="-x" value="0.0"/>
            <Annotation>A diffusible chemical with constant value at the left domain edge.</Annotation>
        </Field>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="200, 200, 0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <BoundaryConditions>
                <Condition type="constant" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
                <Condition type="constant" boundary="-x"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="15000"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="Walker">
            <VolumeConstraint target="200" strength="1"/>
            <ConnectivityConstraint/>
            <PropertyVector symbol="move_dir" value="0.0, 0.0, 0.0"/>
            <PropertyVector symbol="displacement" value="0.0, 0.0, 0.0"/>
            <PropertyVector symbol="velocity" value="0.0, 0.0, 0.0"/>
            <Property symbol="run_time" name="run duration" value="5.0"/>
            <Property symbol="last_turn_time" name="last random event" value="0"/>
            <Variable symbol="cs" value="0.0"/>
            <DirectedMotion direction="20*move_dir" strength="1"/>
            <Event trigger="when-true" time-step="5" name="Change direction">
                <Condition>time >= last_turn_time+ run_time/(1+cs)</Condition>
                <Rule symbol-ref="last_turn_time" name="Time of last random event">
                    <Expression>time</Expression>
                </Rule>
                <VectorRule symbol-ref="move_dir" name="new direction of motion">
                    <Expression>rand_uni(-1,1)/(1+cs), rand_uni(-1,1)/(1+cs) , 1</Expression>
                    <Annotation>When the condition is satisfied, chose a new random direction vector.</Annotation>
                </VectorRule>
            </Event>
            <Mapper time-step="1.0" name="sensed chemical">
                <Input value="c"/>
                <Output symbol-ref="cs" mapping="average"/>
                <Annotation>The mapper converts the chemical field c(x,y,t) into a value cs(t) that a given cell senses and reacts to.</Annotation>
            </Mapper>
            <MotilityReporter time-step="200">
                <Velocity symbol-ref="velocity"/>
            </MotilityReporter>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="Walker" type2="medium" value="4"/>
            <Contact type1="Walker" type2="Walker" value="10"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="0.6"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="Walker" size="1" name="Random Walker">
            <InitCircle number-of-cells="1" mode="random">
                <Dimensions radius="10.0" center="100.0, 100.0, 0.0"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="200" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells value="cell.id"/>
                <!--    <Disabled>
        <CellArrows orientation="100*velocity"/>
    </Disabled>
-->
                <Field symbol-ref="c"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="10">
            <Input>
                <Symbol symbol-ref="cell.center.x"/>
                <Symbol symbol-ref="cell.center.y"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="5000">
                    <Style line-width="1.0" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="cell.center.x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="cell.center.y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="time"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <DisplacementTracker time-step="10" name="data" celltype="Walker"/>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Parameter Plane/CPMParameterPlane_main.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details>Full title:		CPM Parameter Plane
Authors:		L. Edelstein-Keshet
Contributors:	D. Jahn, Y. Xiao
Date:		26.02.2021
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2001
File type:		Main model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Two-parameter plane showing all possible regimes of behaviour for  a single CPM cell. Idea is based on Fig. 3 in the followng paper: Magno, R., Grieneisen, V. A., Marée, A. F. (2015). The biophysical nature of cells: potential cell behaviours revealed by analytical and computational studies of cell surface mechanics. BMC biophysics, 8(1), 1-37. But here, we use two dimensionless parameters, dimensionless perimeter cost:  kappa=4*LambP/(LambA*Ra^2) – on the horizontal axis, dimensionless cell-medium contact energy cost:  beta= 2*Jmed/(3.14*LambA*Ra^3) – on the vertical axis, circularity: alpha = R_p/R_a – vary manually. Suggestion: try the settings alpha = 0.5, 1, 2. The results are now consistent with theoretical analysis in the above references. However, fine-tuning of the CPM settings was required to obtain the results. Simulation was fixed by Jörn Starruß (JS), and some comments added based on his help. JS: Morpheus 2.2 supports expressions in Contact energies directly, which may depend on properties of the given cell types. For example: &lt;Contact type1="Cell" type2="medium" value="cell1.Jmed">&lt;/Contact>. In previous versions of Morpheus, this had to be done by AddOn adhesion. JS: There is a constraint that prevents cells from vanishing from volume 1 to 0. You may use a CellDeath component to remove cells of volume 1. Usually we don't want cells to disappear due to shape constraint imbalances. JS: Creating a cell array with an initial shape works nicely with InitCellObjects: &lt;InitCellObjects mode="distance">&lt;Annotation>Initialize an 8x8 cell array  in a  square domain.&lt;/Annotation>&lt;Arrangement displacements="96, 96, 0" repetitions="8, 8, 1">&lt;Sphere radius="20.0" center="40.0, 40.0, 0.0"/>&lt;/Arrangement>&lt;/InitCellObjects>. JS: CPM dynamics have a lot of technical details in the CPM section. The simulation can get locked into local energy minima. JS increased the amplitude of fluctuations and smoothed the shape surface length approximation by choosing ShapeSurface/Neighborhood order 6 for the square lattice. Also choosing updates from Neighborhood order 2 is probably sufficient. This helped to get the theoretical results: MorpheusModel/CPM/MonteCarloSampler/MetropolisKinetics/temperature = 40, MorpheusModel/CPM/ShapeSurface/Neighborhood/Order = 6, MorpheusModel/CPM/MonteCarloSampler/Neighborhood/Order = 2.</Details>
        <Title>CPMParameterPlane</Title>
    </Description>
    <Space>
        <Lattice class="square">
            <Annotation>Set up the square grid</Annotation>
            <Neighborhood>
                <Order>4</Order>
            </Neighborhood>
            <Size symbol="size" value="750,750,0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="y"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="2000"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="Cell">
            <VolumeConstraint target="pi*(Ra^2)" strength="LambA"/>
            <SurfaceConstraint target="alpha*CircPerim" strength="LambP" mode="surface">
                <Annotation>JS: changed the surface constraint to an absolute value, not the relative-to-current-volume aspherity. LEK: alpha is still the same dimensionless ratio of radii</Annotation>
            </SurfaceConstraint>
            <Annotation>Initialize the cell with a volume and a perimeter constraint. The simulation will vary Jmed and LambP to get the distinct bergimes of behaviour. </Annotation>
            <Property symbol="Ra" name="Radius of rest area" value="20">
                <Annotation>Pick a convenient rest area radius so the cells will be visible.</Annotation>
            </Property>
            <Property symbol="LambP" value="cell.center.x/80"/>
            <Property symbol="LambA" value="10/(Ra^2)">
                <Annotation>To keep the "volume constraint" reasonable for larger radii, this parameter is scaled so that LambA*Ra^2=10 is fixed</Annotation>
            </Property>
            <Property symbol="Jmed" name="cell-medium contact energy term" value="6*(cell.center.y-250)"/>
            <Property symbol="alpha" name="Ratio of Rp to Ra" value="1">
                <Annotation>This is a dimensionless parameter that can be varied between 0 and something > 1. It is the ratio of the perimeter to the area rest radii</Annotation>
            </Property>
            <Property symbol="CircPerim" value="2*pi*Ra"/>
            <Property symbol="kappa" value="4*LambP/(LambA*Ra^2)">
                <Annotation>Dimensionless parameter varied for cells along the horizontal axis</Annotation>
            </Property>
            <Property symbol="beta" value="2*Jmed/(pi*LambA*Ra^3)">
                <Annotation>Dimensionless parameter varied for cells along the y axis</Annotation>
            </Property>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="Cell" type2="Cell" value="200"/>
            <Contact type1="Cell" type2="medium" value="cell1.Jmed"/>
        </Interaction>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>6</Order>
            </Neighborhood>
        </ShapeSurface>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <MetropolisKinetics temperature="20"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </MonteCarloSampler>
    </CPM>
    <CellPopulations>
        <Population type="Cell" size="1">
            <InitCellObjects mode="distance">
                <Annotation>Initialize the cells in a regular square domain, so that the x and y coordinates of each cell will correspond to its CPm behaviour.</Annotation>
                <Arrangement displacements="96, 96, 0" repetitions="8, 8, 1">
                    <Sphere radius="20.0" center="40.0, 40.0, 0.0"/>
                </Arrangement>
            </InitCellObjects>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="100" decorate="true">
            <Plot>
                <Cells flooding="true" value="beta"/>
            </Plot>
            <Terminal name="png"/>
            <Plot>
                <Cells flooding="true" value="kappa"/>
            </Plot>
            <Annotation>The two plots are the same, but one is  colored by the beta value and the other by the kappa value. This also provides a scale for each.</Annotation>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
    <Global>
        <Constant symbol="NumCells" name="Number of cells to display" value="64"/>
        <Variable symbol="kappa" value="0.0"/>
        <Variable symbol="Jmed" value="0"/>
        <Variable symbol="beta" value="0.0"/>
    </Global>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Parameter Plane/index.md
````markdown
---
MorpheusModelID: M2001

title: CPM Parameter Plane

authors: [L. Edelstein-Keshet, J. Starruß]
contributors: [D. Jahn, Y. Xiao]

# Under review
#hidden: true
#private: true

# Reference details
publication:
  doi: "10.1186/s13628-015-0022-x"
  title: "The biophysical nature of cells: potential cell behaviours revealed by analytical and computational studies of cell surface mechanics"
  authors: [R. Magno, V. A. Grieneisen, A. F. Marée]
  journal: "BMC Biophys."
  volume: 8
  issue: 8
  page: "1-37"
  year: 2015
  #original_model: true

tags:
- Asphericity
- Cell-cell Contact
- CellDivision
- Cell-medium Contact
- Cellular Potts Model
- Circularity
- Contact Energy
- CPM
- Dimensionless Parameter
- Energetic Cost
- Parameter Plane
- Perimeter Cost
- Single Cell

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
#- DOI:10.1186/s13628-015-0022-x
---
>Two-parameter plane showing all possible regimes of behavior for a single CPM cell

## Introduction

The idea is based on [figure 3](https://bmcbiophys.biomedcentral.com/articles/10.1186/s13628-015-0022-x/figures/3) in the [referenced paper](#reference).

## Description

But here, we use two **dimensionless parameters**:

- Dimensionless **perimeter cost**: <span title="//CellTypes/CellType/Property[@symbol='kappa']">$`\kappa = \frac{4 \lambda_\mathrm p}{\lambda_\mathrm a R_\mathrm a^2}`$</span> – on the horizontal axis,
- dimensionless **cell-medium contact energy cost**: <span title="//CellTypes/CellType/Property[@symbol='beta']">$`\beta = \frac{2J}{\pi \lambda_\mathrm a R_\mathrm a^3}`$</span> – on the vertical axis,
- **circularity**: <span title="//CellTypes/CellType/Property[@symbol='alpha']">$`\alpha = \frac{R_\mathrm p}{R_\mathrm a}`$</span> – vary manually.

## Results

![](CPMParameterPlane.png "A morpheus simulation of the shape of a single cell in the $`\kappa \beta`$ CPM parameter plane (<span title='//CellTypes/CellType/Property[@symbol=&#39;kappa&#39;]'>$`\kappa`$</span> is a scaled perimeter cost and <span title='//CellTypes/CellType/Property[@symbol=&#39;beta&#39;]'>$`\beta`$</span> is a scaled cell-medium contact energy, and <span title='//CellTypes/CellType/Property[@symbol=&#39;alpha&#39;]'>$`\alpha`$</span> is the asphericity of the cell). Produced with model file [`CPMParameterPlane_main.xml`](#model).")

![](TwoCellCPMParameterPlane.png "A morpheus simulation of a pair of cells showing the effect of scaled cell-cell and cell-medium energetic costs, <span title='//CellTypes/CellType/Property[@symbol=&#39;eta&#39;]'>$`\eta`$</span> and <span title='//CellTypes/CellType/Property[@symbol=&#39;beta&#39;]'>$`\beta`$</span>. Produced with model file [`TwoCellCPMParameterPlane.xml`](#downloads).")

<figure>
![](movie.mp4)
<figcaption>
Simulation of cells in the $`\kappa \beta`$ parameter plane with two plots, one colored by the <span title="//CellTypes/CellType/Property[@symbol='beta']">$`\beta`$</span> value and the other by the <span title="//CellTypes/CellType/Property[@symbol='kappa']">$`\kappa`$</span> value. Produced with model file {{< model_quick_access "media/model/m2001/CPMParameterPlane_main.xml" >}}.
</figcaption>
</figure>

{{% callout note %}}
**Suggestion:** Try the settings <span title="//CellTypes/CellType/Property[@symbol='alpha']">$`\alpha = 0.5, 1, 2`$</span>.
{{% /callout %}}

The results are now consistent with the theoretical analysis of [Magno *et al.*, 2015](#reference).
However, fine-tuning of the CPM settings was required to obtain the results.

![](plot_02000.png "Plots of the simulation result at time <span title='//Time/StopTime'>$t = 2000$</span>. One is colored by the <span title='//CellTypes/CellType/Property[@symbol=&#39;beta&#39;]'>$`\beta`$</span> value and the other by the <span title='//CellTypes/CellType/Property[@symbol=&#39;kappa&#39;]'>$`\kappa`$</span> value. Produced with model file [`CPMParameterPlane_main.xml`](#model).")
````

## File: Contributed Examples/CPM/Parameter Plane/model.md
````markdown
![](model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/Parameter Plane/TwoCellCPMParameterPlane.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details>Full title:		CPM Parameter Plane
Authors:		L. Edelstein-Keshet
Contributors:	D. Jahn, Y. Xiao
Date:		26.02.2021
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2001
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		As in CPM Parameter Plane, but for pairs of cells with variable cell-cell and cell-medium contact terms. Here we are interested in the extent of contact between the cells as their parameters are tuned. We use two dimensionless parameters: dimensionless cell-medium contact energy cost:  beta = 2*Jmed/(pi*LambA*Ra^3) – on the vertical axis, dimensionless cell-cell contact energy cost: eta = J11/(2*LambA*(pi^2)*Ra^3) – on the vertical axis. In order to have cells with identical properties at each spot, we start with a single cell and use one "cell division" (all oriented in the same direction, for better visualization) to double it into pairs of cells (otherwise, cells initialized at various small distances have slightly different parameters, and start to do silly things). Uses the same fine-tuning of the CPM settings that produced CPMParameterPlane for single cells. The perimeter constraint has been disabled, but can be added back with the following dimensionless parameters: dimensionless perimeter cost: kappa = 4*LambP/(LambA*Ra^2) = 1, circularity: alpha = R_p/R_a.</Details>
        <Title>TwoCellCPMParameterPlane</Title>
    </Description>
    <Space>
        <Lattice class="square">
            <Annotation>Set up the square grid</Annotation>
            <Neighborhood>
                <Order>4</Order>
            </Neighborhood>
            <Size symbol="size" value="750,750,0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="y"/>
                <Condition type="noflux" boundary="-y"/>
                <Condition type="periodic" boundary="-x"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="3500"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="Cell">
            <VolumeConstraint target="pi*(Ra^2)" strength="LambA"/>
            <!--    <Disabled>
        <SurfaceConstraint target="alpha*CircPerim" strength="LambP" mode="surface">
            <Annotation>JS: changed the surface constraint to an absolute value, not the relative-to-current-volume aspherity. LEK: alpha is still the same dimensionless ratio of radii</Annotation>
        </SurfaceConstraint>
    </Disabled>
-->
            <Annotation>Initialize the cell with a volume and a perimeter constraint. The simulation will vary Jmed and LambP to get the distinct bergimes of behaviour. </Annotation>
            <Property symbol="Ra" name="Radius of rest area" value="20">
                <Annotation>Pick a convenient rest area radius so the cells will be visible.</Annotation>
            </Property>
            <Property symbol="LambP" value="cell.center.x/80"/>
            <Property symbol="LambA" value="10/(Ra^2)">
                <Annotation>To keep the "volume constraint" reasonable for larger radii, this parameter is scaled so that LambA*Ra^2=10 is fixed</Annotation>
            </Property>
            <Property symbol="Jmed" name="cell-medium contact energy term" value="(cell.center.y)/1.2"/>
            <Property symbol="alpha" name="Ratio of Rp to Ra" value="1">
                <Annotation>This is a dimensionless parameter that can be varied between 0 and something > 1. It is the ratio of the perimeter to the area rest radii</Annotation>
            </Property>
            <Property symbol="CircPerim" value="2*pi*Ra"/>
            <Property symbol="kappa" value="4*LambP/(LambA*Ra^2)">
                <Annotation>Dimensionless parameter varied for cells along the horizontal axis</Annotation>
            </Property>
            <Property symbol="beta" value="2*Jmed/(pi*LambA*Ra^3)">
                <Annotation>Dimensionless parameter varied for cells along the y axis</Annotation>
            </Property>
            <Property symbol="J11" value="3*cell.center.x"/>
            <Property symbol="eta" value="J11/(2*LambA*(pi^2)*Ra^3)"/>
            <CellDivision orientation="0.0, 1.0, 0.0" division-plane="oriented">
                <Condition>time==50</Condition>
            </CellDivision>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="Cell" type2="Cell" value="cell1.J11"/>
            <Contact type1="Cell" type2="medium" value="cell1.Jmed"/>
        </Interaction>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>6</Order>
            </Neighborhood>
        </ShapeSurface>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <MetropolisKinetics temperature="20"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </MonteCarloSampler>
    </CPM>
    <CellPopulations>
        <Population type="Cell" size="1">
            <InitCellObjects mode="distance">
                <Annotation>Initialize single cells in a regular square domain, so that the x and y coordinates of each cell will correspond to its CPM behaviour. (Initializing pairs of cells isposisble, but leads to funny results!)</Annotation>
                <Arrangement displacements="96, 96, 0" random_displacement="10" repetitions="8, 8, 1">
                    <Sphere radius="20.0" center="40.0, 40.0, 0.0"/>
                </Arrangement>
                <!--    <Disabled>
        <Arrangement displacements="96, 96, 0" random_displacement="10" repetitions="8, 8, 1">
            <Sphere radius="20.0" center="40.0, 40.0, 0.0"/>
        </Arrangement>
    </Disabled>
-->
            </InitCellObjects>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="100" decorate="true">
            <Plot>
                <Cells flooding="true" value="beta"/>
            </Plot>
            <Terminal name="png"/>
            <Plot>
                <Cells flooding="true" value="eta"/>
            </Plot>
            <Annotation>The two plots are the same, but one is  colored by the beta value and the other by the kappa value. This also provides a scale for each.</Annotation>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
    <Global>
        <Constant symbol="NumCells" name="Number of cells to display" value="64"/>
        <Variable symbol="kappa" value="0.0"/>
        <Variable symbol="Jmed" value="0"/>
        <Variable symbol="beta" value="0.0"/>
        <Variable symbol="J11" value="0.0"/>
    </Global>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Sister Reunion/index.md
````markdown
---
MorpheusModelID: M5493

contributors: [L. Brusch]

title: Sister Reunion
date: "2020-06-05T10:42:00+02:00"
lastmod: "2020-11-10T14:49:00+01:00"
---

>Track ```MotherId``` (```cell.id``` of mother) and compare it between neighboring cells

## Introduction

This example model demonstrates the tracking of the ```cell.id``` of any cell's mother and to compare these ```MotherId```s between neighboring cells upon contact to trigger special behaviors if sister cells meet in a SisterReunion. Such special cell-cell contacts of sister cells are flagged by the cell property ```SisterReunion``` $ = 1$, otherwise $0$.

## Description

For each cell division, a trigger copies the ```cell.id``` of the mother cell to the property ```MotherId``` of each daughter cell. In the included movie, the left panel shows ```cell.id```, the right panel ```MotherId```.
The plugin ```NeighborhoodReporter``` compares ```local.MotherId == MotherId``` where ```local``` accesses the cell's own scope when collecting information from the neighborhood. The test returns a $1$ when sisters are in contact, $0$ otherwise. This is updated every timestep (can be adjusted in ```NeighborhoodReporter```) and stored in the ```Property``` ```SisterReunion``` and used to color cells in the right panel of the movie.

![](SisterReunion.png "Snapshot of moving and dividing cells, daughter cells from the same earlier cell division that later encounter each other again are colored red in the right panel, as indicated by the computed property SisterReunion ($0 = $ green, $1 = $ red)")

![Movie visualising the simulation](SisterReunionMovie.mp4)

A follow-up question may be what happens when multiple cells are in contact of which at most two may be sisters. To control the outcome, you may choose a statistical function in the mapping attribute of the ```NeighborhoodReporter```/```Output```. The statistical function is then applied to all pairwise results of the ```NeighborhoodReporter``` with each neighboring cell. In the attached files, I've used the mapping attribute ```maximum``` to get enough red color into the movie. 
If you choose ```minimum``` then you could flag just those sister reunions that are happening privately. Or you choose ```scaling="length"``` and ```mapping="average"``` to average over the cell membrane fractions (as opposed to each neighbor having the same weight independent of contact length, which you get with ```scaling="cell"```, ```mapping="average"```) in contact with neighboring cells (mind the medium).
````

## File: Contributed Examples/CPM/Sister Reunion/model.md
````markdown
The simulation is visualized in this movie linked below the figure: [SisterReunionMovie.mp4][movie].

[movie]: SisterReunionMovie.mp4
````

## File: Contributed Examples/CPM/Sister Reunion/SisterReunion.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>Example-SisterReunion</Title>
        <Details>Demonstration for tracking of MotherId and selective behavior for cell-cell interactions of sister cells from an earlier cell division of the joint mother cell. Such special cell-cell contacts of sisters are flagged by the cell property SisterReunion=1, otherwise 0.

        Date: April 20, 2020
        
        Author: lutz.brusch@tu-dresden.de
        
        Software: Morpheus (open-source), download from https://morpheus.gitlab.io
</Details>
    </Description>
    <Global>
        <Variable value="0.0" symbol="c"/>
        <Constant value="-1" symbol="MotherId"/>
    </Global>
    <Space>
        <Lattice class="hexagonal">
            <Size value="100, 100, 0" symbol="size"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="4e4" symbol="stoptime"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType name="cells" class="biological">
            <Property value="0" symbol="MyId"/>
            <Property value="0" symbol="MotherId"/>
            <Property value="0" symbol="SisterReunion"/>
            <NeighborhoodReporter time-step="1" name="Test Sister Reunion">
                <Input scaling="cell" value="local.MotherId==MotherId"/>
                <Output symbol-ref="SisterReunion" mapping="maximum"/>
            </NeighborhoodReporter>
            <Property value="1e-4" symbol="p" name="proliferation rate"/>
            <Property value="0" symbol="d" name="divisions"/>
            <Property value="0" symbol="c" name="color"/>
            <VolumeConstraint strength="1" target="500"/>
            <SurfaceConstraint strength="1" target="0.9" mode="aspherity"/>
            <System time-step="1.0" solver="euler">
                <Rule symbol-ref="c">
                    <Expression>if( c > 0, c-1, 0)</Expression>
                </Rule>
            </System>
            <CellDivision division-plane="random" orientation="1.0, 0.0, 0.0">
                <Condition>rand_uni(0,1) &lt; p</Condition>
                <Triggers>
                    <Rule symbol-ref="d">
                        <Expression>d+1</Expression>
                    </Rule>
                    <Rule symbol-ref="c" name="color after division">
                        <Expression>1000</Expression>
                    </Rule>
                    <Rule symbol-ref="MotherId">
                        <Expression>MyId</Expression>
                    </Rule>
                </Triggers>
            </CellDivision>
            <DirectedMotion strength="0.1" direction="mod(cell.id,2)-0.5, 0.0, 0.0" name="JustForFunToSeparateSistersAfterDivision"/>
            <Event time-step="10" trigger="when true" name="UpdateMyIdAfterInheritance">
                <Condition>1</Condition>
                <Rule symbol-ref="MyId">
                    <Expression>cell.id</Expression>
                </Rule>
            </Event>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction default="0">
            <Contact value="-4" type2="cells" type1="cells"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1.0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <MetropolisKinetics yield="0.1" temperature="3"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>3</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population size="1" type="cells">
            <InitCircle mode="regular" number-of-cells="1">
                <Dimensions center="50, 50, 0" radius="5"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="100" decorate="true">
            <Terminal name="png"/>
            <Plot title="Recently divided cells are red, Label=cell.id">
                <Cells value="c" max="1" min="0.0">
                    <ColorMap>
                        <Color value="1" color="red"/>
                        <Color value="0.0" color="green"/>
                    </ColorMap>
                </Cells>
                <CellLabels value="cell.id" fontsize="12"/>
            </Plot>
            <Plot title="Reunions of sister cells are red, Label=MotherId">
                <Cells value="SisterReunion" max="1" min="0.0">
                    <ColorMap>
                        <Color value="1" color="red"/>
                        <Color value="0.0" color="green"/>
                    </ColorMap>
                </Cells>
                <CellLabels value="MotherId" fontsize="12"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="100">
            <Input>
                <Symbol symbol-ref="celltype.cells.size"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="10000" log-commands="true">
                    <Style style="linespoints" point-size="0.5" grid="true"/>
                    <Terminal terminal="png"/>
                    <X-axis maximum="stoptime" minimum="0">
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis maximum="100" minimum="0">
                        <Symbol symbol-ref="celltype.cells.size"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
        <DependencyGraph reduced="false" format="svg"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/CPM/Two CPM Cells Adhesion/index.md
````markdown
---
MorpheusModelID: M2006

title: "Two CPM Cells Adhesion"

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true

tags:
- Adhesion
- Adhesion Energy
- Cell-cell Contact
- Cell-medium Contact
- Contact
- Contact Energy
- Cellular Potts Model
- CPM
- Interaction
- Interaction Energy
- Intercellular Contact
- Medium
- SurfaceConstraint
- VolumeConstraint

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> Example demonstrating how adhesion energies affect cell shape and the cell-cell contact region

## Introduction

We simulate two CPM cells of the same type to demonstrate how adhesion energies affect cell shape and the cell-cell contact region.
## Description

Let <span title="//CPM/Interaction/Contact[@type1='amoeba'][@type2='amoeba']/@value">$`J_\mathrm{aa}`$</span> be the adhesion energy between the two cells, and <span title="//CPM/Interaction/Contact[@type1='amoeba'][@type2='medium']/@value">$`J_\mathrm{am}`$</span> be the adhesion energy between each of the cells and the medium.

## Results

The following diagram demonstrates that when the cell-cell contact energy is too high, the cells separate. When the cell-medium contact energy is too high, the cells make as large a region of contact as possible, while also attempting to satisfy their own volume (<span title="//CellTypes/CellType[@name='amoeba']/VolumeConstraint/@target">`VolumeConstraint`</span>) and perimeter constraints (<span title="//CellTypes/CellType[@name='amoeba']/SurfaceConstraint/@target">`SurfaceConstraint`</span>).
![](TwoCPMCellsAdhesion.png "Examples of the effect of cell- cell and cell-medium adhesion energies on the shape and contact region between two CPM cells.")

{{% callout note %}}
As shown in the figure above, **try the following <span title="//CPM/Interaction/Contact[@type1='amoeba'][@type2='amoeba' or @type2='medium']/@value">`Contact`</span> settings**, which default to case a), in the CPM main section of the [Morpheus GUI](/courses/getting-started/have-a-look-around/#model-construction-interface):

| Behavior | Cell-cell <span title="//CPM/Interaction/Contact[@type1='amoeba'][@type2='amoeba']/@value">`Contact` ($`J_\mathrm{aa}`$)</span> | Cell-medium <span title="//CPM/Interaction/Contact[@type1='amoeba'][@type2='medium']/@value">`Contact` ($`J_\mathrm{am}`$)</span> |
|:---:|--------------------:|----------------------:|
| **a)** |              $`10`$ |                 $`4`$ |
| b) |               $`4`$ |                 $`2`$ |
| c) |               $`2`$ |                 $`4`$ |
| d) |               $`4`$ |                $`10`$ |

{{% /callout %}}

<figure>
    ![](M2006_two-cpm-cells-adhesion_movie_behavior-a.mp4)
    <figcaption>Simulation video of <a href="#model"><code>TwoCPMCellsAdhesion.xml</code></a> showing the preset behavior a) with <span title="//CPM/Interaction/Contact[@type1='amoeba'][@type2='amoeba']/@value">$`J_\mathrm{aa} = 10`$</span> and <span title="//CPM/Interaction/Contact[@type1='amoeba'][@type2='medium']/@value">$`J_\mathrm{am} = 4`$</span></figcaption>
</figure>
````

## File: Contributed Examples/CPM/Two CPM Cells Adhesion/model.md
````markdown
![](M2006_two-cpm-cells-adhesion_model-graph.svg "Model Graph")
````

## File: Contributed Examples/CPM/Two CPM Cells Adhesion/TwoCPMCellsAdhesion.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>TwoCPMCellsAdhesion</Title>
        <Details>Full title:		Two CPM Cells Adhesion
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		04.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2006
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Examples of the effect of cell-cell and cell-medium adhesion energies on the shape and contact region between two CPM cells. When the cell-cell contact energy is too high, the cells separate. When the cell-medium contact energy is too high, the cells make as large a region of contact as possible, while also attempting to satisfy their own volume and perimeter constraints. In the CPM main section of the Morpheus GUI, try the following settings: a) cell-cell contact 10, cell-medium contact 4, b) cell-cell contact 4, cell-medium contact 2, c) cell-cell contact 2, cell-medium contact 4, d) cell-cell contact 4, cell-medium contact 10.</Details>
    </Description>
    <Space>
        <Lattice class="square">
            <Size symbol="l" value="150, 150, 0"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime symbol="end" value="750"/>
        <TimeSymbol symbol="time"/>
        <RandomSeed value="1227903"/>
    </Time>
    <CellTypes>
        <CellType class="medium" name="medium"/>
        <CellType class="biological" name="amoeba">
            <VolumeConstraint target="400" strength="1"/>
            <SurfaceConstraint target="70" strength="1" mode="surface"/>
            <ConnectivityConstraint/>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="amoeba" type2="amoeba" value="10"/>
            <Contact type1="amoeba" type2="medium" value="4"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration symbol="MCStime" value="0.5"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="2"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>4</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="amoeba" size="1">
            <InitCircle number-of-cells="2" mode="random">
                <Dimensions radius="l.x/12" center="l.x/2, l.y/2, 0"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="5" decorate="false">
            <Terminal size="400 400 0" name="png"/>
            <Plot>
                <Cells opacity="0.65" max="2" min="1.0" value="cell.id">
                    <ColorMap>
                        <Color value="1" color="red"/>
                        <Color value="2" color="blue"/>
                    </ColorMap>
                </Cells>
            </Plot>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
    <Global/>
</MorpheusModel>
````

## File: Contributed Examples/Multiscale/Anisotropic Release/anisotropic_release.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details></Details>
        <Title>Active transport through cells</Title>
    </Description>
    <Space>
        <Lattice class="square">
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Size value="50, 200, 0" symbol="size"/>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="-x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
                <Condition boundary="-y" type="periodic"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="space"/>
        <MembraneLattice>
            <Resolution value="100" symbol="memsize"/>
            <SpaceSymbol symbol="memspace"/>
            <Annotation>Membrane Lattice is necessary here as a mean to enable Anisotropic secretion towards a specific direction.

Please see the docu for more details on MembraneLattice.</Annotation>
        </MembraneLattice>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="10000"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType name="cell" class="biological">
            <VolumeConstraint target="500" strength="1"/>
            <SurfaceConstraint mode="aspherity" target="1" strength="1"/>
            <MembraneProperty name="membrane substrate" tags="membrane" value="1+sin(-memspace.phi)" symbol="m">
                <Diffusion rate="0.0"/>
                <Annotation>MembraneProperty is handling the directed secretion of the substrate, by defining the concentration as a sine function of the membrane lattice. This way, the concentration can be high on one side and zero on the other side.</Annotation>
            </MembraneProperty>
            <Chemotaxis field="c" strength="0.5">
                <Annotation>Chemotaxis away from the secreted molecule, yielding in cell motility through secretion.</Annotation>
            </Chemotaxis>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction/>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>3</Order>
            </Neighborhood>
        </ShapeSurface>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <MetropolisKinetics temperature="1"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
        </MonteCarloSampler>
    </CPM>
    <CellPopulations>
        <Population size="0" type="cell">
            <InitCellObjects mode="distance">
                <Arrangement repetitions="1, 1, 1" displacements="1, 1, 1">
                    <Sphere center="25,25,0" radius="10"/>
                </Arrangement>
            </InitCellObjects>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="100">
            <Terminal name="png" size="4000, 4000, 0"/>
            <Plot>
                <Cells value="m">
                    <ColorMap>
                        <Color value="2" color="red"/>
                        <Color value="1" color="yellow"/>
                        <Color value="0.0" color="white"/>
                    </ColorMap>
                </Cells>
            </Plot>
            <Plot>
                <Field min="0" max="160" symbol-ref="c"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="-1">
            <Input force-node-granularity="true">
                <Symbol symbol-ref="m"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <SurfacePlot>
                    <Color-bar>
                        <Symbol symbol-ref="m"/>
                    </Color-bar>
                    <Terminal plot-size="400, 800, 0.0" terminal="png"/>
                </SurfacePlot>
            </Plots>
        </Logger>
        <ModelGraph format="dot" include-tags="#untagged" reduced="false"/>
    </Analysis>
    <Global>
        <Field name="global substrate" tags="global" value="0" symbol="c">
            <Diffusion rate="0.01"/>
            <Annotation>Global Field for substrate. This field is initialized as 0 and will then "take up" the substrate that is secreted by the cell.</Annotation>
        </Field>
        <System name="Secretion System" tags="membrane, global" time-step="1.0" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="c">
                <Expression>m - 0.01*c</Expression>
            </DiffEqn>
        </System>
        <Constant name="membrane substrate" tags="membrane" value="0" symbol="m">
            <Annotation>We need to introduce another constant for the substrate in the Global scope to be able to define a membrane property in the Cell scope. </Annotation>
        </Constant>
    </Global>
</MorpheusModel>
````

## File: Contributed Examples/Multiscale/Anisotropic Release/index.md
````markdown
---
MorpheusModelID: M5482

contributors: [Roger, W. de Back, F. El-Hendi]

title: "Anisotropic release from cell"

tags:
- Contributed Examples
- 2D
- PDE
- Diffusion
- Cellular Potts Model
- CPM
- Field
- Field-Cell
- MembraneLattice
- Membrane
- MembraneProperty
- Multiscale
- Chemotaxis

# order
#weight: 20
---

>Membrane pattern allows anisotropic release of substance from cell

## Introduction

This example serves to demonstrate a multiscale model of a cell secreting a substance/molecule and propelling away from the secreted substance. Please also see the built-in docu at ```GUI/Documentation/MorpheuML/Space/MembraneLattice```, ```.../CellType/MembraneProperty``` and ```.../CellType/Chemotaxis```. This example was motivated by [Roger in the Morpheus user forum](https://groups.google.com/g/morpheus-users/c/tw37t651z-0)

## Description

A cell in Morpheus can act in an anisotropic manner by using a heterogeneously patterned ```MembraneProperty``` - here called ```m```. These are ```Properties``` with a spatial resolution (a 1D or 2D array, defined under ```Space/MembraneLattice```) that are mapped to the cell's membrane in polar coordinates in 2D or 3D, respectively. You can use this to represent cell polarity​, i.e. give directionality to processes. 

You first specify a ```Space / MembraneLattice``` and than define your ```CellType / MembraneProperty```. And you can use this as if it were a normal ```Property```, but one that is spatially heterogeneous along the cell membrane. In this example, ```m``` enters the ```Global/System``` for the secreted (and diffusing and degraded) substance ```c```.
You can then use the ```Chemotaxis``` plugin to simulate cell motility that is propelling away from the secreted substance. For that you simply need to specify the global  ```Field```, here "c" as ```field``` in the ```Chemotaxis plugin```. 
Moreover, ```CellType/Mapper``` would allow to couple ```m``` to scalar ```CellType/Property``` if needed. You may also add a separate ```CellType/System``` to dynamically change ```m```.

Movie visualising the secretion of a substance using MembraneLattice and propelling away from it:
![Movie visualising the secretion of a substance using MembraneLattice and propelling away from it.](anisotropic_release.mp4)

The panel shows the membrane concentration "m" of the substance (left) and the global field concentration "c" over time (right).
````

## File: Contributed Examples/Multiscale/Anisotropic Release/model.md
````markdown
![](model-graph.svg "Model Graph.")
````

## File: Contributed Examples/Multiscale/Diffusible Signal/DiffusibleSignal.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Diffusible Signal</Title>
        <Details>Full title:	Example for mass-conserving secretion and uptake of a diffusible signal 
Contributors:L. Brusch
Date:	09.11.2023
Software:	Morpheus (open source). Download from: https://morpheus.gitlab.io
Model ID:	https://identifiers.org/morpheus/M5491
For related models see 
- Autocrine Chemotaxis https://identifiers.org/morpheus/M0031
- Dictyostelium https://identifiers.org/morpheus/M0034
</Details>
    </Description>
    <Global>
        <Constant symbol="cell_density" value="0.0005"/>
        <Field symbol="U.external" value="0">
            <Diffusion rate="0.1"/>
        </Field>
        <System time-step="0.5" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="U.external">
                <Expression>p*U.internal - d*U.external</Expression>
            </DiffEqn>
        </System>
        <Variable symbol="U.total.external" value="0"/>
        <Mapper time-step="1.0" name="U.total.external">
            <Input value="U.external"/>
            <Output symbol-ref="U.total.external" mapping="sum"/>
        </Mapper>
        <Variable symbol="U.total.receiving" value="0"/>
        <Mapper time-step="1.0" name="U.total.receiving">
            <Input value="U.internal*(cell.type==celltype.cell_receiving.id)"/>
            <Output symbol-ref="U.total.receiving" mapping="sum"/>
        </Mapper>
        <Variable symbol="U.total.secreting" value="0"/>
        <Mapper time-step="1.0" name="U.total.secreting">
            <Input value="U.internal*(cell.type==celltype.cell_secreting.id)"/>
            <Output symbol-ref="U.total.secreting" mapping="sum"/>
        </Mapper>
        <Function symbol="U.total">
            <Expression>U.total.external+U.total.secreting+U.total.receiving</Expression>
        </Function>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="200, 200, 0"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <NodeLength value="1.0"/>
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="1000"/>
        <RandomSeed value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType name="medium" class="medium">
            <Constant symbol="p" name="production" value="0.0"/>
            <Constant symbol="d" value="0.0"/>
            <Property symbol="U.internal" value="0.0"/>
        </CellType>
        <CellType name="cell_secreting" class="biological">
            <VolumeConstraint target="60" strength="1"/>
            <SurfaceConstraint target="0.85" strength="1" mode="aspherity"/>
            <Constant symbol="p" value="0.0001"/>
            <Constant symbol="d" value="0.0"/>
            <Property symbol="U.internal" value="1000.0"/>
            <System time-step="0.1" solver="Runge-Kutta [fixed, O(4)]">
                <DiffEqn symbol-ref="U.internal">
                    <Expression>-p*U.internal*cell.volume</Expression>
                </DiffEqn>
            </System>
        </CellType>
        <CellType name="cell_receiving" class="biological">
            <VolumeConstraint target="60" strength="1"/>
            <SurfaceConstraint target="0.85" strength="1" mode="aspherity"/>
            <Chemotaxis strength="100" field="U.external"/>
            <Constant symbol="p" value="0.0"/>
            <Constant symbol="d" value="0.02"/>
            <Constant symbol="U.threshold" value="500.0"/>
            <Property symbol="U.uptake" value="0.0"/>
            <Property symbol="U.internal" value="0.0"/>
            <Property symbol="U.superthreshold" value="0.0"/>
            <Mapper time-step="1.0" name="Uptake of U">
                <Input value="d*U.external"/>
                <Output symbol-ref="U.uptake" mapping="sum"/>
            </Mapper>
            <System time-step="0.1" solver="Runge-Kutta [fixed, O(4)]">
                <DiffEqn symbol-ref="U.internal">
                    <Expression>U.uptake</Expression>
                </DiffEqn>
                <Rule symbol-ref="U.superthreshold">
                    <Expression>U.internal > U.threshold</Expression>
                </Rule>
            </System>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction default="0.0">
            <Contact type2="medium" type1="cell_secreting" value="-10"/>
            <Contact type2="medium" type1="cell_receiving" value="-10"/>
            <Contact type2="cell_secreting" type1="cell_receiving" value="10"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1.0"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="10.0"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Order>optimal</Order>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="cell_secreting" size="0">
            <InitRectangle mode="random" number-of-cells="cell_density * size.x * size.y">
                <Dimensions origin="0.0, 0.0, 0.0" size="size.x, size.y, 0"/>
            </InitRectangle>
        </Population>
        <Population type="cell_receiving" size="0">
            <InitRectangle mode="regular" number-of-cells="cell_density /2 * size.x * size.y">
                <Dimensions origin="0.0, 0.0, 0.0" size="size.x, size.y, 0"/>
            </InitRectangle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="50" decorate="true">
            <Terminal name="png" persist="true"/>
            <Plot>
                <Field surface="true" symbol-ref="U.external" max="5.0" isolines="5" min="0.0"/>
                <Cells opacity="0.55" max="1000" min="0" value="U.internal">
                    <ColorMap>
                        <Color color="gray" value="0"/>
                        <Color color="blue" value="500"/>
                        <Color color="green" value="501"/>
                        <Color color="dark-green" value="1000"/>
                    </ColorMap>
                </Cells>
                <CellLabels value="U.superthreshold"/>
            </Plot>
        </Gnuplotter>
        <ModelGraph include-tags="#untagged" format="svg" reduced="false"/>
        <Logger time-step="1.0">
            <Input/>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="-1">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="U.total.external"/>
                        <Symbol symbol-ref="U.total.secreting"/>
                        <Symbol symbol-ref="U.total.receiving"/>
                        <Symbol symbol-ref="U.total"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/Multiscale/Diffusible Signal/index.md
````markdown
---
MorpheusModelID: M5491

contributors: [L. Brusch]

title: Mass-conserving secretion and uptake of a diffusible signal
date: "2023-11-09T10:42:00+02:00"
lastmod: "2023-11-09T14:49:00+01:00"

tags:
- 2D
- Adhesion
- Cellular Potts Model
- Chemotaxis
- CPM
- Mass Conservation
- Multicellular Model
- Partial Differential Equation
- PDE
- Secretion
- Signaling
- Spatial Model
- Stochastic Model
- Uptake

---

## Introduction

The mass-conserving secretion and uptake of (signaling) molecules by cells can in Morpheus be achieved with ```Mappers``` and scaling fluxes by ```cell.volume```. The intracellular amount of signal may trigger a change in a state variable that could downstream change cell behaviors. 

This model, motivated by the [user forum](https://groups.google.com/g/morpheus-users/c/NP0sSKlvMRc), shall demonstrate how such signaling processes can be coupled via a global field of diffusible molecules and how conservation of mass can be monitored over populations of cells. 

## Description

There are two cell types (besides medium): ```cell_secreting``` (which secretes signal ```U``` with flux ```p``` into the ```Global/Field``` ```U.external```) and ```cell_receiving``` (which takes ```U``` up from ```U.external``` with rate ```d``` and accumulates it in ```U.internal```, when ```U.internal``` exceeds ```U.threshold=500``` then ```cell_receiving``` changes its state ```U.superthreshold``` from 0 to 1). The chosen CPM settings let cells of different types repel each other and let ```cell_receiving``` chemotax upward the ```U.external``` gradient. The number (0 or 1) plotted in each receiving cell is the state of ```U.superthreshold```.

Please also see the descriptions of related models like [Autocrine chemotaxis](https://identifiers.org/morpheus/M0031) and the cAMP dynamics during [Dictyostelium aggregation](https://identifiers.org/morpheus/M0034). Moreover, the field ```U.external``` may get extra reaction terms, see this [Example](https://identifiers.org/morpheus/M0012).

![](plot_00020.png "Snapshot at time=20 showing the initial cell states (secreting cells in green and without any number, receiving cells in gray with the number 0).")

![](plot_00500.png "Snapshot at time=500 showing the concentration fields change (yellow/red colors in background with contour lines) and changed amounts of signaling molecules inside cells as given by the color bar.")

![](movie.mp4)
The video shows how the secreting cells (initially green and without any number) lose the signal (corresponding to color bar), how the concentration fields change (yellow/red colors in background with contour lines) and receiving cells (with a number) take up the signal (change color from gray to blue and then green corresponding to color bar). When a threshold of internalized signal is crossed, then receiving cells change their state from 0 to 1 (shown as number inside receiving cells). Receiving cells chemotax upward in the gradient of the concentration field.

![](logger.png "Time courses of sums of signals in all secreting, receiving cells as well as the extracellular field show that the total amount is conserved.")
````

## File: Contributed Examples/Multiscale/Diffusible Signal/model.md
````markdown
![](model-graph.svg "Model Graph")
````

## File: Contributed Examples/Multiscale/Synapse/chemical_synapse.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Anisotropic secretion into chemical synapse</Title>
        <Details>Multiscale model  of a cell secreting a substance/molecule into a chemical synapse between two cells. The second cell senses this substance. The focus of this demonstration model lies on anisotropic secretion at the border of the first cell.</Details>
    </Description>
    <Global>
        <System time-step="1.0" name="Secretion System" solver="Runge-Kutta [fixed, O(4)]" tags="membrane, global">
            <DiffEqn symbol-ref="c">
                <Expression>m2field*contact2medium - 0.005*c</Expression>
            </DiffEqn>
        </System>
        <Field symbol="c" name="global substrate" tags="global" value="0">
            <Diffusion rate="0.2*max(ismedium,m2field*contact2medium)"/>
            <Annotation>Global Field for substrate. This field is initialized as 0 and will then "take up" the substrate that is secreted by the cell.</Annotation>
        </Field>
        <Constant symbol="m" name="membrane substrate" tags="membrane" value="0">
            <Annotation>We need to introduce another constant for the substrate in the Global scope to be able to define a membrane property in the Cell scope. </Annotation>
        </Constant>
        <Field symbol="U2" name="technical helper chemoattractant cell type 1" value="exp(-(space.y-size.y/2)^2/5^2)"/>
        <Constant symbol="dec" value="0.0">
            <Annotation>dummy to have dec defined everywhere</Annotation>
        </Constant>
        <Field symbol="U3" name="technical helper chemoattractant cell type 1" value="exp(-(space.y-size.y/2-5)^2/5^2)"/>
        <Field symbol="contact2medium" value="0.0"/>
        <Field symbol="m2field" value="0.0"/>
        <NeighborhoodReporter>
            <Input value="ismedium"/>
            <Output symbol-ref="contact2medium" mapping="maximum"/>
        </NeighborhoodReporter>
        <Event compute-time="on-execution" trigger="when-true" time-step="1.0">
            <Condition>1</Condition>
            <Rule symbol-ref="m2field">
                <Expression>m</Expression>
            </Rule>
        </Event>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="100, 100, 0"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <NodeLength value="1.0"/>
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
        <MembraneLattice>
            <Resolution symbol="memsize" value="100"/>
            <SpaceSymbol symbol="memspace"/>
            <Annotation>Membrane Lattice is necessary here as a mean to enable Anisotropic secretion towards a specific direction.

Please see the docu for more details on MembraneLattice.</Annotation>
        </MembraneLattice>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="3.5e4"/>
        <SaveInterval value="0"/>
        <RandomSeed value="2"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType name="medium" class="medium">
            <Constant symbol="neighbors" value="0.0"/>
            <Constant symbol="p" name="production" value="0.0"/>
            <Property symbol="ismedium" value="1"/>
        </CellType>
        <CellType name="release" class="biological">
            <Property symbol="cs" name="chemotactic strength" value="100.0"/>
            <Property symbol="p" name="production chemoattractant" value="0.01"/>
            <VolumeConstraint target="500" strength="1"/>
            <SurfaceConstraint target="0.85" strength="1" mode="aspherity"/>
            <MembraneProperty symbol="m" name="membrane substrate" tags="membrane" value="0">
                <Diffusion rate="0.0"/>
                <Annotation>MembraneProperty is handling the directed secretion of the substrate, by defining the concentration as a sine function of the membrane lattice. This way, the concentration can be high on one side and zero on the other side.</Annotation>
            </MembraneProperty>
            <Property symbol="direction" value="0"/>
            <Event compute-time="on-execution" trigger="when-true" time-step="1.0">
                <Condition>1</Condition>
                <Rule symbol-ref="m">
                    <Expression>memspace.phi>(pi/2-0.2) &amp;&amp; memspace.phi&lt;(pi/2+0.2)</Expression>
                </Rule>
            </Event>
            <Chemotaxis contact-inhibition="false" strength="cs" field="U2" retraction="true"/>
            <Property symbol="dec" value="0.0"/>
            <Property symbol="ismedium" value="0.0"/>
        </CellType>
        <CellType name="sense" class="biological">
            <Property symbol="cs" name="chemotactic strength" value="100.0"/>
            <Property symbol="p" name="production chemoattractant" value="0.01"/>
            <VolumeConstraint target="500" strength="1"/>
            <SurfaceConstraint target="0.85" strength="1" mode="aspherity"/>
            <Property symbol="direction" value="0"/>
            <Chemotaxis contact-inhibition="false" strength="cs" field="U3" retraction="true"/>
            <Property symbol="dec" value="0.1"/>
            <Property symbol="ismedium" value="0.0"/>
            <Chemotaxis strength="1" field="c"/>
            <Mapper>
                <Input value="c"/>
                <Output symbol-ref="maxc" mapping="maximum"/>
            </Mapper>
            <Property symbol="maxc" value="0.0"/>
        </CellType>
    </CellTypes>
    <CPM>
        <Interaction default="0.0">
            <Contact type2="medium" type1="sense" value="-10"/>
            <Contact type2="medium" type1="release" value="20"/>
            <Contact type2="sense" type1="release" value="20"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1.0"/>
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="10.0"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population type="release" size="1">
            <InitRectangle mode="regular" number-of-cells="1">
                <Dimensions origin="size.x/2,size.y/2-30/2,0" size="1.0, 1.0, 1.0"/>
            </InitRectangle>
            <InitProperty symbol-ref="direction">
                <Expression>-1</Expression>
            </InitProperty>
        </Population>
        <Population type="sense" size="1">
            <InitRectangle mode="regular" number-of-cells="1">
                <Dimensions origin="size.x/2,size.y/2+30/2,0" size="1.0, 1.0, 1.0"/>
            </InitRectangle>
            <InitProperty symbol-ref="direction">
                <Expression>+1</Expression>
            </InitProperty>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="100" decorate="false">
            <Terminal name="png" persist="true"/>
            <Plot>
                <Field surface="true" symbol-ref="c" isolines="10" min="0.0"/>
                <Cells opacity="0.55" value="cell.type">
                    <ColorMap>
                        <Color color="red" value="2"/>
                        <Color color="blue" value="1"/>
                    </ColorMap>
                </Cells>
            </Plot>
            <!--    <Disabled>
        <Plot>
            <Field symbol-ref="U2"/>
        </Plot>
    </Disabled>
-->
            <!--    <Disabled>
        <Plot>
            <Field symbol-ref="U3"/>
        </Plot>
    </Disabled>
-->
            <Plot>
                <Cells value="m"/>
            </Plot>
        </Gnuplotter>
        <ModelGraph include-tags="#untagged,global,membrane" format="svg" reduced="false"/>
        <Logger time-step="1.0">
            <Input>
                <Symbol symbol-ref="maxc"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Restriction>
                <Celltype celltype="sense"/>
            </Restriction>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/Multiscale/Synapse/index.md
````markdown
---
MorpheusModelID: M1175

contributors: [Robert Mueller]

title: "Chemical synapse"

tags:
- Contributed Examples
- 2D
- PDE
- Diffusion
- Cellular Potts Model
- CPM
- Field
- Field-Cell
- MembraneLattice
- Membrane
- MembraneProperty
- Multiscale
- Chemotaxis

# order
#weight: 20
---

>Membrane pattern allows anisotropic release of substance into a chemical synapse

## Introduction

Special cell types, like neurons or immune cells, communicate through a chemical synapse. This includes the anisotropic secretion of a substance into the gap between two cells.
This example serves to demonstrate a multiscale model of one cell releasing a substance into the medium and another cell close by sensing this substance. 
Please also see the in-app docu for ```GUI / Documentation / MorpheusML / Space/MembraneLattice```, ```.../ CellType / MembraneProperty``` and ```.../ CellType / Chemotaxis```. 
This example was motivated by Kevin Thurley (personal communication) and is derived from the more general demo model
[Anisotropic release from cell](https://morpheus.gitlab.io/model/m5482/).

## Description

A cell in Morpheus can act in an anisotropic manner by using a heterogeneously patterned ```MembraneProperty``` - here called ```m```. These are ```Properties``` with a spatial resolution 
(a 1D or 2D array, defined under Space/MembraneLattice) that are mapped to the cell’s membrane in polar coordinates in 2D or 3D, respectively. One can use this to represent cell polarity and give directionality to processes. 

In Morpheus, ```Space / MembraneLattice``` and subsequently ```CellType / MembraneProperty``` ```m``` are specified. One can use this as if it were a normal ```Property```, but one that 
is spatially  heterogeneous along the cell membrane. For technical reasons, ```m``` then has to be cast into a global field ```m2field``` using ```CellType / Mapper```.

In case of substance release into the chemical synapse it is relevant to limit the release to the border pixels of the cell. The second property 
```contact2medium``` is obtained via ```Global / NeighbourhoodReporter``` and indicates that the respective pixels belong to the boundary of a cell.

The product ```m2field*contact2medium``` enters the ```Global / System``` for the secreted (and diffusing and degraded) substance ```c```, limiting release of ```c``` to cell 
boundary pixels and to a direction given by the pattern in ```m```.

For demonstration purposes, the sensing cell (red in movie) calculates the average of the ```c``` concentration and writes it to an ```Analysis / Logger```  

Position and movement of the cells are artificially constructed for demonstration purposes only. Chemotaxis (```Chemotaxis plugin```) to the special shaped technical helper 
fields U2 and U3 approximately keeps the cells at a defined vertical (```y```) value without hampering horizontal fluctuations too much. 
The sensing cell (red in movie) has a weak additional chemotactic term to the field c, keeping it near the releasing cell (blue in movie). 

Movie visualising the secretion of a substance into a chemical synapse using MembraneLattice:
![Movie visualising the secretion of a substance into a chemical synapse using MembraneLattice.](chemical_synapse.mp4)

The two panels of the same simulation show the global field concentration ```c``` (left) and the membrane concentration ```m``` of the substance (right) over time.
````

## File: Contributed Examples/Multiscale/Synapse/model.md
````markdown
![](model-graph.svg "Model Graph.")
````

## File: Contributed Examples/ODE/Actin Waves (Well-mixed)/index.md
````markdown
---
MorpheusModelID: M2012

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

title: Well-mixed Actin Waves

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true
#  preprint: false

tags:
- Actin
- Actin Wave
- Bistable System
- GTPase
- F-actin
- Filament
- Microfilament
- Negative Feedback
- ODE
- Ordinary Differential Equation
- Oscillation
- Wave
- Well-mixed

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> ODEs for GTPase interacting with F-actin

## Introduction

Here, we explore the time behavior of a well-mixed GTPase model with negative feedback from F-actin to the GTPase.

## Description

We assume that GTPase (<span title="//Global/Variable[@symbol='a']">$`G`$</span>) leads to actin assembly, and that F-actin, denoted by the variable (<span title="//Global/Variable[@symbol='F_a']">$`F`$</span>), leads to GTPase inactivation:

$$\begin{align}
\frac{\mathrm dG}{\mathrm dt} &= (b + \gamma \frac{G^n}{1 + G^n})G_i - G(\eta + sF) \\\\
\frac{\mathrm dF}{\mathrm dt} &= \epsilon(k_nG - k_sF) \\\\
\end{align}$$

## Results

The model illustrates that cycling can ocurr in a bistable system with some negative feedback as shown in the figure below.

![](ActinWavesMorpheusWM.png "In the well-mixed single GTPase model, when actin negative feedback is included, the system can begin to oscillate. In the Morpheus model, <span title='//Global/Variable[@symbol=&#39;a&#39;]'>$`a`$</span> represents active GTPase (denoted by <span title='//Global/Variable[@symbol=&#39;a&#39;]'>$`G`$</span> in the [ODEs above](#description)) and <span title='//Global/Variable[@symbol=&#39;F_a&#39;]'>$`F_a`$</span> (denoted by <span title='//Global/Variable[@symbol=&#39;F_a&#39;]'>$`F`$</span> [above](#description)) is the filamentous actin.")
````

## File: Contributed Examples/ODE/Actin Waves (Well-mixed)/model.md
````markdown
![](M2012_well-mixed-actin-waves_model-graph.svg "Model Graph")
````

## File: Contributed Examples/ODE/Actin Waves (Well-mixed)/wellmixedactinwaves.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Actin Waves - well-mixed</Title>
        <Details>Full title:		Well-mixed Actin Waves
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		23.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2012
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		ODEs for GTPase interacting with F-actin. Illustrates that cycling can ocurr in a bistable system with some negative feedback. The GTPase equations in well-mixed form can be written in terms of the active GTPase and the amount (total - active) of the inactive GTPase. Here, a = active GTPase, F_a = F-actin concentration. Everything is well-mixed and two ODEs are solved for these two variables.</Details>
    </Description>
    <Global>
        <!--
Define the variables and indicate the method used to integrate the ODEs
-->
        <Variable symbol="a" value="2.2"/>
        <Variable symbol="F_a" value="1.3"/>
        <System time-step="0.1" solver="Runge-Kutta [fixed, O(4)]">
            <!--
Define a bunch of constants that appear in the ODEs
-->
            <Constant symbol="b" name="basal activation rate" value="0.067"/>
            <Constant symbol="gamma" name="feedback rate" value="2.0"/>
            <Constant symbol="n" name="Hill coefficient" value="3"/>
            <Constant symbol="k_n" name="Actin nucleation rate" value="11"/>
            <Constant symbol="k_s" name="Actin disassembly rate" value="2"/>
            <Constant symbol="eta" name="basal GTPase decay rate" value="0.5"/>
            <Constant symbol="s" name="actin-dependent GTPase decay rate" value="0.5"/>
            <Constant symbol="F_0" name="actin set point" value="1"/>
            <Constant symbol="epsilon" name="actin reaction rate" value="0.01"/>
            <Constant symbol="Tot" name="Total mean GTPase conc" value="4"/>
            <!--
For each variable, indicate that it satisfies a differential equation and
give the expression on the RHS of that ODE. The inactive GTPase is not
needed in the well-mixed system, so its ODE is commented out. It will be
needed once a PDE (spatially distributed) version of them odel is studied.
-->
            <DiffEqn symbol-ref="a">
                <!--              <Expression> (b+gamma*a^n/(1+a^n))*(Tot-a)- a*(eta+s*F_a/(F_0+F_a))  </Expression>
-->
                <Expression> (b+gamma*a^n/(1+a^n))*(Tot-a)- a*(eta+s*F_a)  </Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="F_a">
                <Expression> epsilon*(k_n*a-k_s*F_a)</Expression>
            </DiffEqn>
        </System>
    </Global>
    <!--
Define the spatial domain
-->
    <Space>
        <Lattice class="linear">
            <Size symbol="size" value="1, 0, 0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <!--
Set up the simulation StopTime
-->
    <Time>
        <StartTime value="0"/>
        <StopTime symbol="stoptime" value="500"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <!--
Set up what is to be plotted and how
-->
    <Analysis>
        <Logger time-step="5">
            <Input>
                <Symbol symbol-ref="a"/>
                <Symbol symbol-ref="F_a"/>
            </Input>
            <Plots>
                <Plot time-step="-1">
                    <Style line-width="2.0" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="a"/>
                        <Symbol symbol-ref="F_a"/>
                    </Y-axis>
                </Plot>
            </Plots>
            <Output>
                <TextOutput/>
            </Output>
        </Logger>
        <ModelGraph format="dot" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/ODE/FitzHugh–Nagumo/FN.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>FitzHugh–Nagumo ODEs</Title>
        <Details>Full title:		FitzHugh–Nagumo ODEs
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		10.05.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2005
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		ODEs for the FN well-mixed system. The FN equations are commonly used as a toy model for neuronal excitation. u = "voltage", v = "recovery variables". Everything is well-mixed and two ODEs are solved for two variables, u and v.</Details>
    </Description>
    <Global>
        <Variable symbol="u" name="Voltage" value="1"/>
        <Variable symbol="v" name="Recovery Variable" value="1"/>
        <System time-step="0.1" solver="Runge-Kutta [fixed, O(4)]">
            <Constant symbol="a" name="middle value" value="0.25"/>
            <Constant symbol="b" name="v decay rate" value="1.0"/>
            <Constant symbol="epsilon" name="slow relative timescale" value="0.05"/>
            <Constant symbol="I_0" name="Stimulus" value="0.25"/>
            <DiffEqn symbol-ref="u">
                <Expression> u*(1-u)*(u-a)-v + I_0  </Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="v">
                <Expression> epsilon*(u-b*v)</Expression>
            </DiffEqn>
        </System>
    </Global>
    <Space>
        <Lattice class="linear">
            <Size symbol="size" value="1, 0, 0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime symbol="stoptime" value="200"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Analysis>
        <Logger time-step="1">
            <Input>
                <Symbol symbol-ref="u"/>
                <Symbol symbol-ref="v"/>
            </Input>
            <Plots>
                <Plot time-step="-1">
                    <Style line-width="2.0" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="u"/>
                        <Symbol symbol-ref="v"/>
                    </Y-axis>
                </Plot>
            </Plots>
            <Output>
                <TextOutput/>
            </Output>
        </Logger>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/ODE/FitzHugh–Nagumo/index.md
````markdown
---
MorpheusModelID: M2005

title: "FitzHugh–Nagumo ODEs"

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true

tags:
- Bonhoeffer–Van der Pol Oscillator
- Excitable System
- Excitation
- FHN
- FitzHugh–Nagumo
- FitzHugh–Nagumo Model
- FN
- Neuron
- Neuronal Excitation
- Neuronal Firing
- ODE
- Ordinary Differential Equation
- Oscillator
- Relaxation Oscillator
- Well-mixed
- Well-mixed Model
- Well-mixed System

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> ODEs for the FitzHugh–Nagumo well-mixed system

## Introduction

The FitzHugh–Nagumo (FN) model is commonly used as a toy model for neuronal excitation.
## Description

Everything is well-mixed and two ODEs are solved for two variables, <span title="//Global/Variable[@symbol='u']">$`u`$</span> (voltage) and <span title="//Global/Variable[@symbol='v']">$`v`$</span> (recovery variable).

## Results

The figure below shows behavior of the FitzHugh–Nagumo ODEs, the variables <span title="//Global/Variable[@symbol='u']">$`u`$</span>, <span title="//Global/Variable[@symbol='v']">$`v`$</span> are plotted against time.

![](FN.png "Variables <span title='//Global/Variable[@symbol=&#39;u&#39;]'>$`u`$</span>, <span title='//Global/Variable[@symbol=&#39;v&#39;]'>$`v`$</span> plotted against time.")
````

## File: Contributed Examples/ODE/FitzHugh–Nagumo/model.md
````markdown
![](M2005_fitzhugh-nagumo_model-graph.svg "Model Graph")
````

## File: Contributed Examples/ODE/Integrate and Fire/index.md
````markdown
---
MorpheusModelID: M2004

title: "Integrate and Fire"

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true

tags:
- Discontinuous Output
- Excitable System
- Excitation
- Integrate-and-fire
- Integrate-and-fire Model
- Neuron
- Neuronal Excitation
- Neuronal Firing
- ODE
- Ordinary Differential Equation

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> Simple model for neuronal firing

## Introduction

This is one of the simplest models used to depict neuronal firing.
## Description

A simple model for neuronal firing consists of the basic ‘integrate-and-fire’ system ODE:

$$\begin{align}
\frac{dV}{dt}=a_1, V=0 \text{ whenever } V \geq V_t
\end{align}$$

## Results

Here, the voltage builds up at a constant rate <span title="//Global/System/Constant[@symbol='a1']">$`a_1`$</span>. Once the voltage <span title="//Global/Variable[@symbol='Voltage']">$`V`$</span> reaches a set value (in this example, <span title="//Global/Variable[@symbol='Vt']">$`V_t = 10`$</span>), it is reset to zero, as shown in the following figure.

![](IntegrateAndFire.png "The simple integrate-and-fire model produces discontinuous output.")
````

## File: Contributed Examples/ODE/Integrate and Fire/IntegrateAndFire.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>Integrate and fire</Title>
        <Details>Full title:		Integrate and Fire
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		11.05.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2004
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Basic integrate and fire model. This is one of the simplest models used to depict neuronal firing. Voltage, V, is constantly increasing until it gets to some threshold, Vt. Then it is reset to zero. Simulation shows how to reset a variable that satisfies a differential equation so as to produce a discontinuous output.</Details>
    </Description>
    <Global>
        <Variable symbol="Voltage" name="Voltage" value="0"/>
        <Variable symbol="Vt" name="Voltage at reset" value="10"/>
        <System time-step="4e-2" time-scaling="1" solver="Runge-Kutta [fixed, O(4)]">
            <Constant symbol="a1" value="0.1"/>
            <Annotation>
Specify the differential equation for the variable. In this case,
Voltage is just increasing at a constant rate a1.
</Annotation>
            <DiffEqn symbol-ref="Voltage">
                <Expression>a1</Expression>
            </DiffEqn>
        </System>
        <Event trigger="when-true" name="reset Voltage">
            <Condition history="false">Voltage>Vt</Condition>
            <Rule symbol-ref="Voltage">
                <Expression>0</Expression>
            </Rule>
        </Event>
    </Global>
    <Time>
        <StartTime value="0"/>
        <StopTime symbol="stoptime" value="400"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Analysis>
        <Logger time-step="1">
            <Input>
                <Symbol symbol-ref="Vt"/>
            </Input>
            <Plots>
                <Plot time-step="-1">
                    <Style line-width="2.0" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="Voltage"/>
                    </Y-axis>
                </Plot>
            </Plots>
            <Output>
                <TextOutput/>
            </Output>
        </Logger>
        <ModelGraph format="dot" reduced="false" include-tags="#untagged"/>
    </Analysis>
    <Space>
        <Lattice class="linear">
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Size symbol="size" value="100,  0.0,  0.0"/>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
</MorpheusModel>
````

## File: Contributed Examples/ODE/Integrate and Fire/model.md
````markdown
![](M2004_integrate-and-fire_model-graph.svg "Model Graph")
````

## File: Contributed Examples/PDE/Actin Waves/ActinWavesPDE_2D.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Actin Waves (PDE) in 2D</Title>
        <Details>Full title:		Actin Waves
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		23.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2013
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		PDE model for F-actin negative feedback to GTPases, and GTPase promotion of F-actin. Simulated in a 2D square domain. Adapted from W. Holmes, A. Carlsson, L. Edelstein-Keshet: Regimes of wave type patterning driven by refractory actin feedback: transition from static polarization to dynamic wave behaviour. Physical Biology 9(4), 046005 (2012). a =  active GTPases, i = inactive GTPase, F_a = F-actin.</Details>
    </Description>
    <!--
 Define the variables and initialize their values.
 Indicate the rates of diffusion
 GTPases diffusem but F-actin does not
-->
    <Global>
        <Field symbol="a" name="activeGTPase" value="1.5+0.7*(0.5-rand_norm(1,0.5))">
            <Diffusion rate="0.01"/>
        </Field>
        <Field symbol="i" name="Inactive" value="2.0">
            <Diffusion rate="1"/>
        </Field>
        <Field symbol="F_a" name="F-actin" value="1.3">
            <Diffusion rate="0.0"/>
        </Field>
        <!--
 Specify the method of solution and give the kinetic terms
 in the differential equations for the three variables
-->
        <System time-step="0.05" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="a">
                <Expression> i*(b+gamma*a^n/(1+a^n))- a*(eta+s*F_a) </Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="i">
                <Expression> -i*(b+gamma*a^n/(1+a^n))+ a*(eta+s*F_a)</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="F_a">
                <Expression> epsilon*(k_n*a-k_s*F_a)</Expression>
            </DiffEqn>
            <!--
  Define the constants and give their values.
-->
            <Constant symbol="b" name="basal activation rate" value="0.067"/>
            <Constant symbol="gamma" name="feedback rate" value="4.5"/>
            <Constant symbol="n" name="Hill coefficient" value="3"/>
            <Constant symbol="k_n" name="Actin nucleation rate" value="20"/>
            <Constant symbol="k_s" name="Actin disassembly rate" value="2"/>
            <Constant symbol="eta" name="basal GTPase decay rate" value="0.5"/>
            <Constant symbol="s" name="actin-dependent GTPase decay rate" value="0.5"/>
            <Constant symbol="F_0" name="actin set point" value="1"/>
            <Constant symbol="epsilon" name="actin reaction rate" value="0.01"/>
        </System>
    </Global>
    <!--
Specify the 2D Domain ("Square" lattice) and its boundary conditions
Indicate the size of each spatial box
-->
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="100, 100, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="y"/>
            </BoundaryConditions>
            <NodeLength value="0.02"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <!--
  Set the start and end time and any random seed needed
-->
    <Time>
        <StartTime value="0"/>
        <StopTime value="200"/>
        <SaveInterval value="0"/>
        <RandomSeed value="3451"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <!--
 Specify how the results should be plotted
-->
    <Analysis>
        <Gnuplotter time-step="5" decorate="false">
            <Terminal size="400 400 0" name="png"/>
            <!--
Side by side plots of the active GTPase and the F-Actin
A color scheme an be specified  (e.g. for F-actin)
Both plots are on the same "terminal"
-->
            <Plot>
                <Field symbol-ref="a" min="0"/>
            </Plot>
            <Plot>
                <Field symbol-ref="F_a">
                    <ColorMap>
                        <Color value="12.0" color="blue"/>
                        <Color value="10.0" color="green"/>
                        <Color value="8.0" color="yellow"/>
                        <Color value="6.0" color="white"/>
                    </ColorMap>
                </Field>
            </Plot>
        </Gnuplotter>
        <Logger time-step="50">
            <Input>
                <Symbol symbol-ref="a"/>
            </Input>
            <Output>
                <TextOutput file-format="csv"/>
            </Output>
            <Plots>
                <!--
Make a line plot showing the profiles of all three variables
    -->
                <Plot time-step="0">
                    <Style line-width="3.0" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="space.x"/>
                    </X-axis>
                    <Y-axis minimum="0" maximum="12">
                        <Symbol symbol-ref="a"/>
                        <Symbol symbol-ref="i"/>
                        <Symbol symbol-ref="F_a"/>
                    </Y-axis>
                    <!--
   Creates that plot once at the end of the simulation
-->
                    <Range>
                        <Data/>
                        <Time mode="current"/>
                    </Range>
                </Plot>
            </Plots>
            <Restriction>
                <Slice axis="y" value="size.y/2"/>
            </Restriction>
            <!--
Indicates that the line plot is for a slice midway up the y axis
-->
        </Logger>
        <!--
Make a kimograph of the variable a
that shows how a 1D slice midway up the y axis
develops over time.
-->
        <Logger time-step="1">
            <Input>
                <Symbol symbol-ref="a"/>
            </Input>
            <Plots>
                <SurfacePlot time-step="1">
                    <Color-bar>
                        <Symbol symbol-ref="a"/>
                    </Color-bar>
                    <Terminal terminal="png"/>
                </SurfacePlot>
            </Plots>
            <Restriction>
                <Slice axis="y" value="size.y/2"/>
            </Restriction>
            <Output>
                <TextOutput/>
            </Output>
        </Logger>
        <ModelGraph format="dot" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Actin Waves/ActinWavesPDE_main.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Actin Waves (PDE) in 1D</Title>
        <Details>Full title:		Actin Waves
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		23.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2013
File type:		Main model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Simulations of F-actin negative feedback to the wave-pinning GTPase model produced the actin waves PDE system. Here we simulate this in 1D, showing profiles of the variables over space and time, as well as kymographs of the active GTPase and the F-actin summarizing the entire dynamics.</Details>
    </Description>
    <Global>
        <Field symbol="a" name="activeGTPase" value="1.5+0.7*(0.5-rand_norm(1,0.5))">
            <Diffusion rate="0.01"/>
        </Field>
        <Field symbol="i" name="Inactive" value="2.0">
            <Diffusion rate="1"/>
        </Field>
        <Field symbol="F_a" name="F-actin" value="1.3">
            <Diffusion rate="0.0"/>
        </Field>
        <System time-step="0.05" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="a">
                <Expression> i*(b+gamma*a^n/(1+a^n))- a*(eta+s*F_a) </Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="i">
                <Expression> -i*(b+gamma*a^n/(1+a^n))+ a*(eta+s*F_a)</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="F_a">
                <Expression> epsilon*(k_n*a-k_s*F_a)</Expression>
            </DiffEqn>
            <Constant symbol="b" name="basal activation rate" value="0.067"/>
            <Constant symbol="gamma" name="feedback rate" value="4.5"/>
            <Constant symbol="n" name="Hill coefficient" value="3"/>
            <Constant symbol="k_n" name="Actin nucleation rate" value="20"/>
            <Constant symbol="k_s" name="Actin disassembly rate" value="2"/>
            <Constant symbol="eta" name="basal GTPase decay rate" value="0.5"/>
            <Constant symbol="s" name="actin-dependent GTPase decay rate" value="0.5"/>
            <Constant symbol="F_0" name="actin set point" value="1"/>
            <Constant symbol="epsilon" name="actin reaction rate" value="0.001"/>
        </System>
    </Global>
    <Space>
        <Lattice class="linear">
            <Size symbol="size" value="100, 0, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
            </BoundaryConditions>
            <NodeLength value="0.02"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="6000"/>
        <SaveInterval value="0"/>
        <!--    <Disabled>
        <RandomSeed value="1"/>
    </Disabled>
-->
        <TimeSymbol symbol="time"/>
    </Time>
    <Analysis>
        <Logger time-step="50">
            <Input>
                <Symbol symbol-ref="a"/>
                <Symbol symbol-ref="i"/>
                <Symbol symbol-ref="F_a"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="10" title="space plot">
                    <Style line-width="3.0" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="space.x"/>
                    </X-axis>
                    <Y-axis minimum="0" maximum="10">
                        <Symbol symbol-ref="a"/>
                        <Symbol symbol-ref="i"/>
                        <Symbol symbol-ref="F_a"/>
                    </Y-axis>
                    <Range>
                        <Time mode="current"/>
                    </Range>
                </Plot>
                <Plot time-step="-1" title="time-space plot">
                    <Style decorate="true" point-size="2" style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="space.x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="time"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="a"/>
                    </Color-bar>
                </Plot>
                <Plot time-step="-1" title="time-space plot">
                    <Style decorate="true" point-size="2" style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="space.x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="time"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="F_a"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="dot" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Actin Waves/index.md
````markdown
---
MorpheusModelID: M2013

title: Actin Waves

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true
#  preprint: false

tags:
- 1D
- 2D
- Actin
- Actin Wave
- F-actin
- Filament
- Lattice
- Linear Lattice
- Microfilament
- Partial Differential Equation
- PDE
- Reaction Rate
- Square Lattice
- Wave
- Well-mixed

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> Spatial relaxation oscillator produces spatial dynamics and spiral waves

## Introduction

We consider a full spatial variant of the <a href="/model/m2012/" title="<i class='fas fa-dna pr-1'></i>Morpheus Model ID: <code class='model-id-tooltip'>M2012</code>">model</a> of a F-actin negative feedback to GTPase system.

## Description

To do so, we add diffusion terms to well-mixed GTPase equations. The PDEs are:

$$\begin{align}
\frac{\partial G}{\partial t} &= D\frac{\partial^2 G}{\partial x^2} + (b+\gamma \frac{G^n}{1+G^n})G_{\mathrm i} - G(\eta + sF) \\\\
\frac{\partial G_{\mathrm i}}{\partial t} &= D_{\mathrm i}\frac{\partial^2 G_{\mathrm i}}{\partial x^2} - (b+\gamma \frac{G^n}{1+G^n})G_{\mathrm i} + G(\eta + sF) \\\\
\frac{\partial F}{\partial t} &= \epsilon(k_{\mathrm n}G-k_{\mathrm s}F) \\\\
\end{align}$$

We explore the equation system first in a single spatial dimension in {{< model_quick_access "media/model/m2013/ActinWavesPDE_main.xml" >}} and continue in two spatial dimensions using a <span title="//Space/Lattice[@class='square']">`square`</span> lattice in place of the <span title="//Space/Lattice[@class='linear']">`linear`</span> lattice in {{< model_quick_access "media/model/m2013/ActinWavesPDE_2D.xml" >}}, with the actin reaction rate <span title="//Global/System/Constant[@symbol='epsilon']">$`\epsilon`$</span> changed from $`0.001`$ to $`0.01`$ to speed up the dynamics.

## Results

Consider the actin waves PDE system in 1D spatial coordinates (top figures) and in 2D (lower panels):

![](MorpheusActinWaves1Dhor.png "Simulation of the actin waves PDE system in 1D, showing <span title='//Global/Field[@symbol=&#39;a&#39;]'>$`G(x, t)`$</span> in the top row and <span title='//Global/Field[@symbol=&#39;F_a&#39;]'>$`F(x, t)`$</span> in the bottom row for several values of the feedback parameter <span title='//Global/System/Constant[@symbol=&#39;s&#39;]'>$`s`$</span>. Produced with [`ActinWavesPDE_main.xml`](#model).")

<figure>
  ![](M2013_actin-waves_movie_ActinWavesPDE_main.mp4)
  <figcaption>
    Simulation video of {{< model_quick_access "media/model/m2013/ActinWavesPDE_main.xml" >}} with the profile of all three variables active GTPase <span title="//Global/Field[@symbol='a']">$`G(x, t)`$</span>, inactive GTPase <span title="//Global/Field[@symbol='i']">$`G_{\mathrm i}(x, t)`$</span> and F-actin <span title="//Global/Field[@symbol='F_a']">$`F(x, t)`$</span> changing over time.
  </figcaption>
</figure>

![](MorpheusActinWaves2D.png "Simulation of the actin waves PDE system in 2D, showing (right, left) <span title='//Global/Field[@symbol=&#39;a&#39;]'>$`G(x,y,t)`$</span> and <span title='//Global/Field[@symbol=&#39;F_a&#39;]'>$`F(x,y,t)`$</span> (side by side) over time. Produced with [`ActinWavesPDE_2D.xml`](#downloads).")

<figure>
![](M2013_actin-waves_movie_ActinWavesPDE_2D.mp4)
<figcaption>Simulation video of {{< model_quick_access "media/model/m2013/ActinWavesPDE_2D.xml" >}}</figcaption>
</figure>
````

## File: Contributed Examples/PDE/Actin Waves/model.md
````markdown
![](M2013_actin-waves_model-graph.svg "Model Graph")
````

## File: Contributed Examples/PDE/Diffusion/Diffusion1a_main.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details>Full title:		Diffusion
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		23.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2017
File type:		Main model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		A 1D domain with a chemical that diffuses at rate D and decays at rate k. Simple time plots in 1D of the chemical to show its diffusion into the domain.</Details>
        <Title>Diffusion1a</Title>
    </Description>
    <Space>
        <Lattice class="linear">
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Size symbol="size" value="100, 0, 0"/>
            <BoundaryConditions>
                <Condition type="constant" boundary="x"/>
                <Condition type="constant" boundary="-x"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="50"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Global>
        <Field symbol="c" value="0">
            <Diffusion rate="0.5"/>
            <BoundaryValue boundary="x" value="5.0"/>
        </Field>
        <System time-step="0.5" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="c" name="attractant">
                <Expression>-k*c</Expression>
            </DiffEqn>
            <Constant symbol="k" name="decay rate" value="0.001"/>
        </System>
    </Global>
    <Analysis>
        <Logger time-step="5" name="chemical profile">
            <Input>
                <Symbol symbol-ref="c"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot>
                    <Style style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="space.x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="c"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Diffusion/Diffusion1b.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details>Full title:		Diffusion
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		23.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2017
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		A 1D domain with a chemical that diffuses at rate D and decays at rate k. Simple time plots in 1D of the chemical to show its diffusion into the domain.</Details>
        <Title>Diffusion1b</Title>
    </Description>
    <Space>
        <Lattice class="linear">
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Size symbol="size" value="100, 0, 0"/>
            <BoundaryConditions>
                <Condition type="constant" boundary="x"/>
                <Condition type="constant" boundary="-x"/>
            </BoundaryConditions>
            <NodeLength symbol="dx" value="0.1"/>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="100"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Global>
        <Field symbol="c" name="attractant" value="0">
            <Diffusion rate="0.5"/>
            <BoundaryValue boundary="x" value="5.0"/>
        </Field>
        <System time-step="0.5" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="c" name="attractant">
                <Expression>-k*c</Expression>
            </DiffEqn>
            <Constant symbol="k" name="decay rate" value="0.001"/>
        </System>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
    </Global>
    <Analysis>
        <Logger time-step="5" name="chemical profile">
            <Input>
                <Symbol symbol-ref="c"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot title="chemical profile">
                    <Style style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="c"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Diffusion/Diffusion2a.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details>Full title:		Diffusion
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		23.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2017
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Diffusion in a 2D domain. The chemical diffuses at rate D and decays at rate k. Periodic BCs in y direction, constant c on x boundaries, with high level at the right boundary. Heat map in 2D of the chemical to show its diffusion into the domain.</Details>
        <Title>Diffusion2a</Title>
    </Description>
    <Space>
        <Lattice class="square">
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Size symbol="size" value="100, 100, 0"/>
            <BoundaryConditions>
                <Condition type="constant" boundary="x"/>
                <Condition type="constant" boundary="-x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <NodeLength symbol="dx" value="0.1"/>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="100"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Global>
        <Field symbol="c" name="attractant" value="0">
            <Diffusion rate="0.5"/>
            <BoundaryValue boundary="x" value="5.0"/>
        </Field>
        <System time-step="0.5" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="c" name="attractant">
                <Expression>-k*c</Expression>
            </DiffEqn>
            <Constant symbol="k" name="decay rate" value="0.001"/>
        </System>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
        <Function symbol="y">
            <Expression>dx*space.y</Expression>
        </Function>
    </Global>
    <Analysis>
        <Logger time-step="5" name="chemical profile">
            <Input>
                <Symbol symbol-ref="c"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="25" title="chemical profile">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="c"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Diffusion/index.md
````markdown
---
MorpheusModelID: M2017

title: Diffusion

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true
#  preprint: false

tags:
- 1D
- 2D
- Boundary Condition
- BoundaryConditions
- Diffusion
- Partial Differential Equation
- PDE

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> Simulations of a diffusing field

## Introduction

Here, we build up a simulation of diffusion over three successive files by:

1. Starting with 1D and a short time scale in {{< model_quick_access "media/model/m2017/Diffusion1a_main.xml" >}}
,
2. simulating for longer times in {{< model_quick_access "media/model/m2017/Diffusion1b.xml" >}}
 and
3. extending to 2D in {{< model_quick_access "media/model/m2017/Diffusion2a.xml" >}}
.

## Description

Chemical diffusion and decay are easily simulated in Morpheus in 1D or 2D. We demonstrate the numerical simulation of the PDE and boundary conditions:

$$\begin{align}
\frac{\partial c}{\partial t} = D \frac{\partial^2 c}{\partial x^2} - kc \quad c(0) = 0, c(L) = 5
\end{align}$$

## Results

<figure>
    ![](DiffusionMorpheusSimBU.png)
    <figcaption >
        Building up a simulation of diffusion in Morpheus: (a) Starting with 1D and short time scale ({{< model_quick_access "media/model/m2017/Diffusion1a_main.xml" >}}), (b) for longer times ({{< model_quick_access "media/model/m2017/Diffusion1b.xml" >}}), and (c) extension to 2D ({{< model_quick_access "media/model/m2017/Diffusion2a.xml" >}}).
    </figcaption>
</figure>
````

## File: Contributed Examples/PDE/Diffusion/model.md
````markdown
![](M2017_diffusion_model-graph.svg "Model Graph")
````

## File: Contributed Examples/PDE/Diffusion in Liver Lobule/Diffusion_liver_lobule.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
<Details>Full title: Demonstration that bile diffusion without flow is insufficient to clear from liver lobule within 1hour
Date: October 3, 2020
Authors: michael.kuecken@tu-dresden.de, lutz.brusch@tu-dresden.de
Software: Morpheus (open-source), download from https://morpheus.gitlab.io
Units are: [space]=micrometer, [time]=seconds
</Details>
        <Title>Bile Diffusion</Title>
    </Description>
    <Space>
        <Lattice class="square">
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Size value="500, 500, 0" symbol="size"/>
            <NodeLength value="1" symbol="dx"/>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="-x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
                <Condition boundary="-y" type="periodic"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="s" name="Position"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="3600" symbol="StopTime_in_seconds"/>
        <TimeSymbol symbol="Time" name="Time in seconds"/>
    </Time>
    <Global>
        <Constant value="200" symbol="L" name="CV-PV distance"/>
        <Field value="if((s.x-0.25*L+r)^2+(s.y-1.25*L)^2&lt;=r^2, 1, 0) + &#xa;if((s.x-0.75*L+r/2)^2+(s.y-(1.25*L-0.5*sqrt(3)*(L+r)))^2&lt;=r^2, 1, 0) + &#xa;if((s.x-1.75*L-r/2)^2+(s.y-(1.25*L-0.5*sqrt(3)*(L+r)))^2&lt;=r^2, 1, 0) + &#xa;if((s.x-2.25*L-r)^2+(s.y-1.25*L)^2&lt;=r^2, 1, 0) + &#xa;if((s.x-1.75*L-r/2)^2+(s.y-(1.25*L+0.5*sqrt(3)*(L+r)))^2&lt;=r^2, 1, 0) + &#xa;if((s.x-0.75*L+r/2)^2+(s.y-(1.25*L+0.5*sqrt(3)*(L+r)))^2&lt;=r^2, 1, 0)" symbol="loc_sink" name="Locations of intralobular bile ducts as sinks for marker"/>
        <Constant value="0.1" symbol="k_source" name="Initial marker activation rate"/>
        <Constant value="10" symbol="time_source" name="Duration of initial marker activation/release into BC"/>
        <Constant value="5.0" symbol="r" name="Radius of IBD in micrometer determines size of sinks"/>
        <Field value="0.0" symbol="c" name="Concentration of marker">
            <Diffusion rate="3"/>
        </Field>
        <System time-step="1" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn name="Marker reaction-diffusion model" symbol-ref="c">
                <Expression>k_source*(1-loc_sink)*(Time&lt;time_source)</Expression>
            </DiffEqn>
        </System>
        <Variable value="0.0" symbol="c_mean" name="Mean marker concentration over lobule"/>
        <Mapper time-step="60" name="mean of c">
            <Input value="c"/>
            <Output mapping="average" symbol-ref="c_mean"/>
        </Mapper>
        <Event trigger="when true" time-step="1" name="Complete clearance in IBD">
            <Condition>loc_sink</Condition>
            <Rule symbol-ref="c">
                <Expression>0.0</Expression>
            </Rule>
        </Event>
        <Field value="s.x-0.25*L" symbol="x" name="Distance from portal tract"/>
    </Global>
    <Analysis>
        <Gnuplotter log-commands="false" time-step="60" decorate="true">
            <Plot title="Simulated marker dynamics without flow">
                <Field symbol-ref="c" max="1" min="0">
                    <ColorMap>
                        <Color value="1" color="green"/>
                        <Color value="0" color="black"/>
                    </ColorMap>
                </Field>
            </Plot>
            <Terminal name="png"/>
        </Gnuplotter>
        <DependencyGraph format="svg" reduced="false" include-tags="#untagged"/>
        <Logger time-step="1" name="Time course of marker statistics">
            <Input>
                <Symbol symbol-ref="c_mean"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="60" title="Time course">
                    <Style decorate="true" line-width="1.0" style="lines" point-size="1.0"/>
                    <Terminal terminal="png"/>
                    <X-axis maximum="3600" minimum="0">
                        <Symbol symbol-ref="Time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="c_mean"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
        <Logger time-step="10" name="Spatial profile of marker concentration">
            <Restriction condition="(s.x>=0.25*L)*(s.x&lt;=1.25*L)*(s.y==1.25*L)"/>
            <Input>
                <Symbol symbol-ref="c"/>
                <Symbol symbol-ref="x"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="60" title="Spatial profile">
                    <Style decorate="true" line-width="1.0" style="lines" point-size="1.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis maximum="1" minimum="0">
                        <Symbol symbol-ref="c"/>
                    </Y-axis>
                    <Range>
                        <Time mode="current"/>
                    </Range>
                </Plot>
                <Plot time-step="60" title="Space-time plot of marker concentration dynamics">
                    <Style decorate="true" style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis maximum="3600" minimum="0">
                        <Symbol symbol-ref="Time"/>
                    </X-axis>
                    <Y-axis maximum="200" minimum="0">
                        <Symbol symbol-ref="x"/>
                    </Y-axis>
                    <Color-bar palette="rainbow" maximum="1" minimum="0">
                        <Symbol symbol-ref="c"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Diffusion in Liver Lobule/index.md
````markdown
---
MorpheusModelID: M7991

authors: [M. Kücken, L. Brusch]
contributors: [L. Brusch]

title: Diffusion in Liver Lobule
date: "2020-12-17T10:29:29+01:00"
lastmod: "2020-12-17T13:51:00+01:00"

tags:
- 2D
- Hepatic Lobule
- Liver
- Liver Lobule
- Lobule
- PDE
- Partial Differential Equation

---

>Diffusion in Liver Lobule

## Introduction

This model considers diffusion of a marker with concentration $c(x,y,t)$ across a liver lobule. The lobule is patterned into a central zone around the central vein (center of simulation domain) and portal zones around (here six) portal triads that here act as sinks ($c = 0$). That pattern and the solution are considered identical along $z$ and only the dynamics in the $xy$ plane is simulated. The simulation runs for $t = 1 \ \mathrm h$ with diffusion constant $D = 3 \ \mathrm{\frac{\mu m^2}{s}}$ and without advection ($v = 0 \ \mathrm{\frac{\mu m}{s}}$). Initially, the marker gets uniformly activated up to $c = 1$. Portal-central axis length is $200 \ \mathrm{µm}$. The simulation demonstrates that diffusion alone without additional bile flow is insufficient to clear the marker from the liver lobule within 1 hour.

## Description

The figure shows the concentration pattern $c(x,y,t=1 \ \mathrm h)$ in (A) and a radial concentration profile $c(x,t=1 \ \mathrm{h})$ along the portal-central axis cut in (B) as indicated by the white box in (A). (C) Time course of the mean intensity signal over the entire lobule.

![](Diffusion_liver_lobule.png "Simulation result of the model after 1 hour.")

The dynamics is visualized by movies (frames are generated by the model file). The final frames correspond to the above figure.

![Movie of the spatial concentration pattern that is changing over time (given at the bottom, in seconds).](Diffusion_liver_lobule_field_movie.mp4)

![Movie of the radial concentration profile from a portal sink (left) to the lobule center (right). Time is running over 1 hour but not shown by number.](Diffusion_liver_lobule_profile_movie.mp4)
````

## File: Contributed Examples/PDE/Field-Cell Interaction/field_cell_interaction.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details>This example serves to demonstrate the implementation of cells consuming a substrate field e.g. cytokine.

The logic is like this: In the PDE that describes the reaction and diffusion of the substrate, you include a negative term (i.e. for decrease) that is nonzero where there is a cell and zero where there is no cell.

Steps to reproduce: 
1. Define a Field in Global/ e.g. called "cytokine" with an inital concentration 1.0 and diffusion
2. Define a System with a differential equation with a negative term, e.g. "-r*cell*cytokine" where "r" is the consumption rate of cells. (Here it is constant, but could also be a cell property to specify that each cell has its own consumption rate)
3. Define a Constant called "cell" which is "0" everywhere, except for where there is a cell. 
    To do this specify "cell" in Global and set it to "0".
    But in CellType , the value of the constant is overwritten with a value of "1".

In this way, the term "-r*cell*cytokine" is negative 'within' cells and zero outside. Therefore, the cytokine concentration is only decreased at locations with cells.

Date: March 4, 2022 
	Author: walter@deback.net 
	Contributor: ferras_mahmoud.el-hendi@tu-dresden.de 
	Software: Morpheus (open-source), download from https://morpheus.gitlab.io 
</Details>
        <Title>Cells' Cytokine Consumption</Title>
    </Description>
    <Space>
        <Lattice class="square">
            <Neighborhood>
                <Order>2</Order>
            </Neighborhood>
            <Size symbol="size" value="200, 200, 0"/>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="100"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="cells">
            <Constant symbol="cell" value="1"/>
        </CellType>
    </CellTypes>
    <CellPopulations>
        <Population type="cells" size="1">
            <InitCellObjects mode="distance">
                <Arrangement displacements="0,0,0" repetitions="1,1,0">
                    <Sphere radius="25.0" center="size/2"/>
                </Arrangement>
            </InitCellObjects>
        </Population>
    </CellPopulations>
    <Global>
        <Constant symbol="cell" value="0.0" name="Presence of cell"/>
        <Field symbol="cytokine" value="1.0" name="Cytokine concentration">
            <Diffusion rate="1"/>
        </Field>
        <System solver="Dormand-Prince [adaptive, O(5)]">
            <Constant symbol="r" value="0.05" name="consumption rate"/>
            <DiffEqn symbol-ref="cytokine">
                <Expression>-r*cell*cytokine</Expression>
            </DiffEqn>
        </System>
    </Global>
    <Analysis>
        <Gnuplotter time-step="1">
            <Plot>
                <Cells min="0" value="cell" max="1"/>
            </Plot>
            <Plot>
                <Field symbol-ref="cytokine" min="0" max="1">
                    <ColorMap>
                        <Color color="red" value="1"/>
                        <Color color="white" value="0"/>
                    </ColorMap>
                </Field>
            </Plot>
            <Terminal name="png"/>
        </Gnuplotter>
        <ModelGraph format="dot" include-tags="#untagged" reduced="false"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Field-Cell Interaction/index.md
````markdown
---
MorpheusModelID: M5481

title: "Field-Cell Interaction"

contributors: [V. Ponce, W. de Back, F. El-Hendi]

tags:
- Contributed Examples
- 2D
- PDE
- Diffusion
- Cellular Potts Model
- CPM
- ECM
- Extracellular Matrix
- Field
- Field-Cell
---
>Cells' consumption of cytokine concentration

## Introduction

This example serves to demonstrate the implementation of cells consuming a substrate field, e.g. cytokine. Please also see the built-in docu at `MorpheuML`/`Global`/`Field` and `Global`/`System`/`DiffEqn`. This example was motivated by [Victoria Ponce](/contributor/v.-ponce/) in the [Morpheus user forum](https://groups.google.com/g/morpheus-users/c/fO1EGRLHJ20).

## Description

The logic is like this: In the PDE that describes the reaction and diffusion of the substrate, you include a negative term (i.e. for decrease) that is nonzero where there is a cell and zero where there is no cell.
Steps to reproduce: 
1. Define a `Field` in `Global`, e.g. called `cytokine` with an inital concentration $1.0$ and `Diffusion`.
2. Define a `System` with a differential equation with a negative term, e.g. `-r*cell*cytokine` where `r` is the consumption rate of cells. (Here it is constant, but could also be a cell property to specify that each cell has its own consumption rate.)
3. Define a `Constant` called `cell` which is $0$ everywhere, except for where there is a cell. To do this, specify `cell` in `Global` and set it to $0$. But in `CellType` , the value of the constant is overwritten with a value of $1$.

In this way, the term `-r*cell*cytokine` is negative 'within' cells and zero outside. Therefore, the cytokine concentration is only decreased at locations with cells.

Movie visualising the consumption of cytokine only where the cell is:
![Movie visualising the consumption of cytokine only where the cell is](consumption.mp4)
The panel shows the area covered by the cell (left) and the cytokine concentration over time (right).
````

## File: Contributed Examples/PDE/Field-Cell Interaction/model.md
````markdown
![](model-graph.svg "Model Graph.")
````

## File: Contributed Examples/PDE/FitzHugh–Nagumo Waves/FN_PDE_in_2D.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>FN (PDE) in 2D</Title>
        <Details>Full title:		FitzHugh–Nagumo Waves
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		23.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2014
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		PDE model for FitzHugh–Nagumo equations solved in 2D. There is current injected at the "origin" to kickstart the waves. The initial profiles of u and v are asymmetric to provoke spirals. This simulation produces spiral waves.</Details>
    </Description>
    <!--
 Define the variables and initialize their values.
 Indicate the rates of diffusion
 GTPases diffusem but F-actin does not
-->
    <Global>
        <Field symbol="u" name="voltage" value="2.5*(0.5-space.y/size.y)">
            <Diffusion rate="0.00005"/>
        </Field>
        <Field symbol="v" name="refractory variable" value="space.x/size.x">
            <!--    <Disabled>
        <Diffusion rate="0.00001"/>
    </Disabled>
-->
        </Field>
        <!--
 Specify the method of solution and give the kinetic terms
 in the differential equations for the three variables
-->
        <System time-step="0.05" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="u">
                <Expression> u*(1-u)*(u-a)-v + I_0 </Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="v">
                <Expression>epsilon*(u-b*v) </Expression>
            </DiffEqn>
            <!--
  Define the constants and give their values.
-->
            <Constant symbol="b" name="decay rate" value="1.0"/>
            <Constant symbol="a" name="middle value" value="0.25"/>
            <!--    <Disabled>
        <Constant symbol="I_0" name="input current" value="0.5"/>
    </Disabled>
-->
            <Constant symbol="epsilon" name="actin reaction rate" value="0.002"/>
            <Function symbol="I_0">
                <Expression>0.2+0.6*exp(-(((space.x)/size.x)^2+((space.y)/size.y)^2)/0.01) </Expression>
            </Function>
        </System>
        <!--    <Disabled>
        <Variable symbol="I_0" value="(space.x/size.x-0.5)^2"/>
    </Disabled>
-->
    </Global>
    <!--
Specify the 2D Domain ("Square" lattice) and its boundary conditions
Indicate the size of each spatial box
-->
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="100, 100, 0"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <NodeLength value="0.02"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <!--
  Set the start and end time and any random seed needed
-->
    <Time>
        <StartTime value="0"/>
        <StopTime value="1500"/>
        <SaveInterval value="0"/>
        <RandomSeed value="3451"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <!--
 Specify how the results should be plotted
-->
    <Analysis>
        <Gnuplotter time-step="20" decorate="true">
            <Terminal name="png"/>
            <!--
Side by side plots of the active GTPase and the F-Actin
A color scheme an be specified  (e.g. for F-actin)
Both plots are on the same "terminal"
-->
            <Plot>
                <Field symbol-ref="u" min="0"/>
            </Plot>
            <Plot>
                <Field symbol-ref="v">
                    <ColorMap>
                        <Color value="12.0" color="blue"/>
                        <Color value="10.0" color="green"/>
                        <Color value="8.0" color="yellow"/>
                        <Color value="6.0" color="white"/>
                    </ColorMap>
                </Field>
            </Plot>
        </Gnuplotter>
        <Logger time-step="100">
            <Input>
                <Symbol symbol-ref="u"/>
            </Input>
            <Output>
                <TextOutput file-format="csv"/>
            </Output>
            <Plots>
                <!--
Make a line plot showing the profiles of all three variables
    -->
                <Plot time-step="200">
                    <Style line-width="3.0" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="space.x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="u"/>
                        <Symbol symbol-ref="v"/>
                    </Y-axis>
                    <!--
   Creates that plot once at the end of the simulation
-->
                    <Range>
                        <Data/>
                        <Time mode="current"/>
                    </Range>
                </Plot>
            </Plots>
            <Restriction>
                <Slice axis="y" value="size.y/2"/>
            </Restriction>
            <!--
Indicates that the line plot is for a slice midway up the y axis
-->
        </Logger>
        <!--
Make a kimograph of the variable a
that shows how a 1D slice midway up the y axis
develops over time.
-->
        <Logger time-step="10">
            <Input>
                <Symbol symbol-ref="u"/>
            </Input>
            <Plots>
                <SurfacePlot time-step="150">
                    <Color-bar>
                        <Symbol symbol-ref="u"/>
                    </Color-bar>
                    <Terminal terminal="png"/>
                </SurfacePlot>
            </Plots>
            <Restriction>
                <Slice axis="y" value="size.y/2"/>
            </Restriction>
            <Output>
                <TextOutput/>
            </Output>
        </Logger>
        <ModelGraph format="dot" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/FitzHugh–Nagumo Waves/FNspiralwaves2D.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>FNspiralwaves2D</Title>
        <Details>Full title:		FitzHugh–Nagumo Waves
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		23.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2014
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Waves produced by an excitable FitzHugh-Nagumo PDE in a periodic 2D domain. u is the "voltage", or excitable variable, v is the "refractory" variable. The initial conditions are a peak in u and a shallow ramp in both u and v (in y and x directions) so as to get asymmetry to get the spiral waves. The parameter values were suggested by Prof. James Keener, but with a larger domain size so as to see the spirals better. A hexagonal grid helps to prevent grid-effects.</Details>
    </Description>
    <Global>
        <Constant value="dx*size.x" symbol="L"/>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
        <Field value="0.5*y/L+0.4*exp(-((x-1)^2+(y-1)^2)/0.02)" name="u" symbol="u">
            <Diffusion rate="0.001"/>
        </Field>
        <Field value="0.1*x/L" name="v" symbol="v"/>
        <System solver="Dormand-Prince [adaptive, O(5)]">
            <DiffEqn symbol-ref="u">
                <Expression>H*(-u*(u-1)*(u-a)-v)</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="v">
                <Expression>eps*(u-b*v)</Expression>
            </DiffEqn>
            <Constant value="0.021" symbol="eps"/>
            <Constant value="2" symbol="b"/>
            <Constant value="0.1" symbol="a"/>
            <Constant value="20" symbol="H"/>
        </System>
        <Function symbol="y">
            <Expression>dx*space.y</Expression>
        </Function>
    </Global>
    <Space>
        <Lattice class="hexagonal">
            <Size value="200, 200,  0" symbol="size"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
                <Condition type="periodic" boundary="y"/>
            </BoundaryConditions>
            <NodeLength value="0.04" symbol="dx"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="200"/>
        <TimeSymbol name="time" symbol="t"/>
    </Time>
    <Analysis>
        <Logger time-step="5">
            <Input>
                <Symbol symbol-ref="u"/>
                <!--    <Disabled>
        <Symbol symbol-ref="v"/>
    </Disabled>
-->
                <Symbol symbol-ref="x"/>
                <Symbol symbol-ref="y"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="5">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="u"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="dot" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/FitzHugh–Nagumo Waves/FNwaves_main.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>FNwaves1D</Title>
        <Details>Full title:		FitzHugh–Nagumo Waves
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		23.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2014
File type:		Main model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Waves produced by an excitable FitzHugh–Nagumo PDE in a periodic 1D domain. u is the "voltage", or excitable variable, v is the "refractory" variable. The initial conditions are a peak in u and a shallow ramp in v. The parameter values are as suggested by James Keener.</Details>
    </Description>
    <Global>
        <Constant symbol="L" value="dx*size.x"/>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
        <Field symbol="u" name="u" value="exp(-(x-0.2)^2/0.1)">
            <Diffusion rate="0.01"/>
        </Field>
        <Field symbol="v" name="v" value="0.1*x/L"/>
        <System solver="Dormand-Prince [adaptive, O(5)]">
            <DiffEqn symbol-ref="u">
                <Expression>H*(-u*(u-1)*(u-a)-v)</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="v">
                <Expression>eps*(u-b*v)</Expression>
            </DiffEqn>
            <Constant symbol="eps" value="0.021"/>
            <Constant symbol="b" value="2"/>
            <Constant symbol="a" value="0.1"/>
            <Constant symbol="H" value="20"/>
        </System>
    </Global>
    <Space>
        <Lattice class="linear">
            <Size symbol="size" value="200, 0, 0"/>
            <BoundaryConditions>
                <Condition type="periodic" boundary="x"/>
            </BoundaryConditions>
            <NodeLength symbol="dx" value="0.015"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="100"/>
        <TimeSymbol symbol="t" name="time"/>
    </Time>
    <Analysis>
        <Logger time-step="1">
            <Input>
                <Symbol symbol-ref="u"/>
                <Symbol symbol-ref="v"/>
                <Symbol symbol-ref="L"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="5" title="Spatial profiles">
                    <Style decorate="true" line-width="3.0" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="u"/>
                        <Symbol symbol-ref="v"/>
                    </Y-axis>
                    <Range>
                        <Time mode="current"/>
                    </Range>
                </Plot>
                <Plot time-step="-1" title="Time-space plot">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="t"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="u"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="dot" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/FitzHugh–Nagumo Waves/index.md
````markdown
---
MorpheusModelID: M2014

title: FitzHugh–Nagumo Waves

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true
#  preprint: false

tags:
- 1D
- 2D
- Actin
- Actin Waves
- Asymmetry
- BoundaryConditions
- FitzHugh–Nagumo
- FitzHugh–Nagumo Wave
- Kymograph
- Partial Differential Equation
- PDE
- Periodic
- Periodic Boundary Conditions
- Periodic Domain
- Pulse
- Spiral
- Spiral Wave
- Traveling Pulse
- Traveling Wave
- Voltage
- Wave

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> Waves produced by an excitable FitzHugh–Nagumo PDE.

## Introduction

We will here take a closer look at waves produced by an excitable FitzHugh–Nagumo PDE

1. in a periodic **1D domain**,
2. in a periodic **2D domain**.

## Description

Consider an excitable system such as the FitzHugh-Nagumo model that can produce traveling waves and pulses:

$$\begin{align}
\frac{\partial u}{\partial t} &= D\Delta u + \gamma u(1-u)(u-a) - v + I_0(x,y) \\\\
\frac{\partial v}{\partial t} &= \epsilon (u-bv) \\\\
\end{align}$$

## Results

Simulations of the model in 1D with periodic <span title="//Space/Lattice/BoundaryConditions">`BoundaryConditions`</span>, showing a traveling pulse (top) and in 2D, showing a set of spiral waves (bottom figures).

![](FN1Dwaves.png "The FitzHugh–Nagumo model in a periodic 1D domain produces a tavelling pulse. Left: kymograph of <span title='//Global/Field[@symbol=&#39;u&#39;]'>$`u`$</span> over time. Right: the shape of <span title='//Global/Field[@symbol=&#39;u&#39;]'>$`u`$</span> and <span title='//Global/Field[@symbol=&#39;v&#39;]'>$`v`$</span> for the pulse. Produced with [`FNwaves_main.xml`](#model).")

<figure>
  ![](M2014_fitzhugh-nagumo-waves_movie_FNwaves_main.mp4)
  <figcaption>
    Simulation video of {{< model_quick_access "media/model/m2014/FNwaves_main.xml" >}}
  </figcaption>
</figure>

<figure>
  ![](M2014_fitzhugh-nagumo-waves_movie_FN_PDE_in_2D.mp4)
  <figcaption>
    Simulation video of {{< model_quick_access "media/model/m2014/FN_PDE_in_2D.xml" >}} with Fitzhugh–Nagumo equations solved in 2D. There is current injected at the ‘origin’ to kickstart the waves. The initial profiles of <span title='//Global/Field[@symbol=&#39;u&#39;]'>$`u`$</span> (‘voltage’ or excitable variable) and <span title='//Global/Field[@symbol=&#39;v&#39;]'>$`v`$</span> (‘refractory’ variable) are asymmetric to provoke spirals.
  </figcaption>
</figure>

![](SpatialFNSpiralsNew.png "The FitzHugh–Nagumo PDEs can sustain spiral waves when stimulated in a 2D domain. Left: <span title='//Global/Field[@symbol=&#39;u&#39;]'>$`u`$</span>. Right: <span title='//Global/Field[@symbol=&#39;v&#39;]'>$`v`$</span> at $`t = 100`$. Produced with [`FNspiralwaves2D.xml`](#downloads).")

<figure>
    ![](M2014_fitzhugh-nagumo-waves_movie_FNspiralwaves2D.mp4)
    <figcaption>
        Simulation video of model {{< model_quick_access "media/model/m2014/FNspiralwaves2D.xml" >}}
    </figcaption>
</figure>
````

## File: Contributed Examples/PDE/FitzHugh–Nagumo Waves/model.md
````markdown
![](M2014_fitzhugh-nagumo-waves_model-graph.svg "Model Graph")
````

## File: Contributed Examples/PDE/Noisy Turing/index.md
````markdown
---
MorpheusModelID: M5483

authors: [S. Miyazawa, M. Okamoto and S. Kondo]
contributors: [J. Starruß, L. Brusch]

title: "Turing Patterns with Noise"

# Reference details
publication:
  doi: "10.1038/ncomms1071"
  title: "Blending of animal colour patterns by hybridization"
  journal: "Nature Communications"
  volume: 1
  page: "66"
  year: 2010
  original_model: false
  
tags:
- 2D
- Euler–Maruyama Method
- Gaussian Noise
- Noise
- Noise-induced Pattern
- ODE
- Ordinary Differential Equation
- PDE
- Partial Differential Equation
- Spatial Model
- Stochastic Model
- Turing
- Turing Pattern
- White Gaussian Noise

categories:
- DOI:10.1038/ncomms1071
---

> Pattern formation is robust to noise.

## Introduction

Morpheus can also simulate ODE and PDE models with noise. One example (in the GUI menu `Examples` → `ODE` → `LateralSignaling.xml`) with coupled noisy ODE systems is explained in [M0004](/model/m0004). To illustrate pattern formation in a noisy PDE system, we here revisit the example [M0014](/model/m0014) (in the GUI menu `Examples` → `PDE` → `TuringPatterns.xml`).

## Model Description

We have extended the deterministic PDE model [M0014](https://identifiers.org/morpheus/M0014) which was originally published in [Miyazawa _et al._](#reference) by adding Gaussian white (in space and time) noise to both PDEs. The solver was switched to Euler-Maruyama as needed for stochastic ODE or PDE models. As in the original publication, the pattern's dependency on parameter values is scanned in a single simulation run by $`x`$- and $`y`$-dependent parameter values $`A(y)`$ and $`C(x)`$ across the 2D lattice. 

## Results

### Without noise

Setting the parameter `noise` $`= 0`$, the initial heterogeneities lead to some frustrated arrangements where a stripe extends into the domain of dot-patterns or dots are found in the central labyrinth domain.

![](plot_without_noise.png "Simulation result for field `u` at `time` $`=100`$ without noise, white denotes zero and black above 1.")

These mixed stripe-dot arrangements are expected to resolve very slowly (beyond the runtime of this movie).

![](movie_without_noise.mp4)

### With noise

When adding little noise, then the above frustrated arrangements resolve faster (not shown).

With high noise level (`noise` $`= 0.2`$), we observe that the same patterns emerge robustly in the same domains as without noise.

![](movie_with_noise.mp4)

Moreover, continuously perturbing the fluxes keeps the state away from the homogeneous solution also in outside the Turing instability domain (towards the homogeneous white and black corners). There, the state relaxes back to the homogeneous state and gets pushed away again in a manner that the slowest-decaying spatial models dominate and are visible as apparent continuation of the Turing patterns (hexagonal array of dots) beyond the Turing instability border. These are known as noise-induced patterns.

![](plot_with_noise.png "Simulation result for field `u` at `time` $`= 100`$ with `noise` $` = 0.2`$, again white denotes zero and black above 1.")
````

## File: Contributed Examples/PDE/Noisy Turing/model.md
````markdown
![](model-graph.svg "Model Graph")
````

## File: Contributed Examples/PDE/Noisy Turing/model.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Example-TuringNoisy</Title>
        <Details>Extended model TuringPatterns (see https://morpheus.gitlab.io/model/m0014) by adding Gaussian noise to both PDEs. Solver was switched to Euler-Maruyama. We observe that the patterns emerge robustly under noisy conditions over the whole parameter plane (scanned by x- and y-dependent parameter values). 

Also, continuously perturbed states outside the Turing instability domain try to relax back to the homogeneous state in a way that the slowest-decaying spatial models continue the Turing patterns (hexagonal array of dots) beyond the Turing instability border - known as noise-induced patterns.

The original (deterministic) model was published in:
Miyazawa, Okamoto and Kondo (2010). Blending of animal colour patterns by hybridization. Nature Communications 1, 66.
https://doi.org/10.1038/ncomms1071
</Details>
    </Description>
    <Global>
        <Field symbol="u" value="4.1+rand_uni(0,1)">
            <Diffusion rate="1"/>
        </Field>
        <Field symbol="v" value="4.84+rand_uni(0,1)">
            <Diffusion rate="20"/>
        </Field>
        <System time-step="0.25" name="Miyazawa" solver="Euler-Maruyama [stochastic, O(1)]">
            <Function symbol="A">
                <Expression>0.07 + ((0.07 * l.y)/ s.y)</Expression>
            </Function>
            <Constant symbol="B" value="0.08"/>
            <Function symbol="C">
                <Expression>-0.1 + ((0.5 * l.x)/ s.x)</Expression>
            </Function>
            <Constant symbol="D" value="0.03"/>
            <Constant symbol="E" value="0.10"/>
            <Constant symbol="F" value="0.12"/>
            <Constant symbol="G" value="0.06"/>
            <Constant symbol="R" value="20.0"/>
            <Constant symbol="synU_max" value="0.23"/>
            <Constant symbol="synV_max" value="0.50"/>
            <Function symbol="s_u">
                <Expression>max( 0, min( synU_max, A()*u-B*v+C()))</Expression>
            </Function>
            <Function symbol="s_v">
                <Expression>max( 0, min( synV_max, E*u - F))</Expression>
            </Function>
            <Constant symbol="noise" value="0.2"/>
            <DiffEqn symbol-ref="u">
                <Expression>R*(s_u() - D*u + rand_norm(0.0,noise))</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="v">
                <Expression>R*(s_v() - G*v + rand_norm(0.0,noise))</Expression>
            </DiffEqn>
        </System>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="s" value="512, 512, 0"/>
            <NodeLength value="1"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="y"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="l"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="100"/>
        <RandomSeed value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Analysis>
        <Gnuplotter time-step="2" decorate="false">
            <Terminal name="png" persist="true"/>
            <Plot>
                <Field symbol-ref="u">
                    <ColorMap>
                        <Color color="black" value="1"/>
                        <Color color="white" value="0.0"/>
                    </ColorMap>
                </Field>
            </Plot>
        </Gnuplotter>
        <Logger time-step="0.0">
            <Input>
                <Symbol symbol-ref="u"/>
            </Input>
            <Output>
                <TextOutput file-format="csv"/>
            </Output>
            <Restriction>
                <Slice axis="x" value="s.x/2"/>
            </Restriction>
            <Plots>
                <Plot title="slice at half of x extension" time-step="-1">
                    <Style style="lines" line-width="3.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="l.y"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="u"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="v"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <Logger time-step="2">
            <Input>
                <Symbol symbol-ref="u"/>
            </Input>
            <Output>
                <TextOutput file-format="csv"/>
            </Output>
            <Plots>
                <SurfacePlot time-step="2">
                    <Color-bar minimum="0" maximum="9">
                        <Symbol symbol-ref="u"/>
                    </Color-bar>
                    <Terminal terminal="png"/>
                </SurfacePlot>
            </Plots>
        </Logger>
        <ModelGraph include-tags="#untagged" format="svg" reduced="false"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Scaled Diffusion/Example_Scaled_Diffusion.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details>Full title:	Scaled Diffusion Coefficient to Obtain Identical Results in Physical Units Independent of Lattice Discretization
Authors:		R. Müller
Contributors:	L. Brusch
Date:		03.01.2024
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M7992
Comment:		Simulation of Turing pattern with the numerical diffusion coefficient scaled to the chosen spatial and temporal discretizations. 
		Results are plotted over x.physical and time.physical and turn out independent of the numerical discretizations, as expected.
</Details>
        <Title>Example Scaled Diffusion</Title>
    </Description>
    <Space>
        <Lattice class="linear">
            <Neighborhood>
                <Order>optimal</Order>
            </Neighborhood>
            <Size symbol="size" value="L.numerical, 0, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="-x"/>
                <Condition type="noflux" boundary="x"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="x.numerical"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="StopTime.numerical"/>
        <TimeSymbol symbol="time.numerical"/>
    </Time>
    <Analysis>
        <ModelGraph include-tags="#untagged" format="dot" reduced="false"/>
        <Logger time-step="0.01">
            <Input force-node-granularity="false"/>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot title="spatial profiles" time-step="-1">
                    <Style style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x.physical"/>
                    </X-axis>
                    <Y-axis minimum="-0.1" maximum="3.7">
                        <Symbol symbol-ref="a"/>
                        <!--    <Disabled>
        <Symbol symbol-ref="i"/>
    </Disabled>
-->
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="time.physical"/>
                    </Color-bar>
                </Plot>
                <Plot title="space-time plot" time-step="-1">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time.physical"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="x.physical"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="a"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
    <Global>
        <Constant symbol="StopTime.physical" name="total time duration in seconds" value="4000"/>
        <Constant symbol="StopTime.numerical" value="1"/>
        <Constant symbol="tau" name="time unit in seconds" value="StopTime.physical/StopTime.numerical"/>
        <Function symbol="time.physical">
            <Expression>time.numerical*tau</Expression>
        </Function>
        <Constant symbol="L.physical" name="system size in µm" value="100"/>
        <Constant symbol="L.numerical" value="80"/>
        <Constant symbol="h" name="lattice node length in µm" value="L.physical/L.numerical"/>
        <Function symbol="x.physical" name="position value in µm">
            <Expression>x.numerical.x*h</Expression>
        </Function>
        <Constant symbol="D_a.physical" name="diffusion constant of activator in µm²/sec" value="0.02"/>
        <Constant symbol="D_i.physical" name="diffusion constant of inhibitor in µm²/sec" value="1.0"/>
        <Field symbol="a" name="activator" value="x.physical/L.physical">
            <Diffusion rate="D_a.physical*tau/(h*h)"/>
        </Field>
        <Field symbol="i" name="inhibitor" value="0.1">
            <Diffusion rate="D_i.physical*tau/(h*h)"/>
        </Field>
        <System name="Activator-Inhibitor-Model" solver="Dormand-Prince [adaptive, O(5)]">
            <DiffEqn symbol-ref="a">
                <Expression>tau* ((rho*a^2) / i - mu_a * a + rho_a)</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="i">
                <Expression>tau* ((rho*a^2) - mu_i * i)</Expression>
            </DiffEqn>
            <Constant symbol="rho_a" name="" value="0.01"/>
            <Constant symbol="mu_i" value="0.03"/>
            <Constant symbol="mu_a" value="0.02"/>
            <Constant symbol="rho" value="0.001"/>
        </System>
    </Global>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Scaled Diffusion/index.md
````markdown
---
MorpheusModelID: M7992

authors: [R. Müller]
contributors: [L. Brusch]

title: Scaled Diffusion Coefficient to Obtain Identical Results in Physical Units Independent of Lattice Discretization
date: "2023-10-03T10:42:00+02:00"
lastmod: "2024-01-04T14:49:00+01:00"

tags:
- 1D
- Activator
- Diffusion
- Discretization
- Inhibitor
- Lattice
- Partial Differential Equation
- PDE
- Scaling
- Turing

---

> This example model demonstrates how to obtain consistent results in physical units together with the freedom to choose arbitrary lattice and time discretizations.

## Introduction

Often, one starts to build a model with a particular lattice size and time scaling. Then later, one may want to run finer resolved simulations and has to increase the number of lattice nodes. However, that rather increases the spatial extensions and one needs to also rescale other parameters. This example model demonstrates how to do this right and strictly separate the physical scales from lattice and time discretizations. 

## Description

A PDE model is here defined in continuum space of size ```L.physical``` and discretized on the 1D interval ```[0,L.numerical]```, yielding a lattice spacing ```h = L.physical/L.numerical```. The spatial location in physical units is then available for expressions, reporting and plotting as ```x.physical = x.numerical.x*h```.

Likewise, the physical time interval ```[0,StopTime.physical]``` shall be discretized on the numerical interval ```[0,StopTime.numerical]``` with resulting physical time steps of duration ```tau = StopTime.physical/StopTime.numerical```. The physical time is then available for expressions, reporting and plotting as ```time.physical = time.numerical*tau```.

To analyse dynamic patterning due to reactions and diffusion, we added an activator-inhibitor model with fields ```a``` and ```i```. The rate constants and diffusion constants shall be given in physical units and then the fluxes in the differential equations inside ```Global/System``` are scaled with ```tau```.

The two diffusion coefficients ```D_a.physical``` and ```D_i.physical``` are given in physical units and then scaled inside ```Global/Field/Diffusion``` by the factor ```tau/(h*h)``` in response to the chosen discretizations.

## Results

Simulations show the emergence of a Turing pattern from the initial condition for the field ```a=x.physical/L.physical```. The profile of the activator variable is plotted as function of ```x.physical``` and ```time.physical```.
As expected, these results are independent of the chosen numerical discretizations.
Here we compare two runs with ```L.numerical = 80``` on the left vs. ```L.numerical = 800``` on the right. Beside small numerical errors due to the relatively coarse discretization in 
the first case, the patterns are the same in space and time.

![](logger.png "Snapshots for L.numerical=80 on left and L.numerical=800 on right with line color indicating time.")

![](kymograph.png "Kymograph for L.numerical=80 on left and L.numerical=800 on right with color indicating activator values.")
````

## File: Contributed Examples/PDE/Scaled Diffusion/model.md
````markdown
![](model-graph.svg "Model Graph")
````

## File: Contributed Examples/PDE/Schnakenberg System/index.md
````markdown
---
MorpheusModelID: M2009

title: "Schnakenberg System"

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true

tags:
- 1D
- 2D
- BoundaryCondition
- Domain
- Image
- Irregular Domain
- Noflux
- Schnakenberg System
- Partial Differential Equation
- PDE
- Reaction-diffusion System

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> Creating patterns using the Schnakenberg reaction-diffusion system 

## Introduction

We use the Schnakenberg system to generate patterns using a pair of reaction-diffusion (RD) equations, build up from 1D to 2D and explore parameter dependence.

## Description

We run the Schnakenberg system of PDEs in 1D with no-flux <span title="//Space/Lattice/BoundaryConditions/Condition">`BoundaryConditions`</span> from initial profile of noise.

## Results

![](Schnak1DAI.png "The final pattern (at <span title='//Time/StopTime/@value'>$`t = 500`$</span>) in the 1D Schnakenberg system.")

![](Schnak1DtimeSeq.png "A time sequence of pattern formation in the 1D Schnakenberg system, the simulation starts with random initial conditions and proceeds to form a series of peaks.")

![](SchnakPatternsA.png  "Top: a time sequence of the Schnakenberg RD system equation. Stripes are initialized, merged and sharpened due to the pattern-forming system; produced by [`Schnakenberg2Da.xml`](#downloads). Bottom: The same RD system but with random noise close to the HSS as initial conditions. A pattern of spots emerges over time, produced with [`Schnakenberg2Db.xml`](#downloads).")

![](SchnakPatternsVaryGamma.png "A variety of patterns formed by the Schnakenberg RD system with noisy initial conditions but with various values of the time-scale parameter <span title='//Global/Constant/[@symbol=&#39;gamma&#39;]'>$`\gamma`$</span>. In each case, the system was integrated until <span title='//Time/StopTime/@value'>$`t = 1000`$</span> using the Morpheus file [`Schnakenberg2Db.xml`](#downloads).")

![](GrowingIrregDomain.png "Simulations of the Schnakenberg system on different sized irregular domains with <span title='//Space/Lattice/BoundaryConditions/Condition[@boundary=&#39;x&#39; or @boundary=&#39;-x&#39; or @boundary=&#39;y&#39; or @boundary=&#39;-y&#39;]/@type'>`noflux`</span> <span title='//Space/Lattice/BoundaryConditions/Condition'>`BoundaryCondition`</span>s. Produced with Morpheus file [`Schnakenberg2Dshape.xml`](#downloads).")

{{% callout note %}}
The model {{< model_quick_access "media/model/m2009/Schnakenberg2Dshape.xml" >}} also requires the separate files [`picture1.tiff`](#downloads), [`picture2.tiff`](#downloads) and [`picture3.tiff`](#downloads).
{{% /callout %}}
````

## File: Contributed Examples/PDE/Schnakenberg System/model.md
````markdown
![](M2009_schnakenberg-system_model-graph.svg "Model Graph")
````

## File: Contributed Examples/PDE/Schnakenberg System/Schnakenberg2Da.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details>Full title:		Schnakenberg System
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		04.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2002
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Add Schnakenberg kinetics to each of the reactants on a square domain. u_t = gamma( b-u+vu^2) + D_u u_xx; v_t = gamma(b-vu^2). Params: gamma = 0.1, a=0.2, b=2.0.</Details>
        <Title>Schnakenberg2Da</Title>
    </Description>
    <Space>
        <Lattice class="square">
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Size symbol="size" value="100, 100, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="-x"/>
                <Condition type="noflux" boundary="y"/>
                <Condition type="noflux" boundary="-y"/>
            </BoundaryConditions>
            <NodeLength symbol="dx" value="0.1"/>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="500"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Global>
        <Field symbol="u" name="activator" value="1+cos(pi*8*x/(size.x*dx))">
            <Diffusion rate="0.01"/>
        </Field>
        <System time-step="0.5" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="u" name="activator">
                <Expression>gamma*(a-u+v*u^2)</Expression>
            </DiffEqn>
            <Constant symbol="k" name="decay rate" value="0.001"/>
            <DiffEqn symbol-ref="v" name="inhibitor">
                <Expression>gamma*(b-v*u^2)</Expression>
            </DiffEqn>
        </System>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
        <Function symbol="y">
            <Expression>dx*space.y</Expression>
        </Function>
        <Field symbol="v" name="inhibitor" value="0.0">
            <Diffusion rate="1.0"/>
        </Field>
        <Constant symbol="gamma" value="0.1"/>
        <Constant symbol="a" value="0.2"/>
        <Constant symbol="b" value="2.0"/>
    </Global>
    <Analysis>
        <Logger time-step="5" name="chemical profile">
            <Input>
                <Symbol symbol-ref="u"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="50" title="chemical profile">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="u"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Schnakenberg System/Schnakenberg2Db.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details>Full title:		Schnakenberg System
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		04.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2002
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Schnakenberg kinetics as before. u_t = gamma( b-u+vu^2) + D_u u_xx; v_t = gamma(b-vu^2). Params: gamma = 0.1, a=0.2, b=2.0. Start close to steady state u_ss = a+b, vss = b/(a+b)^2 with random noise uss*(1+0.1*rand_norm(1,0.5)). Simulate for longer time to see the pattern.</Details>
        <Title>Schnakenberg2Db</Title>
    </Description>
    <Space>
        <Lattice class="square">
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Size symbol="size" value="100, 100, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="-x"/>
                <Condition type="noflux" boundary="y"/>
                <Condition type="noflux" boundary="-y"/>
            </BoundaryConditions>
            <NodeLength symbol="dx" value="0.1"/>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="1000"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Global>
        <Field symbol="u" name="attractant" value="(a+b)*(1+0.1*rand_norm(1,0.5))">
            <Diffusion rate="0.01"/>
        </Field>
        <System time-step="0.5" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="u" name="activator">
                <Expression>gamma*(a-u+v*u^2)</Expression>
            </DiffEqn>
            <Constant symbol="k" name="decay rate" value="0.001"/>
            <DiffEqn symbol-ref="v" name="inhibitor">
                <Expression>gamma*(b-v*u^2)</Expression>
            </DiffEqn>
        </System>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
        <Function symbol="y">
            <Expression>dx*space.y</Expression>
        </Function>
        <Field symbol="v" value="b/(a+b)^2">
            <Diffusion rate="1.0"/>
        </Field>
        <Constant symbol="gamma" value="0.1"/>
        <Constant symbol="a" value="0.2"/>
        <Constant symbol="b" value="2.0"/>
    </Global>
    <Analysis>
        <Logger time-step="100" name="chemical profile">
            <Input>
                <Symbol symbol-ref="u"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="50" title="chemical profile">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="u"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Schnakenberg System/Schnakenberg2Dshape.xml
````xml
<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Details>Full title:		Schnakenberg System
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		04.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2002
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		A patterning reaction-diffusion solver on an IRREGULAR DOMAIN. Simulation of the Schnakenberg reaction diffusion system on a 2D shape with no-flux BCs u_t = gamma( b-u+vu^2) + D_u u_xx; v_t=gamma(b-vu^2). Params: gamma = 0.1, a=0.2, b=2.0. Start close to steady state u_ss=a+b, vss= b/(a+b)^2 with random noise uss*(1+0.1*rand_norm(1,0.5)). This file requires a TIFF image that defines the shape on which the PDEs are solved. The size of the domain is determined by the size of the image. Simulate for longer time to see the final pattern that emerges.</Details>
        <Title>Schnakenberg2Dshape</Title>
    </Description>
    <Space>
        <Lattice class="square">
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Size symbol="size" value="100, 100, 0"/>
            <!--    <Disabled>
        <BoundaryConditions>
            <Condition type="noflux" boundary="x"/>
            <Condition type="noflux" boundary="-x"/>
            <Condition type="noflux" boundary="y"/>
            <Condition type="noflux" boundary="-y"/>
        </BoundaryConditions>
    </Disabled>
-->
            <NodeLength symbol="dx" value="0.1"/>
            <Domain boundary-type="noflux">
                <!--    <Disabled>
        <Circle diameter="0"/>
    </Disabled>
-->
                <Image path="picture2.tiff"/>
            </Domain>
            <!--    <Disabled>
        <BoundaryConditions>
            <Condition type="periodic" boundary="x"/>
        </BoundaryConditions>
    </Disabled>
-->
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="300"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Global>
        <Field symbol="u" name="attractant" value="(a+b)*(1+0.1*rand_norm(1,0.5))">
            <Diffusion rate="0.01"/>
            <TIFFReader filename="picture2.tiff"/>
            <BoundaryValue boundary="domain" value="0"/>
        </Field>
        <Field symbol="v" value="b/(a+b)^2">
            <Diffusion rate="1.0"/>
            <TIFFReader filename="picture2.tiff"/>
            <BoundaryValue boundary="domain" value="0"/>
        </Field>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
        <Function symbol="y">
            <Expression>dx*space.y</Expression>
        </Function>
        <Constant symbol="gamma" value="0.1"/>
        <Constant symbol="a" value="0.2"/>
        <Constant symbol="b" value="2.0"/>
        <System time-step="0.5" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="u" name="activator">
                <Expression>gamma*(a-u+v*u^2)</Expression>
            </DiffEqn>
            <Constant symbol="k" name="decay rate" value="0.001"/>
            <DiffEqn symbol-ref="v" name="inhibitor">
                <Expression>gamma*(b-v*u^2)</Expression>
            </DiffEqn>
        </System>
    </Global>
    <Analysis>
        <!--    <Disabled>
        <Logger time-step="20" name="chemical profile">
            <Input>
                <Symbol symbol-ref="u"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="50" title="chemical profile">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="u"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
    </Disabled>
-->
        <Gnuplotter time-step="30" decorate="false">
            <Plot>
                <Field isolines="1" symbol-ref="u"/>
            </Plot>
            <Terminal name="png"/>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Schnakenberg System/SchnakenbergRD1D_main.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Schnakenberg RD System 1D</Title>
        <Details>Full title:		Schnakenberg System
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		04.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2002
File type:		Main model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Patterns formed by the Schnakenberg reaction-diffusion system. u is the activator and v is the inhibitor. gamma sets the time scale of the kinetics relative to the rates of diffusion. Modified from the Morpheus example Example-ActivatorInhibitor-2D (https://identifiers.org/morpheus/M0012).</Details>
    </Description>
    <Global>
        <Field symbol="u" name="activator" value="2+0.5*rand_norm(1,0.5)">
            <Diffusion rate="0.01"/>
        </Field>
        <Field symbol="v" name="inhibitor" value="1.0">
            <Diffusion rate="1"/>
        </Field>
        <Field symbol="v_5" name="5Xinhibitor" value="5">
            <Diffusion rate="0"/>
            <Annotation>v_5 is defined for plotting purposes, so that v shows up well on the plot of u.</Annotation>
        </Field>
        <System time-step="0.1" name="Schnakenberg" solver="Runge-Kutta [fixed, O(4)]">
            <Constant symbol="gamma" value="0.1"/>
            <Constant symbol="a" value="0.2"/>
            <Constant symbol="b" value="2.0"/>
            <DiffEqn symbol-ref="u">
                <Expression>gamma*(a-u+v*(u^2))</Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="v">
                <Expression>gamma*(b-v*(u^2))</Expression>
            </DiffEqn>
            <Rule symbol-ref="v_5">
                <Expression>5*v</Expression>
            </Rule>
        </System>
    </Global>
    <Space>
        <Lattice class="linear">
            <Size symbol="size" value="150, 0, 0"/>
            <NodeLength value="0.2"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="-x"/>
            </BoundaryConditions>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="500"/>
        <SaveInterval value="0"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <Analysis>
        <Logger time-step="50">
            <Input>
                <Symbol symbol-ref="u"/>
            </Input>
            <Output>
                <TextOutput file-format="csv"/>
            </Output>
            <Plots>
                <Plot time-step="50">
                    <Style line-width="3.0" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="space.x"/>
                    </X-axis>
                    <Y-axis minimum="0" maximum="6">
                        <Symbol symbol-ref="u"/>
                        <!--    <Disabled>
        <Symbol symbol-ref="v_5"/>
    </Disabled>
-->
                    </Y-axis>
                    <!--    <Disabled>
        <Range>
            <Disabled>
                <Data/>
            </Disabled>
            <Disabled>
                <Time mode="current"/>
            </Disabled>
        </Range>
    </Disabled>
-->
                    <Color-bar reverse-palette="true">
                        <Symbol symbol-ref="time"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <Logger time-step="10">
            <Input>
                <Symbol symbol-ref="u"/>
            </Input>
            <Output>
                <TextOutput file-format="matrix"/>
            </Output>
            <Plots>
                <SurfacePlot time-step="10">
                    <Color-bar>
                        <Symbol symbol-ref="u"/>
                    </Color-bar>
                    <Terminal terminal="png"/>
                </SurfacePlot>
            </Plots>
        </Logger>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Wave-Pinning/index.md
````markdown
---
MorpheusModelID: M2011

title: Wave-Pinning

authors: [L. Edelstein-Keshet]
contributors: [Y. Xiao]

# Under review
hidden: false
private: false

# Reference details
#publication:
#  doi: ""
#  title: ""
#  journal: ""
#  volume:
#  issue:
#  page: ""
#  year:
#  original_model: true

tags:
- 1D
- 2D
- Actin
- Blood
- Blood Cell
- BoundaryConditions
- Cell Membrane
- Conservation
- Convex Region
- Curvature
- Cytoskeleton
- Cytosol
- Domain
- Edge Curvature
- Field
- Gnuplotter
- GTPase
- High Activity Zone
- Hotspot
- Image
- Interface Length
- Irregular Domain
- Isoline
- Kymograph
- Neutrophil
- Noflux
- Oval Domain
- Partial Differential Equation
- PDE
- Rectangular Domain
- Small GTPase
- Spatial Distribution
- Steady State
- Wave
- Wave-Pinning
- Well-mixed

categories:
- "L. Edelstein-Keshet: Mathematical Models in Cell Biology"
---
> Spatial distribution of GTPase activity

## Introduction

The actin cytoskeleton is regulated by a set of proteins called Small GTPases. The spatial distribution of GTPase activity changes on a timescale of seconds in rapidly moving cells like white blood cells (neutrophils). Here, we generalize a well-mixed GTPase model system to include spatial distribution.

In this context, we investigate the influence of the conservation of the total GTPase and discuss the different behaviors that occur in various domains such as

- traveling waves for a constant pool of inactive GTPase in 1D,
- stalling wave (wave-pinning) for constant total GTPase in 1D,
- stalling wave in a 2D rectangular domain,
- stalling wave in a 2D oval and irregular domain,
- effects of edge curvature on wave-pinning behavior in 2D domains.

## Description

Consider the equations depicting a GTPase model, choosing $`u`$ as it's active and $`v`$ as the inactive form:

$$\begin{align}
\frac{\partial u}{\partial t} &= (b + \gamma \frac{u^n}{1+u^n})v - u + D_u\Delta u \\\\
\frac{\partial v}{\partial t} &= - (b + \gamma \frac{u^n}{1+u^n})v + u + D_v\Delta v \\\\
\end{align}$$

## Results

![](1GTPase1PDE1DnoCons.png "A simulation of the GTPase model in 1D, with no-flux <span title='//Space/Lattice/BoundaryConditions/Condition[@type=&#39;noflux&#39;]'>`BoundaryConditions`</span> and a constant pool of inactive form <span title='//Global/Field[symbol=&#39;i&#39;]/@value'>$`\nu = 2`$</span>. A wave that is initiated at the left boundary sweeps all the way across the domain so that the entire cell has a uniform GTPase level of activity (spatial profiles depicted at $`t = 0, 15, 30, 45, 60`$). Produced with the Morpheus file [`NotWavepinning_main.xml`](#model).")

<figure>
  ![](M2011_wave-pinning_movie_NotWavepinning_main.mp4)
  <figcaption>
    Simulation video of {{< model_quick_access "media/model/m2011/NotWavepinning_main.xml" >}}
  </figcaption>
</figure>

![](2PDE1GTPase1D_WP.png "As in the figure above, but for constant total GTPase (2 PDEs), demonstrating wave-pinning behavior. In contrast to the figure above, the waves only move part ways into the domain, so that a spatially nonuniform steady state is created. The right part of the 1D domain has low GTPase activity, whereas the left has high activity. The same result is shown in the kymograph (lower right panel). Produced with the Morpheus file [`WavePinning2PDEsConservedTotal1D.xml`](#downloads).")

<figure>
  ![](M2011_wave-pinning_movie_WavePinning2PDEsConservedTotal1D.mp4)
  <figcaption>
    Simulation video of {{< model_quick_access "media/model/m2011/WavePinning2PDEsConservedTotal1D.xml" >}}
  </figcaption>
</figure>

![](WP_in_2DMorpheus.png "A simulation of the wave-pinning GTPase model in 2D on a rectangular domain, stimulated at the lower left corner. Shown are the plots for $`t = 0, 50, 200, 500`$ time steps together with level curves of the level of active GTPase. The total GTPase is conserved. Produced with the Morpheus file [`Wavepinningin2D.xml`](#downloads).")

<figure>
  ![](M2011_wave-pinning_movie_Wavepinningin2D.mp4)
  <figcaption>
    Simulation video of {{< model_quick_access "media/model/m2011/Wavepinningin2D.xml" >}}
  </figcaption>
</figure>

![](WP_2D_Oval.png "A simulation of the  wave-pinning GTPase model in 2D on an oval shaped domain, with random initial conditions and no-flux <span title='//Space/Lattice/BoundaryConditions/Condition[@type=&#39;noflux&#39;]'>`BoundaryConditions`</span>. Shown are the plots for $`t = 0, 500, 5000, 5500`$ with activated <span title='//Analysis/Gnuplotter/Plot/Field[@isolines=&#39;5&#39;]'>`isolines`</span> (red). Produced with the Morpheus file [`Wavepinning2DOvalDomain.xml`](#downloads).")

In the simulation shown in the figure above, the system quickly forms hotspots at the two opposite poles of the domain. These persist for a long time. One peak eventually wins and the other disappears.

<figure>
  ![](M2011_wave-pinning_movie_Wavepinningin2DOvalDomain.mp4)
  <figcaption>
    Video of another simulation run of {{< model_quick_access "media/model/m2011/Wavepinning2DOvalDomain.xml" >}}
  </figcaption>
</figure>

{{% callout note %}}
The model {{< model_quick_access "media/model/m2011/Wavepinning2DOvalDomain.xml" >}} also requires the separate file [`Rodlarger.tiff`](#downloads).
{{% /callout %}}

![](WPIrreg2DDomain.png "A simulation of the wave-pinning GTPase model in an irregular domain with no-flux <span title='//Space/Lattice/BoundaryConditions/Condition[@type=&#39;noflux&#39;]'>`BoundaryConditions`</span> starting with random intial conditions. Shown is the level of active form and the level curves for GTPase for times $`t = 0, 100, 200, 600`$ (top row) and $`t = 1000, 2000, 3000, 4000`$ (bottom row) with <span title='//Analysis/Gnuplotter/Plot/Field[@isolines=&#39;5&#39;]'>`isolines`</span> (red) enabled. Produced with the Morpheus file [`Wavepinningin2DIregDomain.xml`](#downloads).")

<figure>
  ![](M2011_wave-pinning_movie_Wavepinningin2DIregDomain.mp4)
  <figcaption>
    Video of another simulation run of {{< model_quick_access "media/model/m2011/Wavepinningin2DIregDomain.xml" >}}
  </figcaption>
</figure>

{{% callout note %}}
The model {{< model_quick_access "media/model/m2011/Wavepinningin2DIregDomain.xml" >}} also requires the separate file [`domainLarge.tiff`](#downloads).
{{% /callout %}}

In the figure above, produced with the Morpheus file {{< model_quick_access "media/model/m2011/Wavepinningin2DIregDomain.xml" >}}, the intial dynamics quickly set up a few ‘hotspots’ that gradually merge and/or attach to the domain boundary. On a much slower time-scale, the high activity zones gradually evolve to minimize their interface length. The shape of the domain means that hotspots get ‘trapped’ in convex regions.
````

## File: Contributed Examples/PDE/Wave-Pinning/model.md
````markdown
![](M2011_wave-pinning_model-graph.svg "Model Graph")
````

## File: Contributed Examples/PDE/Wave-Pinning/NotWavepinning_main.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>NotWavepinning</Title>
        <Details>Full title:		Wave-Pinning
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		22.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2011
File type:		Main model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Single GTPase model but with constant inactive GTPase. This simulation demonstrates that when there is no conservation of total (active plus inactive) GTPase, then there is no wave-pinning. The wave of activity takes over the entire domain. Credit: Lutz Brusch, for an earlier version of this code for the wave-pinning model with conservation.</Details>
    </Description>
    <Global>
        <Constant symbol="L" value="dx*size.x"/>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
        <Field symbol="a" name="active GTPase" value="2*exp(-x^2)">
            <Diffusion rate="0.1"/>
        </Field>
        <Field symbol="i" name="inactive GTPase" value="2">
            <Diffusion rate="10"/>
        </Field>
        <System solver="Dormand-Prince [adaptive, O(5)]">
            <DiffEqn symbol-ref="a">
                <Expression> i*(b+gamma*a^n/(1+a^n))- a  </Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="i">
                <Expression>0</Expression>
            </DiffEqn>
            <Constant symbol="gamma" name="feedback activation parameter" value="1"/>
            <Constant symbol="n" value="2"/>
            <Function symbol="b" name="basal activation rate">
                <Expression>0.067</Expression>
            </Function>
        </System>
    </Global>
    <Space>
        <Lattice class="linear">
            <Size symbol="size" value="100, 0, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="-x"/>
            </BoundaryConditions>
            <NodeLength symbol="dx" value="0.1"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="100"/>
        <TimeSymbol symbol="t" name="time"/>
    </Time>
    <Analysis>
        <Logger time-step="1">
            <Input>
                <Symbol symbol-ref="a"/>
                <Symbol symbol-ref="i"/>
                <Symbol symbol-ref="L"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="5" title="Spatial profiles">
                    <Style decorate="true" line-width="3.0" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis maximum="2.5" minimum="0">
                        <Symbol symbol-ref="a"/>
                        <Symbol symbol-ref="i"/>
                    </Y-axis>
                    <Range>
                        <Time mode="current"/>
                    </Range>
                </Plot>
                <Plot time-step="-1" title="Time-space plot">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="space.x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="t"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="a"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Wave-Pinning/WavePinning2PDEsConservedTotal1D.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Wave Pinning in 1D</Title>
        <Details>Full title:		Wave-Pinning
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		22.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2011
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Two PDEs for both active and inactive GTPase. Conservation of total amount leads to wave-pinning. Credit: Lutz Brusch, for an earlier version of this code.</Details>
    </Description>
    <Global>
        <Constant symbol="L" value="dx*size.x"/>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
        <Field symbol="a" name="active GTPase" value="2*exp(-x^2)">
            <Diffusion rate="0.1"/>
        </Field>
        <Field symbol="i" name="inactive GTPase" value="2.3">
            <Diffusion rate="10"/>
        </Field>
        <System solver="Dormand-Prince [adaptive, O(5)]">
            <DiffEqn symbol-ref="a">
                <Expression> i*(b+gamma*a^n/(1+a^n))- a  </Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="i">
                <Expression> -i*(b+gamma*a^n/(1+a^n))+ a</Expression>
            </DiffEqn>
            <Constant symbol="gamma" value="1"/>
            <Constant symbol="n" value="2"/>
            <Function symbol="b" name="stimulus">
                <Expression>0.067</Expression>
            </Function>
        </System>
    </Global>
    <Space>
        <Lattice class="linear">
            <Size symbol="size" value="100, 0, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="-x"/>
            </BoundaryConditions>
            <NodeLength symbol="dx" value="0.1"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="100"/>
        <TimeSymbol symbol="t" name="time"/>
    </Time>
    <Analysis>
        <Logger time-step="1">
            <Input>
                <Symbol symbol-ref="a"/>
                <Symbol symbol-ref="i"/>
                <Symbol symbol-ref="L"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="5" title="Spatial profiles">
                    <Style decorate="true" line-width="3.0" style="lines"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis maximum="2.5" minimum="0">
                        <Symbol symbol-ref="a"/>
                        <Symbol symbol-ref="i"/>
                    </Y-axis>
                    <Range>
                        <Time mode="current"/>
                    </Range>
                </Plot>
                <Plot time-step="-1" title="Time-space plot">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="t"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="a"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Wave-Pinning/Wavepinningin2D.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>Wavepinning_in2D</Title>
        <Details>Full title:		Wave-Pinning
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		22.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2011
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Square domain stimulated at one corner. 2 PDEs for active and inactive GTPase with conservation, leading to wave-pinning in a 2D domain. Credit: Lutz Brusch, for an earlier version of this code in 1D.</Details>
    </Description>
    <Global>
        <Constant symbol="L" value="dx*size.x"/>
        <Function symbol="y">
            <Expression>dx*space.y</Expression>
        </Function>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
        <Field symbol="a" name="active GTPase" value="2*exp(-(x^2+y^2)/10)">
            <Diffusion rate="0.01"/>
        </Field>
        <Field symbol="i" name="inactive GTPase" value="2">
            <Diffusion rate="1"/>
        </Field>
        <System time-step="1" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="a">
                <Expression> i*(b+gamma*a^n/(1+a^n))- a  </Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="i">
                <Expression> -i*(b+gamma*a^n/(1+a^n))+ a</Expression>
            </DiffEqn>
            <Constant symbol="gamma" value="1"/>
            <Constant symbol="n" value="2"/>
            <Function symbol="b" name="stimulus">
                <Expression>0.067</Expression>
            </Function>
        </System>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="100, 100, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="-x"/>
                <Condition type="noflux" boundary="y"/>
                <Condition type="noflux" boundary="-y"/>
            </BoundaryConditions>
            <NodeLength symbol="dx" value="0.1"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="500"/>
        <TimeSymbol symbol="t" name="time"/>
    </Time>
    <Analysis>
        <!--    <Disabled>
        <Logger time-step="1">
            <Input>
                <Symbol symbol-ref="a"/>
                <Symbol symbol-ref="i"/>
                <Symbol symbol-ref="L"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="15" title="Spatial profiles">
                    <Style decorate="true" line-width="3.0" style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis maximum="2" minimum="0">
                        <Symbol symbol-ref="a"/>
                        <Symbol symbol-ref="i"/>
                    </Y-axis>
                    <Range>
                        <Time mode="current"/>
                    </Range>
                </Plot>
                <Plot time-step="40" title="Time-space plot">
                    <Style style="points"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="x"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="y"/>
                    </Y-axis>
                    <Color-bar>
                        <Symbol symbol-ref="a"/>
                    </Color-bar>
                </Plot>
            </Plots>
        </Logger>
    </Disabled>
-->
        <Gnuplotter time-step="50">
            <Plot title="active GTPase">
                <Field isolines="5" symbol-ref="a"/>
            </Plot>
            <Terminal name="png"/>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Wave-Pinning/Wavepinningin2DIregDomain.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>ModelWavepinningin2D_IregDomain</Title>
        <Details>Full title:		Wave-Pinning
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		22.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2011
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		Simulation of the one GTPase model in an irregular 2D domain (shaped like a pavement cell). The domain shape is dictated by a TIFF image that is prepared separately. Conserved total leads to wave-pinning. However, the "protrusions" of the cell can trap areas of high GTPase activity for a long time so the cell may not polarize if stimulated with random noise initially, as in this case. Credit: Lutz Brusch, for an earlier version of this code in 1D.</Details>
    </Description>
    <Global>
        <Constant symbol="L" value="dx*size.x"/>
        <Function symbol="y">
            <Expression>dx*space.y</Expression>
        </Function>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
        <Field symbol="a" name="active GTPase" value="0.2683312*(1+0.2*rand_norm(1,0.5))">
            <Diffusion rate="0.01"/>
        </Field>
        <Field symbol="i" name="inactive GTPase" value="2">
            <Diffusion rate="1"/>
        </Field>
        <System time-step="1" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="a">
                <Expression> i*(b+gamma*a^n/(1+a^n))- a  </Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="i">
                <Expression> -i*(b+gamma*a^n/(1+a^n))+ a</Expression>
            </DiffEqn>
            <Constant symbol="gamma" value="1"/>
            <Constant symbol="n" value="2"/>
            <Function symbol="b" name="stimulus">
                <Expression>0.067</Expression>
            </Function>
        </System>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="100, 100, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="-x"/>
                <Condition type="noflux" boundary="y"/>
                <Condition type="noflux" boundary="-y"/>
            </BoundaryConditions>
            <NodeLength symbol="dx" value="0.1"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Domain boundary-type="noflux">
                <!--    <Disabled>
        <Circle diameter="0"/>
    </Disabled>
-->
                <Image path="domainLarge.tiff"/>
            </Domain>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="4000"/>
        <TimeSymbol symbol="t" name="time"/>
    </Time>
    <Analysis>
        <Gnuplotter time-step="50">
            <Plot title="active GTPase">
                <Field isolines="5" symbol-ref="a"/>
            </Plot>
            <Terminal name="png"/>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/PDE/Wave-Pinning/Wavepinningin2DOvalDomain.xml
````xml
<MorpheusModel version="4">
    <Description>
        <Title>ModelWavepinningin2DOvalDomain</Title>
        <Details>Full title:		Wave-Pinning
Authors:		L. Edelstein-Keshet
Contributors:	Y. Xiao
Date:		22.06.2022
Software:		Morpheus (open-source). Download from https://morpheus.gitlab.io
Model ID:		https://identifiers.org/morpheus/M2011
File type:		Supplementary model
Reference:		L. Edelstein-Keshet: Mathematical Models in Cell Biology
Comment:		GTPase WP simulation on an oval shaped domain. Conserved total amount, leading to wave-pinning. The oval domain is prepared using a TIFF file and so indicated in the code. The absolute size of the image in pixels determines the domain size, regardless of any space scaling. Credit: Lutz Brusch, for an earlier version of this code in 1D.</Details>
    </Description>
    <Global>
        <Constant symbol="L" value="dx*size.x"/>
        <Function symbol="y">
            <Expression>dx*space.y</Expression>
        </Function>
        <Function symbol="x">
            <Expression>dx*space.x</Expression>
        </Function>
        <Field symbol="a" name="active GTPase" value="0.2683312*(1+0.2*rand_norm(1,0.5))">
            <Diffusion rate="0.01"/>
        </Field>
        <Field symbol="i" name="inactive GTPase" value="2">
            <Diffusion rate="1"/>
        </Field>
        <System time-step="1" solver="Runge-Kutta [fixed, O(4)]">
            <DiffEqn symbol-ref="a">
                <Expression> i*(b+gamma*a^n/(1+a^n))- a  </Expression>
            </DiffEqn>
            <DiffEqn symbol-ref="i">
                <Expression> -i*(b+gamma*a^n/(1+a^n))+ a</Expression>
            </DiffEqn>
            <Constant symbol="gamma" value="1"/>
            <Constant symbol="n" value="2"/>
            <Function symbol="b" name="stimulus">
                <Expression>0.067</Expression>
            </Function>
        </System>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="100, 100, 0"/>
            <BoundaryConditions>
                <Condition type="noflux" boundary="x"/>
                <Condition type="noflux" boundary="-x"/>
                <Condition type="noflux" boundary="y"/>
                <Condition type="noflux" boundary="-y"/>
            </BoundaryConditions>
            <NodeLength symbol="dx" value="0.1"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <Domain boundary-type="noflux">
                <!--    <Disabled>
        <Circle diameter="0"/>
    </Disabled>
-->
                <Image path="Rodlarger.tiff"/>
            </Domain>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="5500"/>
        <TimeSymbol symbol="t" name="time"/>
    </Time>
    <Analysis>
        <Gnuplotter time-step="50">
            <Plot title="active GTPase">
                <Field isolines="5" symbol-ref="a"/>
            </Plot>
            <Terminal name="png"/>
        </Gnuplotter>
        <ModelGraph format="svg" reduced="false" include-tags="#untagged"/>
    </Analysis>
</MorpheusModel>
````

## File: Contributed Examples/index.md
````markdown
---
date: "2020-11-20T11:29:00+01:00"
lastmod: "2020-11-24T13:28:00+01:00"

summary: "Unpublished work by named contributors. Anyone may contribute here."

aliases:
- /models/contributed-examples/
- /models/Contributed-Examples/
- /model/Contributed-Examples/

toc: false

menu:
  Contributed Examples:
    weight: -10
weight: 20
---
{{< figure src="featured.png" alt="Schematic image of users" caption="[CC-BY 4.0](https://creativecommons.org/licenses/by/4.0/) [Font Awesome](https://fontawesome.com/license)" width="30%" >}}

Contributed examples are **unpublished work** from named contributors. Anyone may contribute here.
````

## File: index.md
````markdown
---
aliases:
- /models/
---
Since the Morpheus model repository was launched in 2021, it has been receiving a increasing number of new contributions. The **continuous growth** of the diverse model collection, sorted by submissions per model category, is shown below and updated daily:

![Development of model contributions over time sorted by categories](/media/model/stats/models-by-category.svg "Development of model contributions over time")

## Search Models

Use the **full-text search** field in the top-left of each category's page to find models by a specific author or cellular process.

![Screenshot showing the full-text search box for the Morpheus website in the model repo](faq/model-repository/search/model-search.png "Full-text search box for the Morpheus website in the model repository")

Moreover, each model is tagged with common **keywords** like model formalism which are displayed below each model description. Clicking these tags displays a list of other models (and further content on the Morpheus website) with the same tag.

![Screenshot showing the tag list at the end of a model page](faq/model-repository/search/model-tags.png "Alphabetically ordered tag list at the bottom of each model page")

## Cite Models

Each model (including contributed and built-in examples) is registered with a **unique and persistent ID of the format `M....`**. The model description page, the model's XML file and all further files connected with that model can be retrieved via a **persistent URL** of the format `https://identifiers.org/morpheus/M....`.

![Screenshot showing the expandable citable identifier link for a model](faq/model-repository/cite/model-id.png "Expandable citable unique identifier link for all models")

Further details on referencing, tracking of changes to the model etc. can be found in the [FAQ](/faq/models/referencing/).

## Submit Models

You can also **contribute to the Morpheus model repository** and upload MorpheusML-encoded model files yourself.

In our [FAQ](/faq/models/submit/) you will find all further information about this, including a **detailed guide** that takes you step by step through the **submission process**.

Also, please do not hesitate to **[contact us](/#support) directly with your model**. We are happy to guide you through the entire process until the final publication of your model here in the repository.

{{< cta cta_text="Contribute now!" cta_link="/faq/models/submit/" cta_new_tab="false" >}}
````

## File: README.md
````markdown
# Morpheus Model Repository

[![Website](https://img.shields.io/website?url=https%3A%2F%2Fmorpheus.gitlab.io%2Fmodel%2F)](https://morpheus.gitlab.io/model/)
[![Gitlab pipeline status](https://img.shields.io/gitlab/pipeline-status/morpheus.lab/model-repo?branch=master)](https://gitlab.com/morpheus.lab/model-repo/-/pipelines?page=1&scope=all&ref=master)
[![GitLab all merge requests](https://img.shields.io/gitlab/merge-requests/all/morpheus.lab/model-repo)](https://gitlab.com/morpheus.lab/model-repo/-/merge_requests?scope=all&state=all)
[![GitLab open merge requests](https://img.shields.io/gitlab/merge-requests/open/morpheus.lab/model-repo)](https://gitlab.com/morpheus.lab/model-repo/-/merge_requests?state=opened)
[![Netlify deploy previews status](https://api.netlify.com/api/v1/badges/a76f6818-6b33-42d5-b011-5530c42bf03a/deploy-status)](https://app.netlify.com/sites/morpheus-model-repo/deploys)
[![GitLab issues](https://img.shields.io/gitlab/issues/open/morpheus.lab/model-repo)](https://gitlab.com/morpheus.lab/model-repo/-/issues)
[![GitLab contributors](https://img.shields.io/gitlab/contributors/morpheus.lab/model-repo)](https://gitlab.com/morpheus.lab/model-repo/-/graphs/master?ref_type=heads)
[![GitLab last commit](https://img.shields.io/gitlab/last-commit/morpheus.lab/model-repo)](https://gitlab.com/morpheus.lab/model-repo/-/commits/master?ref_type=heads)<br />
[![Download](https://img.shields.io/badge/Download-Morpheus-blueviolet)](https://morpheus.gitlab.io/download/latest/)
[![GitLab forks](https://img.shields.io/gitlab/forks/morpheus.lab/morpheus?style=social)](https://gitlab.com/morpheus.lab/morpheus)
[![GitLab stars](https://img.shields.io/gitlab/stars/morpheus.lab/morpheus?style=social)](https://gitlab.com/morpheus.lab/morpheus)

The [Morpheus model repository](https://morpheus.gitlab.io/models/) is an open-access data resource to store, search and retrieve unpublished and published computational models of spatio-temporal and multicellular biological systems, encoded in the MorpheusML language and readily executable with the [Morpheus software](http://morpheus.gitlab.io/download/latest/).

Want to contribute? Have a look at our [step-by-step guide](https://morpheus.gitlab.io/faq/models/submit/)!

## User Documentation

### Minimum Model Requirements

A model in the repo consists at least of:

- a **MorpheusML file** (XML file),
- which is placed in a subcategory (e.g. `Contributed Exmaples` → `CPM` or `Published Models` → `Zebrafish` ) **inside its own folder** with a title that is used for the category-wise left-hand model navigation and should therefore be as short and precise as possible.

#### Optional Model Attachments

Furthermore, additional files associated with the model can be added to the model folder as desired, e.g.

- a model metadata and description supplementary file, named `index.md` (see below under ‘[Model Metadata and Description](#model-metadata-and-description)’),
- illustrations, diagrams, model graph etc.,
- videos,
- other XML model files etc.

### MorpheusML (XML)

Each entry in the Morpheus model repository comes with **at least one model file with the file extension `.xml`**. The sub-elements of the `<Description>`, `<Title>` and `<Details>`, are automatically migrated from the XML file to the model repo as (long) title and description respectively.

If more than one XML file should be added to a repo entry (in which, for example, features are switched on or off for demonstration purposes, different parameters are used, etc.), the **main model file must be flagged with `_main`** at the end of the file name (resulting in a file name with the format `[...]_main.xml`). All complementary XML files can be given arbitrary file names.

*For historical reasons, the alternative main file names `model.xml` and `_[...].xml` (underscore at the beginning) are also accepted, but the marking with the word `_main` at the end is treated with the highest priority and should always be preferred for all new model pages with more than one MorpheusML file.*

If required, e.g. for more detailed model explanations, illustrations, videos, references etc., an optional model metadata and description file (see below under ‘[Model Metadata and Description](#model-metadata-and-description)’) can be added, which can also be used to overwrite the automatically generated title and description.

### Model Metadata and Description

A model entry can be **extended with further metadata and detailed descriptions** using the special model metadata and description file `index.md`. **We highly recommend making use of this possibility** to enrich the model with detailed descriptions, illustrations, sources, cross-references to other models, input data, own Morpheus implementation tips, teaching material, quizzes and so on!

#### Structure of `index.md`

The model metadata and description file `index.md` is subdivided into two main sections:

1. A so-called **front matter part with meta information** in the simple to understand YAML format,
2. a **content section** in which you can write your own texts in the easy-to-learn [Markdown](https://daringfireball.net/projects/markdown/syntax) syntax and embed your own uploaded or external media, LaTeX code, sources, etc.

To get an impression of the structure and the uncomplicated YAML/Markdown syntax, we recommend taking a look at existing model entries, such as [this one](https://gitlab.com/morpheus.lab/model-repo/-/blob/master/Published%20Models/Principles/Morphodynamics%201/index.md) (click on the `</>` button (‘Display source’) next to the file name `index.md` to display the unrendered code).

#### Morpheus Model ID

Each model is given a unique, unchangeable identifier. This can either be freely chosen and specified by the submitters in the `index.md` file or is selected automatically during the review process from the pool of available model IDs.

The model ID is assigned in the metadata part via the YAML frontmatter variable `MorpheusModelID` (see example below).

Unique identifiers follow the [regex](https://en.wikipedia.org/wiki/Regular_expression) pattern: **`^M[0-9]{4,}$`**, which means that the ID always consists of a sequence beginning with the letter ‘M’ (capitalised) followed by a four-digit number (padded with one or more zeros for numbers smaller than 1000).

Example:

- ID: `M0001`
- YAML-Code in  `index.md`: `MorpheusModelID: M0001`
- Resulting citable link: https://identifiers.org/morpheus/M0001

Each model published in the repository becomes automatically accessible via a persistent link with the scheme
`https://identifiers.org/morpheus/M....`, which can be cited, for example, in the 
code availability statement of your future papers.

More details about the Morpheus namespace on Identifiers.org can be found [here](https://registry.identifiers.org/registry/morpheus).

#### Publication Reference

In addition to the free text in the content-part of the `index.md`, where any content including references to the model can be added, there is the ability to have a **standardised reference section** generated via the metadata-part of the `index.md`.

An example of such a reference definition in the YAML format is shown below. The keyword `publication` is followed by the indented details of the publication such as the [DOI](https://www.doi.org) or the title:

```yaml
publication:
  doi: "10.1371/journal.pbio.3000708"
  # authors: ... (not necessary in category ‘Published Models’)
  title: "Reoccurring neural stem cell divisions in the adult zebrafish telencephalon are sufficient for the emergence of aggregated spatiotemporal patterns"
  journal: "PLoS Biology"
  volume: 18
  issue: 12
  page: "e3000708"
  year: 2020
  original_model: true
  ```

  This YAML code results in [this reference](https://morpheus.gitlab.io/model/m2984/#reference).

  There are a few **rules** to be considered:

  - **Minimum required parameters**: At least one author and the title must be given. If this minimum requirement is not met, the input is ignored and no reference section is generated.
    - In the category ‘[Published Models](https://morpheus.gitlab.io/model/published-models/)’, the **author(s) of the original publication must be mentioned with the global `authors` parameter**. These are also included in the reference section so that a separate `authors` parameter does not have to be specified again under `publication`.
    - Nevertheless, it is possible to specify a reference independently of the model author(s) in the category ‘[Contributed Examples](https://morpheus.gitlab.io/model/contributed-examples/)’, i.e. to **provide different author(s)** using the `authors` parameter under `publication`.
  - **Original or reproduced model**: In the category ‘Published Models’ there is the special parameter `original_model` (default: `false`). Set to the value `true`, it indicates that the model provided is the original one used in the publication. The value `false` means that the model used only provides a result reproduced with Morpheus that was originally obtained in the publication with a different simulator. According to the indication (`true`, `false` or none), the model is provided with a text note in the repo. Outside the category ‘Published Models’, the parameter `original_model` is ignored.
  - **Preprints**: If the model originates from a preprint and thus has not been formally peer-reviewed, the parameter `preprint` (default: `false`) can be set to `true` in order to add a note about it to the model page.

## Maintainer Documentation

### Publish New Models

Readily reviewed models are transferred from the merge request branch to the `master` branch. It is recommended that each release of a new model is reflected in at least two commits in the master branch:

1. A commit with the initial state of the MorpheusML file and, if available, description texts (in files `index.md` and/or `model.md`) as originally submitted by the author or contributor to the Morpheus model repo, preserving the original [Git author date](https://docs.microsoft.com/en-us/azure/devops/repos/git/git-dates?view=azure-devops).
2. All subsequent commits with all changes up to the completion of the review, preferably combined into one commit for the purpose of conciseness in the `master` branch.

#### Local Procedure

Technically, the two commits above can be produced with a Git [`rebase`](https://docs.gitlab.com/ee/topics/git/git_rebase.html) as follows:

```
git checkout <new-model-branch>
git rebase master
git rebase -i <hash-of-initial-commit>
```

Mark the first commit in the list (which is the first after the author's or contributor's initial commit) with `pick` and have all following commits meld with the first one using `fixup` (or `squash`). This variant **preserves the Git author date** (which is displayed as the date in the GitLab commit history) of the first modification commit and creates a commit with the current date (which is used as the [`lastmod`](https://gohugo.io/getting-started/configuration/#configure-front-matter) date by the parser and Hugo).

The author date in addition to the commit date can be listed in the Git log with:

```
git log --format=fuller
```

The result of such an interactive `rebase` for example might look like this:

```
commit b22b7b05a87fdbc2527256b363022f9b8a8bdca4
Author:     Diego Jahn <diego.jahn@tu-dresden.de>
AuthorDate: Thu Feb 10 21:09:59 2022 +0100
Commit:     Diego Jahn <diego.jahn@tu-dresden.de>
CommitDate: Thu Apr 7 17:25:32 2022 +0200

    M9495: Review model (Published/Human/Cytotoxic T Lymphocytes)
    
    See merge request morpheus.lab/model-repo!33

commit e7ec8b1be98b0f70204e0afcfa4c560b380016ea
Author:     Diego Jahn <jahndiego@mailbox.org>
AuthorDate: Wed Sep 8 16:05:48 2021 +0200
Commit:     Diego Jahn <diego.jahn@tu-dresden.de>
CommitDate: Thu Apr 7 17:25:32 2022 +0200

    M9495: Add new model (Published/Human/Cytotoxic T Lymphocytes)
    
    See merge request morpheus.lab/model-repo!33
```

Alternatively, all changes can be reapplied together in one commit, which, in contrast to the previous `rebase` procedure, also creates an up-to-date author date:

```
git checkout <new-model-branch>
git reset --soft <hash-of-commit-after-initial-commit>
git commit
```

Now, when everything is prepared and cleaned up, a `rebase` (or fast-forward `merge`)

```
git checkout master
git rebase <new-model-branch>
```

or a `merge` without fast-forward can be performed on the master branch to publish the model.

```
git checkout master
git merge --no-ff <new-model-branch>
```

The latter creates an additional merge commit, which is accompanied by a commit message (like ‘M9495: Publish model (Published/Human/Cytotoxic T Lymphocytes)’) to highlight that with the step the model is published.

#### GitLab.com Procedure

On GitLab, a rebase (via the offered [button](https://docs.gitlab.com/ee/user/project/merge_requests/fast_forward_merge.html#enabling-fast-forward-merges) or [quick action](https://docs.gitlab.com/ee/topics/git/git_rebase.html#rebase-from-the-gitlab-ui) in the merge request) followed by a [squash](https://docs.gitlab.com/ee/user/project/merge_requests/squash_and_merge.html) and final merge commit is configured for the repo.

[GitLab](https://gitlab.com/morpheus.lab/model-repo/edit) elaborates on this:

>Merge commit with semi-linear history: Every merge creates a merge commit. Merging is only allowed when the source branch is up-to-date with its target. When semi-linear merge is not possible, the user is given the option to rebase. [...] Squashing is always performed.
````
